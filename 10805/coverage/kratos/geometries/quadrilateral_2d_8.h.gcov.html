<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - kratos/geometries/quadrilateral_2d_8.h</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">kratos/geometries</a> - quadrilateral_2d_8.h<span style="font-size: 80%;"> (source / <a href="quadrilateral_2d_8.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">84</td>
            <td class="headerCovTableEntry">474</td>
            <td class="headerCovTableEntryLo">17.7 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2023-08-17 14:49:52</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntry">48</td>
            <td class="headerCovTableEntryLo">14.6 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : //    |  /           |</a>
<a name="2"><span class="lineNum">       2 </span>            : //    ' /   __| _` | __|  _ \   __|</a>
<a name="3"><span class="lineNum">       3 </span>            : //    . \  |   (   | |   (   |\__ `</a>
<a name="4"><span class="lineNum">       4 </span>            : //   _|\_\_|  \__,_|\__|\___/ ____/</a>
<a name="5"><span class="lineNum">       5 </span>            : //                   Multi-Physics</a>
<a name="6"><span class="lineNum">       6 </span>            : //</a>
<a name="7"><span class="lineNum">       7 </span>            : //  License:             BSD License</a>
<a name="8"><span class="lineNum">       8 </span>            : //                                       Kratos default license: kratos/license.txt</a>
<a name="9"><span class="lineNum">       9 </span>            : //</a>
<a name="10"><span class="lineNum">      10 </span>            : //  Main authors:    Riccardo Rossi</a>
<a name="11"><span class="lineNum">      11 </span>            : //                   Janosch Stascheit</a>
<a name="12"><span class="lineNum">      12 </span>            : //                   Felix Nagel</a>
<a name="13"><span class="lineNum">      13 </span>            : //  contributors:    Hoang Giang Bui</a>
<a name="14"><span class="lineNum">      14 </span>            : //                   Josep Maria Carbonell</a>
<a name="15"><span class="lineNum">      15 </span>            : //</a>
<a name="16"><span class="lineNum">      16 </span>            : </a>
<a name="17"><span class="lineNum">      17 </span>            : #pragma once </a>
<a name="18"><span class="lineNum">      18 </span>            : </a>
<a name="19"><span class="lineNum">      19 </span>            : // System includes</a>
<a name="20"><span class="lineNum">      20 </span>            : </a>
<a name="21"><span class="lineNum">      21 </span>            : // External includes</a>
<a name="22"><span class="lineNum">      22 </span>            : </a>
<a name="23"><span class="lineNum">      23 </span>            : // Project includes</a>
<a name="24"><span class="lineNum">      24 </span>            : #include &quot;geometries/line_2d_3.h&quot;</a>
<a name="25"><span class="lineNum">      25 </span>            : #include &quot;utilities/integration_utilities.h&quot;</a>
<a name="26"><span class="lineNum">      26 </span>            : #include &quot;integration/quadrilateral_gauss_legendre_integration_points.h&quot;</a>
<a name="27"><span class="lineNum">      27 </span>            : </a>
<a name="28"><span class="lineNum">      28 </span>            : namespace Kratos</a>
<a name="29"><span class="lineNum">      29 </span>            : {</a>
<a name="30"><span class="lineNum">      30 </span>            : /**</a>
<a name="31"><span class="lineNum">      31 </span>            :  * @class Quadrilateral2D8</a>
<a name="32"><span class="lineNum">      32 </span>            :  * @ingroup KratosCore</a>
<a name="33"><span class="lineNum">      33 </span>            :  * @brief A eight node 2D quadrilateral geometry with quadratic shape functions</a>
<a name="34"><span class="lineNum">      34 </span>            :  * @details While the shape functions are only defined in 2D it is possible to define an arbitrary orientation in space. Thus it can be used for defining surfaces on 3D elements.</a>
<a name="35"><span class="lineNum">      35 </span>            :  * The node ordering corresponds with:</a>
<a name="36"><span class="lineNum">      36 </span>            :  *      3-----6-----2</a>
<a name="37"><span class="lineNum">      37 </span>            :  *      |           |</a>
<a name="38"><span class="lineNum">      38 </span>            :  *      |           |</a>
<a name="39"><span class="lineNum">      39 </span>            :  *      7           5</a>
<a name="40"><span class="lineNum">      40 </span>            :  *      |           |</a>
<a name="41"><span class="lineNum">      41 </span>            :  *      |           |</a>
<a name="42"><span class="lineNum">      42 </span>            :  *      0-----4-----1</a>
<a name="43"><span class="lineNum">      43 </span>            :  * @author Riccardo Rossi</a>
<a name="44"><span class="lineNum">      44 </span>            :  * @author Janosch Stascheit</a>
<a name="45"><span class="lineNum">      45 </span>            :  * @author Felix Nagel</a>
<a name="46"><span class="lineNum">      46 </span>            :  */</a>
<a name="47"><span class="lineNum">      47 </span>            : template&lt;class TPointType&gt; class Quadrilateral2D8</a>
<a name="48"><span class="lineNum">      48 </span>            :     : public Geometry&lt;TPointType&gt;</a>
<a name="49"><span class="lineNum">      49 </span>            : {</a>
<a name="50"><span class="lineNum">      50 </span>            : public:</a>
<a name="51"><span class="lineNum">      51 </span>            :     /**</a>
<a name="52"><span class="lineNum">      52 </span>            :      * Type Definitions</a>
<a name="53"><span class="lineNum">      53 </span>            :      */</a>
<a name="54"><span class="lineNum">      54 </span>            :     /**</a>
<a name="55"><span class="lineNum">      55 </span>            :      * Base Type: Geometry</a>
<a name="56"><span class="lineNum">      56 </span>            :      */</a>
<a name="57"><span class="lineNum">      57 </span>            :     typedef Geometry&lt;TPointType&gt; BaseType;</a>
<a name="58"><span class="lineNum">      58 </span>            : </a>
<a name="59"><span class="lineNum">      59 </span>            :     /**</a>
<a name="60"><span class="lineNum">      60 </span>            :      * Type of edge geometry</a>
<a name="61"><span class="lineNum">      61 </span>            :      */</a>
<a name="62"><span class="lineNum">      62 </span>            :     typedef Line2D3&lt;TPointType&gt; EdgeType;</a>
<a name="63"><span class="lineNum">      63 </span>            : </a>
<a name="64"><span class="lineNum">      64 </span>            :     /**</a>
<a name="65"><span class="lineNum">      65 </span>            :      * Pointer definition of Quadrilateral2D8</a>
<a name="66"><span class="lineNum">      66 </span>            :      */</a>
<a name="67"><span class="lineNum">      67 </span>            :     KRATOS_CLASS_POINTER_DEFINITION( Quadrilateral2D8 );</a>
<a name="68"><span class="lineNum">      68 </span>            : </a>
<a name="69"><span class="lineNum">      69 </span>            :     /**</a>
<a name="70"><span class="lineNum">      70 </span>            :      * Integration methods implemented in geometry.</a>
<a name="71"><span class="lineNum">      71 </span>            :      */</a>
<a name="72"><span class="lineNum">      72 </span>            :     typedef GeometryData::IntegrationMethod IntegrationMethod;</a>
<a name="73"><span class="lineNum">      73 </span>            : </a>
<a name="74"><span class="lineNum">      74 </span>            :     /**</a>
<a name="75"><span class="lineNum">      75 </span>            :      * A Vector of counted pointers to Geometries.</a>
<a name="76"><span class="lineNum">      76 </span>            :      * Used for returning edges of the geometry.</a>
<a name="77"><span class="lineNum">      77 </span>            :      */</a>
<a name="78"><span class="lineNum">      78 </span>            :     typedef typename BaseType::GeometriesArrayType GeometriesArrayType;</a>
<a name="79"><span class="lineNum">      79 </span>            : </a>
<a name="80"><span class="lineNum">      80 </span>            :     /**</a>
<a name="81"><span class="lineNum">      81 </span>            :      * Redefinition of template parameter TPointType.</a>
<a name="82"><span class="lineNum">      82 </span>            :      */</a>
<a name="83"><span class="lineNum">      83 </span>            :     typedef TPointType PointType;</a>
<a name="84"><span class="lineNum">      84 </span>            : </a>
<a name="85"><span class="lineNum">      85 </span>            :     /**</a>
<a name="86"><span class="lineNum">      86 </span>            :      * Array of coordinates. Can be Nodes, Points or IntegrationPoints</a>
<a name="87"><span class="lineNum">      87 </span>            :      */</a>
<a name="88"><span class="lineNum">      88 </span>            :     //typedef typename BaseType::CoordinatesArrayType CoordinatesArrayType;</a>
<a name="89"><span class="lineNum">      89 </span>            : </a>
<a name="90"><span class="lineNum">      90 </span>            : </a>
<a name="91"><span class="lineNum">      91 </span>            :     /**</a>
<a name="92"><span class="lineNum">      92 </span>            :      * Type used for indexing in geometry class.</a>
<a name="93"><span class="lineNum">      93 </span>            :      * std::size_t used for indexing</a>
<a name="94"><span class="lineNum">      94 </span>            :      * point or integration point access methods and also all other</a>
<a name="95"><span class="lineNum">      95 </span>            :      * methods which need point or integration point index.</a>
<a name="96"><span class="lineNum">      96 </span>            :      */</a>
<a name="97"><span class="lineNum">      97 </span>            :     typedef typename BaseType::IndexType IndexType;</a>
<a name="98"><span class="lineNum">      98 </span>            : </a>
<a name="99"><span class="lineNum">      99 </span>            :     /**</a>
<a name="100"><span class="lineNum">     100 </span>            :      * This typed used to return size or dimension in</a>
<a name="101"><span class="lineNum">     101 </span>            :      * geometry. Dimension, WorkingDimension, PointsNumber and</a>
<a name="102"><span class="lineNum">     102 </span>            :      * ... return this type as their results.</a>
<a name="103"><span class="lineNum">     103 </span>            :      */</a>
<a name="104"><span class="lineNum">     104 </span>            :     typedef typename BaseType::SizeType SizeType;</a>
<a name="105"><span class="lineNum">     105 </span>            : </a>
<a name="106"><span class="lineNum">     106 </span>            :     /**</a>
<a name="107"><span class="lineNum">     107 </span>            :      * Array of counted pointers to point.</a>
<a name="108"><span class="lineNum">     108 </span>            :      * This type used to hold geometry's points.</a>
<a name="109"><span class="lineNum">     109 </span>            :      */</a>
<a name="110"><span class="lineNum">     110 </span>            :     typedef  typename BaseType::PointsArrayType PointsArrayType;</a>
<a name="111"><span class="lineNum">     111 </span>            : </a>
<a name="112"><span class="lineNum">     112 </span>            :     /**</a>
<a name="113"><span class="lineNum">     113 </span>            :      * This type used for representing an integration point in</a>
<a name="114"><span class="lineNum">     114 </span>            :      * geometry. This integration point is a point with an</a>
<a name="115"><span class="lineNum">     115 </span>            :      * additional weight component.</a>
<a name="116"><span class="lineNum">     116 </span>            :      */</a>
<a name="117"><span class="lineNum">     117 </span>            :     typedef typename BaseType::IntegrationPointType IntegrationPointType;</a>
<a name="118"><span class="lineNum">     118 </span>            : </a>
<a name="119"><span class="lineNum">     119 </span>            :     /**</a>
<a name="120"><span class="lineNum">     120 </span>            :      * A Vector of IntegrationPointType which used to hold</a>
<a name="121"><span class="lineNum">     121 </span>            :      * integration points related to an integration</a>
<a name="122"><span class="lineNum">     122 </span>            :      * method. IntegrationPoints functions used this type to return</a>
<a name="123"><span class="lineNum">     123 </span>            :      * their results.</a>
<a name="124"><span class="lineNum">     124 </span>            :      */</a>
<a name="125"><span class="lineNum">     125 </span>            :     typedef typename BaseType::IntegrationPointsArrayType IntegrationPointsArrayType;</a>
<a name="126"><span class="lineNum">     126 </span>            : </a>
<a name="127"><span class="lineNum">     127 </span>            :     /**</a>
<a name="128"><span class="lineNum">     128 </span>            :      * A Vector of IntegrationPointsArrayType which used to hold</a>
<a name="129"><span class="lineNum">     129 </span>            :      * integration points related to different integration method</a>
<a name="130"><span class="lineNum">     130 </span>            :      * implemented in geometry.</a>
<a name="131"><span class="lineNum">     131 </span>            :      */</a>
<a name="132"><span class="lineNum">     132 </span>            :     typedef typename BaseType::IntegrationPointsContainerType IntegrationPointsContainerType;</a>
<a name="133"><span class="lineNum">     133 </span>            : </a>
<a name="134"><span class="lineNum">     134 </span>            :     /**</a>
<a name="135"><span class="lineNum">     135 </span>            :      * A third order tensor used as shape functions' values</a>
<a name="136"><span class="lineNum">     136 </span>            :      * container.</a>
<a name="137"><span class="lineNum">     137 </span>            :      */</a>
<a name="138"><span class="lineNum">     138 </span>            :     typedef typename BaseType::ShapeFunctionsValuesContainerType</a>
<a name="139"><span class="lineNum">     139 </span>            :     ShapeFunctionsValuesContainerType;</a>
<a name="140"><span class="lineNum">     140 </span>            : </a>
<a name="141"><span class="lineNum">     141 </span>            :     /**</a>
<a name="142"><span class="lineNum">     142 </span>            :      * A fourth order tensor used as shape functions' local</a>
<a name="143"><span class="lineNum">     143 </span>            :      * gradients container in geometry.</a>
<a name="144"><span class="lineNum">     144 </span>            :      */</a>
<a name="145"><span class="lineNum">     145 </span>            :     typedef typename BaseType::ShapeFunctionsLocalGradientsContainerType</a>
<a name="146"><span class="lineNum">     146 </span>            :     ShapeFunctionsLocalGradientsContainerType;</a>
<a name="147"><span class="lineNum">     147 </span>            : </a>
<a name="148"><span class="lineNum">     148 </span>            :     /**</a>
<a name="149"><span class="lineNum">     149 </span>            :      * A third order tensor to hold jacobian matrices evaluated at</a>
<a name="150"><span class="lineNum">     150 </span>            :      * integration points. Jacobian and InverseOfJacobian functions</a>
<a name="151"><span class="lineNum">     151 </span>            :      * return this type as their result.</a>
<a name="152"><span class="lineNum">     152 </span>            :      */</a>
<a name="153"><span class="lineNum">     153 </span>            :     typedef typename BaseType::JacobiansType JacobiansType;</a>
<a name="154"><span class="lineNum">     154 </span>            : </a>
<a name="155"><span class="lineNum">     155 </span>            :     /**</a>
<a name="156"><span class="lineNum">     156 </span>            :      * A third order tensor to hold shape functions' local</a>
<a name="157"><span class="lineNum">     157 </span>            :      * gradients. ShapefunctionsLocalGradients function return this</a>
<a name="158"><span class="lineNum">     158 </span>            :      * type as its result.</a>
<a name="159"><span class="lineNum">     159 </span>            :      */</a>
<a name="160"><span class="lineNum">     160 </span>            :     typedef typename BaseType::ShapeFunctionsGradientsType ShapeFunctionsGradientsType;</a>
<a name="161"><span class="lineNum">     161 </span>            : </a>
<a name="162"><span class="lineNum">     162 </span>            :     /**</a>
<a name="163"><span class="lineNum">     163 </span>            :      * A third order tensor to hold shape functions' local second derivatives.</a>
<a name="164"><span class="lineNum">     164 </span>            :      * ShapefunctionsLocalGradients function return this</a>
<a name="165"><span class="lineNum">     165 </span>            :      * type as its result.</a>
<a name="166"><span class="lineNum">     166 </span>            :      */</a>
<a name="167"><span class="lineNum">     167 </span>            :     typedef typename BaseType::ShapeFunctionsSecondDerivativesType</a>
<a name="168"><span class="lineNum">     168 </span>            :     ShapeFunctionsSecondDerivativesType;</a>
<a name="169"><span class="lineNum">     169 </span>            : </a>
<a name="170"><span class="lineNum">     170 </span>            : </a>
<a name="171"><span class="lineNum">     171 </span>            :     /**</a>
<a name="172"><span class="lineNum">     172 </span>            :     * A fourth order tensor to hold shape functions' local third derivatives.</a>
<a name="173"><span class="lineNum">     173 </span>            :     * ShapefunctionsLocalGradients function return this</a>
<a name="174"><span class="lineNum">     174 </span>            :     * type as its result.</a>
<a name="175"><span class="lineNum">     175 </span>            :     */</a>
<a name="176"><span class="lineNum">     176 </span>            :     typedef typename BaseType::ShapeFunctionsThirdDerivativesType</a>
<a name="177"><span class="lineNum">     177 </span>            :     ShapeFunctionsThirdDerivativesType;</a>
<a name="178"><span class="lineNum">     178 </span>            : </a>
<a name="179"><span class="lineNum">     179 </span>            :     /**</a>
<a name="180"><span class="lineNum">     180 </span>            :      * Type of the normal vector used for normal to edges in geomety.</a>
<a name="181"><span class="lineNum">     181 </span>            :      */</a>
<a name="182"><span class="lineNum">     182 </span>            :     typedef typename BaseType::NormalType NormalType;</a>
<a name="183"><span class="lineNum">     183 </span>            : </a>
<a name="184"><span class="lineNum">     184 </span>            :     /**</a>
<a name="185"><span class="lineNum">     185 </span>            :      * Type of coordinates array</a>
<a name="186"><span class="lineNum">     186 </span>            :      */</a>
<a name="187"><span class="lineNum">     187 </span>            :     typedef typename BaseType::CoordinatesArrayType CoordinatesArrayType;</a>
<a name="188"><span class="lineNum">     188 </span>            : </a>
<a name="189"><span class="lineNum">     189 </span>            : </a>
<a name="190"><span class="lineNum">     190 </span>            :     /**</a>
<a name="191"><span class="lineNum">     191 </span>            :      * Life Cycle</a>
<a name="192"><span class="lineNum">     192 </span>            :      */</a>
<a name="193"><span class="lineNum">     193 </span>            :     Quadrilateral2D8( const PointType&amp; Point1, const PointType&amp; Point2,</a>
<a name="194"><span class="lineNum">     194 </span>            :                       const PointType&amp; Point3, const PointType&amp; Point4,</a>
<a name="195"><span class="lineNum">     195 </span>            :                       const PointType&amp; Point5, const PointType&amp; Point6,</a>
<a name="196"><span class="lineNum">     196 </span>            :                       const PointType&amp; Point7, const PointType&amp; Point8</a>
<a name="197"><span class="lineNum">     197 </span>            :                     )</a>
<a name="198"><span class="lineNum">     198 </span>            :         : BaseType( PointsArrayType(), &amp;msGeometryData )</a>
<a name="199"><span class="lineNum">     199 </span>            :     {</a>
<a name="200"><span class="lineNum">     200 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point1 ) ) );</a>
<a name="201"><span class="lineNum">     201 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point2 ) ) );</a>
<a name="202"><span class="lineNum">     202 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point3 ) ) );</a>
<a name="203"><span class="lineNum">     203 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point4 ) ) );</a>
<a name="204"><span class="lineNum">     204 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point5 ) ) );</a>
<a name="205"><span class="lineNum">     205 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point6 ) ) );</a>
<a name="206"><span class="lineNum">     206 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point7 ) ) );</a>
<a name="207"><span class="lineNum">     207 </span>            :         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( Point8 ) ) );</a>
<a name="208"><span class="lineNum">     208 </span>            :     }</a>
<a name="209"><span class="lineNum">     209 </span>            : </a>
<a name="210"><span class="lineNum">     210 </span><span class="lineNoCov">          0 :     Quadrilateral2D8( typename PointType::Pointer pPoint1, typename PointType::Pointer pPoint2,</span></a>
<a name="211"><span class="lineNum">     211 </span>            :                       typename PointType::Pointer pPoint3, typename PointType::Pointer pPoint4,</a>
<a name="212"><span class="lineNum">     212 </span>            :                       typename PointType::Pointer pPoint5, typename PointType::Pointer pPoint6,</a>
<a name="213"><span class="lineNum">     213 </span>            :                       typename PointType::Pointer pPoint7, typename PointType::Pointer pPoint8 )</a>
<a name="214"><span class="lineNum">     214 </span><span class="lineNoCov">          0 :         : BaseType( PointsArrayType(), &amp;msGeometryData )</span></a>
<a name="215"><span class="lineNum">     215 </span>            :     {</a>
<a name="216"><span class="lineNum">     216 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint1 );</span></a>
<a name="217"><span class="lineNum">     217 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint2 );</span></a>
<a name="218"><span class="lineNum">     218 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint3 );</span></a>
<a name="219"><span class="lineNum">     219 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint4 );</span></a>
<a name="220"><span class="lineNum">     220 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint5 );</span></a>
<a name="221"><span class="lineNum">     221 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint6 );</span></a>
<a name="222"><span class="lineNum">     222 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint7 );</span></a>
<a name="223"><span class="lineNum">     223 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pPoint8 );</span></a>
<a name="224"><span class="lineNum">     224 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="225"><span class="lineNum">     225 </span>            : </a>
<a name="226"><span class="lineNum">     226 </span><span class="lineCov">         23 :     Quadrilateral2D8( const PointsArrayType&amp; ThisPoints )</span></a>
<a name="227"><span class="lineNum">     227 </span><span class="lineCov">         23 :         : BaseType( ThisPoints, &amp;msGeometryData )</span></a>
<a name="228"><span class="lineNum">     228 </span>            :     {</a>
<a name="229"><span class="lineNum">     229 </span><span class="lineCov">         23 :         if ( this-&gt;PointsNumber() != 8 )</span></a>
<a name="230"><span class="lineNum">     230 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Invalid points number. Expected 8, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="231"><span class="lineNum">     231 </span><span class="lineCov">         23 :     }</span></a>
<a name="232"><span class="lineNum">     232 </span>            : </a>
<a name="233"><span class="lineNum">     233 </span>            :     /// Constructor with Geometry Id</a>
<a name="234"><span class="lineNum">     234 </span><span class="lineNoCov">          0 :     explicit Quadrilateral2D8(</span></a>
<a name="235"><span class="lineNum">     235 </span>            :         const IndexType GeometryId,</a>
<a name="236"><span class="lineNum">     236 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="237"><span class="lineNum">     237 </span><span class="lineNoCov">          0 :     ) : BaseType(GeometryId, rThisPoints, &amp;msGeometryData)</span></a>
<a name="238"><span class="lineNum">     238 </span>            :     {</a>
<a name="239"><span class="lineNum">     239 </span><span class="lineNoCov">          0 :         KRATOS_ERROR_IF( this-&gt;PointsNumber() != 8 ) &lt;&lt; &quot;Invalid points number. Expected 8, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="240"><span class="lineNum">     240 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="241"><span class="lineNum">     241 </span>            : </a>
<a name="242"><span class="lineNum">     242 </span>            :     /// Constructor with Geometry Name</a>
<a name="243"><span class="lineNum">     243 </span>            :     explicit Quadrilateral2D8(</a>
<a name="244"><span class="lineNum">     244 </span>            :         const std::string&amp; rGeometryName,</a>
<a name="245"><span class="lineNum">     245 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="246"><span class="lineNum">     246 </span>            :     ) : BaseType(rGeometryName, rThisPoints, &amp;msGeometryData)</a>
<a name="247"><span class="lineNum">     247 </span>            :     {</a>
<a name="248"><span class="lineNum">     248 </span>            :         KRATOS_ERROR_IF(this-&gt;PointsNumber() != 8) &lt;&lt; &quot;Invalid points number. Expected 8, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</a>
<a name="249"><span class="lineNum">     249 </span>            :     }</a>
<a name="250"><span class="lineNum">     250 </span>            : </a>
<a name="251"><span class="lineNum">     251 </span>            :     /**</a>
<a name="252"><span class="lineNum">     252 </span>            :      * Copy constructor.</a>
<a name="253"><span class="lineNum">     253 </span>            :      * Constructs this geometry as a copy of given geometry.</a>
<a name="254"><span class="lineNum">     254 </span>            :      *</a>
<a name="255"><span class="lineNum">     255 </span>            :      * @note This copy constructor don't copy the points and new</a>
<a name="256"><span class="lineNum">     256 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="257"><span class="lineNum">     257 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="258"><span class="lineNum">     258 </span>            :      * source geometry's points too.</a>
<a name="259"><span class="lineNum">     259 </span>            :      */</a>
<a name="260"><span class="lineNum">     260 </span>            :     Quadrilateral2D8( Quadrilateral2D8 const&amp; rOther )</a>
<a name="261"><span class="lineNum">     261 </span>            :         : BaseType( rOther )</a>
<a name="262"><span class="lineNum">     262 </span>            :     {</a>
<a name="263"><span class="lineNum">     263 </span>            :     }</a>
<a name="264"><span class="lineNum">     264 </span>            : </a>
<a name="265"><span class="lineNum">     265 </span>            :     /**</a>
<a name="266"><span class="lineNum">     266 </span>            :      * Copy constructor from a geometry with other point type.</a>
<a name="267"><span class="lineNum">     267 </span>            :      * Construct this geometry as a copy of given geometry which</a>
<a name="268"><span class="lineNum">     268 </span>            :      * has different type of points. The given goemetry's</a>
<a name="269"><span class="lineNum">     269 </span>            :      * TOtherPointType* must be implicity convertible to this</a>
<a name="270"><span class="lineNum">     270 </span>            :      * geometry PointType.</a>
<a name="271"><span class="lineNum">     271 </span>            :      *</a>
<a name="272"><span class="lineNum">     272 </span>            :      * @note This copy constructor don't copy the points and new</a>
<a name="273"><span class="lineNum">     273 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="274"><span class="lineNum">     274 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="275"><span class="lineNum">     275 </span>            :      * source geometry's points too.</a>
<a name="276"><span class="lineNum">     276 </span>            :      */</a>
<a name="277"><span class="lineNum">     277 </span>            :     template&lt;class TOtherPointType&gt; Quadrilateral2D8( Quadrilateral2D8&lt;TOtherPointType&gt; const&amp; rOther )</a>
<a name="278"><span class="lineNum">     278 </span>            :         : BaseType( rOther )</a>
<a name="279"><span class="lineNum">     279 </span>            :     {</a>
<a name="280"><span class="lineNum">     280 </span>            :     }</a>
<a name="281"><span class="lineNum">     281 </span>            : </a>
<a name="282"><span class="lineNum">     282 </span>            :     /**</a>
<a name="283"><span class="lineNum">     283 </span>            :      * Destructor. Does nothing!!!</a>
<a name="284"><span class="lineNum">     284 </span>            :      */</a>
<a name="285"><span class="lineNum">     285 </span><span class="lineCov">         43 :     ~Quadrilateral2D8() override {}</span></a>
<a name="286"><span class="lineNum">     286 </span>            : </a>
<a name="287"><span class="lineNum">     287 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryFamily GetGeometryFamily() const override</span></a>
<a name="288"><span class="lineNum">     288 </span>            :     {</a>
<a name="289"><span class="lineNum">     289 </span><span class="lineNoCov">          0 :         return GeometryData::KratosGeometryFamily::Kratos_Quadrilateral;</span></a>
<a name="290"><span class="lineNum">     290 </span>            :     }</a>
<a name="291"><span class="lineNum">     291 </span>            : </a>
<a name="292"><span class="lineNum">     292 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryType GetGeometryType() const override</span></a>
<a name="293"><span class="lineNum">     293 </span>            :     {</a>
<a name="294"><span class="lineNum">     294 </span><span class="lineNoCov">          0 :         return GeometryData::KratosGeometryType::Kratos_Quadrilateral2D8;</span></a>
<a name="295"><span class="lineNum">     295 </span>            :     }</a>
<a name="296"><span class="lineNum">     296 </span>            : </a>
<a name="297"><span class="lineNum">     297 </span>            :     /**</a>
<a name="298"><span class="lineNum">     298 </span>            :      * Operators</a>
<a name="299"><span class="lineNum">     299 </span>            :      */</a>
<a name="300"><span class="lineNum">     300 </span>            : </a>
<a name="301"><span class="lineNum">     301 </span>            :     /**</a>
<a name="302"><span class="lineNum">     302 </span>            :      * Assignment operator.</a>
<a name="303"><span class="lineNum">     303 </span>            :      *</a>
<a name="304"><span class="lineNum">     304 </span>            :      * @note This operator don't copy the points and this</a>
<a name="305"><span class="lineNum">     305 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="306"><span class="lineNum">     306 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="307"><span class="lineNum">     307 </span>            :      * source geometry's points too.</a>
<a name="308"><span class="lineNum">     308 </span>            :      *</a>
<a name="309"><span class="lineNum">     309 </span>            :      * @see Clone</a>
<a name="310"><span class="lineNum">     310 </span>            :      * @see ClonePoints</a>
<a name="311"><span class="lineNum">     311 </span>            :      */</a>
<a name="312"><span class="lineNum">     312 </span>            :     Quadrilateral2D8&amp; operator=( const Quadrilateral2D8&amp; rOther )</a>
<a name="313"><span class="lineNum">     313 </span>            :     {</a>
<a name="314"><span class="lineNum">     314 </span>            :         BaseType::operator=( rOther );</a>
<a name="315"><span class="lineNum">     315 </span>            : </a>
<a name="316"><span class="lineNum">     316 </span>            :         return *this;</a>
<a name="317"><span class="lineNum">     317 </span>            :     }</a>
<a name="318"><span class="lineNum">     318 </span>            : </a>
<a name="319"><span class="lineNum">     319 </span>            :     /**</a>
<a name="320"><span class="lineNum">     320 </span>            :      * Assignment operator for geometries with different point type.</a>
<a name="321"><span class="lineNum">     321 </span>            :      *</a>
<a name="322"><span class="lineNum">     322 </span>            :      * @note This operator don't copy the points and this</a>
<a name="323"><span class="lineNum">     323 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="324"><span class="lineNum">     324 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="325"><span class="lineNum">     325 </span>            :      * source geometry's points too.</a>
<a name="326"><span class="lineNum">     326 </span>            :      *</a>
<a name="327"><span class="lineNum">     327 </span>            :      * @see Clone</a>
<a name="328"><span class="lineNum">     328 </span>            :      * @see ClonePoints</a>
<a name="329"><span class="lineNum">     329 </span>            :     */</a>
<a name="330"><span class="lineNum">     330 </span>            :     template&lt;class TOtherPointType&gt;</a>
<a name="331"><span class="lineNum">     331 </span>            :     Quadrilateral2D8&amp; operator=( Quadrilateral2D8&lt;TOtherPointType&gt; const &amp; rOther )</a>
<a name="332"><span class="lineNum">     332 </span>            :     {</a>
<a name="333"><span class="lineNum">     333 </span>            :         BaseType::operator=( rOther );</a>
<a name="334"><span class="lineNum">     334 </span>            : </a>
<a name="335"><span class="lineNum">     335 </span>            :         return *this;</a>
<a name="336"><span class="lineNum">     336 </span>            :     }</a>
<a name="337"><span class="lineNum">     337 </span>            : </a>
<a name="338"><span class="lineNum">     338 </span>            :     /**</a>
<a name="339"><span class="lineNum">     339 </span>            :      * Operations</a>
<a name="340"><span class="lineNum">     340 </span>            :      */</a>
<a name="341"><span class="lineNum">     341 </span>            : </a>
<a name="342"><span class="lineNum">     342 </span>            :     /**</a>
<a name="343"><span class="lineNum">     343 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="344"><span class="lineNum">     344 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="345"><span class="lineNum">     345 </span>            :      * @param rThisPoints the nodes of the new geometry</a>
<a name="346"><span class="lineNum">     346 </span>            :      * @return Pointer to the new geometry</a>
<a name="347"><span class="lineNum">     347 </span>            :      */</a>
<a name="348"><span class="lineNum">     348 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="349"><span class="lineNum">     349 </span>            :         const IndexType NewGeometryId,</a>
<a name="350"><span class="lineNum">     350 </span>            :         PointsArrayType const&amp; rThisPoints</a>
<a name="351"><span class="lineNum">     351 </span>            :         ) const override</a>
<a name="352"><span class="lineNum">     352 </span>            :     {</a>
<a name="353"><span class="lineNum">     353 </span><span class="lineNoCov">          0 :         return typename BaseType::Pointer( new Quadrilateral2D8( NewGeometryId, rThisPoints ) );</span></a>
<a name="354"><span class="lineNum">     354 </span>            :     }</a>
<a name="355"><span class="lineNum">     355 </span>            : </a>
<a name="356"><span class="lineNum">     356 </span>            :     /**</a>
<a name="357"><span class="lineNum">     357 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="358"><span class="lineNum">     358 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="359"><span class="lineNum">     359 </span>            :      * @param rGeometry reference to an existing geometry</a>
<a name="360"><span class="lineNum">     360 </span>            :      * @return Pointer to the new geometry</a>
<a name="361"><span class="lineNum">     361 </span>            :      */</a>
<a name="362"><span class="lineNum">     362 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="363"><span class="lineNum">     363 </span>            :         const IndexType NewGeometryId,</a>
<a name="364"><span class="lineNum">     364 </span>            :         const BaseType&amp; rGeometry</a>
<a name="365"><span class="lineNum">     365 </span>            :         ) const override</a>
<a name="366"><span class="lineNum">     366 </span>            :     {</a>
<a name="367"><span class="lineNum">     367 </span><span class="lineNoCov">          0 :         auto p_geometry = typename BaseType::Pointer( new Quadrilateral2D8( NewGeometryId, rGeometry.Points() ) );</span></a>
<a name="368"><span class="lineNum">     368 </span>            :         p_geometry-&gt;SetData(rGeometry.GetData());</a>
<a name="369"><span class="lineNum">     369 </span><span class="lineNoCov">          0 :         return p_geometry;</span></a>
<a name="370"><span class="lineNum">     370 </span>            :     }</a>
<a name="371"><span class="lineNum">     371 </span>            : </a>
<a name="372"><span class="lineNum">     372 </span>            :     /**</a>
<a name="373"><span class="lineNum">     373 </span>            :      * Information</a>
<a name="374"><span class="lineNum">     374 </span>            :      */</a>
<a name="375"><span class="lineNum">     375 </span>            : </a>
<a name="376"><span class="lineNum">     376 </span>            :      /// Returns number of points per direction.</a>
<a name="377"><span class="lineNum">     377 </span><span class="lineNoCov">          0 :     SizeType PointsNumberInDirection(IndexType LocalDirectionIndex) const override</span></a>
<a name="378"><span class="lineNum">     378 </span>            :     {</a>
<a name="379"><span class="lineNum">     379 </span><span class="lineNoCov">          0 :         if ((LocalDirectionIndex == 0) || (LocalDirectionIndex == 1)) {</span></a>
<a name="380"><span class="lineNum">     380 </span><span class="lineNoCov">          0 :             return 3;</span></a>
<a name="381"><span class="lineNum">     381 </span>            :         }</a>
<a name="382"><span class="lineNum">     382 </span><span class="lineNoCov">          0 :         KRATOS_ERROR &lt;&lt; &quot;Possible direction index reaches from 0-1. Given direction index: &quot;</span></a>
<a name="383"><span class="lineNum">     383 </span><span class="lineNoCov">          0 :             &lt;&lt; LocalDirectionIndex &lt;&lt; std::endl;</span></a>
<a name="384"><span class="lineNum">     384 </span>            :     }</a>
<a name="385"><span class="lineNum">     385 </span>            : </a>
<a name="386"><span class="lineNum">     386 </span>            :     /**</a>
<a name="387"><span class="lineNum">     387 </span>            :      * This method calculates and returns Length or charactereistic</a>
<a name="388"><span class="lineNum">     388 </span>            :      * length of this geometry depending on it's dimension. For one</a>
<a name="389"><span class="lineNum">     389 </span>            :      * dimensional geometry for example Line it returns length of it</a>
<a name="390"><span class="lineNum">     390 </span>            :      * and for the other geometries it gives Characteristic length</a>
<a name="391"><span class="lineNum">     391 </span>            :      * otherwise.</a>
<a name="392"><span class="lineNum">     392 </span>            :      *</a>
<a name="393"><span class="lineNum">     393 </span>            :      * @return double value contains length or Characteristic</a>
<a name="394"><span class="lineNum">     394 </span>            :      * length</a>
<a name="395"><span class="lineNum">     395 </span>            :      * @see Area()</a>
<a name="396"><span class="lineNum">     396 </span>            :      * @see Volume()</a>
<a name="397"><span class="lineNum">     397 </span>            :      * @see DomainSize()</a>
<a name="398"><span class="lineNum">     398 </span>            :     */</a>
<a name="399"><span class="lineNum">     399 </span>            :     /**</a>
<a name="400"><span class="lineNum">     400 </span>            :      * :TODO: the characteristic length is to be reviewed</a>
<a name="401"><span class="lineNum">     401 </span>            :      * (comment by janosch)</a>
<a name="402"><span class="lineNum">     402 </span>            :      */</a>
<a name="403"><span class="lineNum">     403 </span><span class="lineNoCov">          0 :     double Length() const override</span></a>
<a name="404"><span class="lineNum">     404 </span>            :     {</a>
<a name="405"><span class="lineNum">     405 </span>            :         array_1d&lt;double,3&gt; point;</a>
<a name="406"><span class="lineNum">     406 </span><span class="lineNoCov">          0 :         point[0] = 1.0/3.0; point[1] = 1.0/3.0; point[2] = 1.0/3.0;</span></a>
<a name="407"><span class="lineNum">     407 </span><span class="lineNoCov">          0 :         return sqrt( fabs( DeterminantOfJacobian( point ) ) );</span></a>
<a name="408"><span class="lineNum">     408 </span>            :     }</a>
<a name="409"><span class="lineNum">     409 </span>            : </a>
<a name="410"><span class="lineNum">     410 </span>            :     /** This method calculates and returns area or surface area of</a>
<a name="411"><span class="lineNum">     411 </span>            :      * this geometry depending to it's dimension. For one dimensional</a>
<a name="412"><span class="lineNum">     412 </span>            :      * geometry it returns zero, for two dimensional it gives area</a>
<a name="413"><span class="lineNum">     413 </span>            :      * and for three dimensional geometries it gives surface area.</a>
<a name="414"><span class="lineNum">     414 </span>            :      *</a>
<a name="415"><span class="lineNum">     415 </span>            :      * @return double value contains area or surface</a>
<a name="416"><span class="lineNum">     416 </span>            :      * area.N</a>
<a name="417"><span class="lineNum">     417 </span>            :      * @see Length()</a>
<a name="418"><span class="lineNum">     418 </span>            :      * @see Volume()</a>
<a name="419"><span class="lineNum">     419 </span>            :      * @see DomainSize()</a>
<a name="420"><span class="lineNum">     420 </span>            :      * @todo could be replaced by something more suitable (comment by janosch)</a>
<a name="421"><span class="lineNum">     421 </span>            :      */</a>
<a name="422"><span class="lineNum">     422 </span><span class="lineNoCov">          0 :     double Area() const override</span></a>
<a name="423"><span class="lineNum">     423 </span>            :     {</a>
<a name="424"><span class="lineNum">     424 </span><span class="lineNoCov">          0 :         return IntegrationUtilities::ComputeArea2DGeometry(*this);</span></a>
<a name="425"><span class="lineNum">     425 </span>            :     }</a>
<a name="426"><span class="lineNum">     426 </span>            : </a>
<a name="427"><span class="lineNum">     427 </span>            :     // TODO: Code activated in June 2023</a>
<a name="428"><span class="lineNum">     428 </span>            :     // /**</a>
<a name="429"><span class="lineNum">     429 </span>            :     //  * @brief This method calculates and returns the volume of this geometry.</a>
<a name="430"><span class="lineNum">     430 </span>            :     //  * @return Error, the volume of a 2D geometry is not defined</a>
<a name="431"><span class="lineNum">     431 </span>            :     //  * @see Length()</a>
<a name="432"><span class="lineNum">     432 </span>            :     //  * @see Area()</a>
<a name="433"><span class="lineNum">     433 </span>            :     //  * @see Volume()</a>
<a name="434"><span class="lineNum">     434 </span>            :     //  */</a>
<a name="435"><span class="lineNum">     435 </span>            :     // double Volume() const override</a>
<a name="436"><span class="lineNum">     436 </span>            :     // {</a>
<a name="437"><span class="lineNum">     437 </span>            :     //     KRATOS_ERROR &lt;&lt; &quot;Quadrilateral2D8:: Method not well defined. Replace with DomainSize() instead.&quot; &lt;&lt; std::endl; </a>
<a name="438"><span class="lineNum">     438 </span>            :     //     return 0.0;</a>
<a name="439"><span class="lineNum">     439 </span>            :     // }</a>
<a name="440"><span class="lineNum">     440 </span>            : </a>
<a name="441"><span class="lineNum">     441 </span>            :     /** This method calculates and returns length, area or volume of</a>
<a name="442"><span class="lineNum">     442 </span>            :      * this geometry depending to it's dimension. For one dimensional</a>
<a name="443"><span class="lineNum">     443 </span>            :      * geometry it returns its length, for two dimensional it gives area</a>
<a name="444"><span class="lineNum">     444 </span>            :      * and for three dimensional geometries it gives its volume.</a>
<a name="445"><span class="lineNum">     445 </span>            :      *</a>
<a name="446"><span class="lineNum">     446 </span>            :      * @return double value contains length, area or volume.</a>
<a name="447"><span class="lineNum">     447 </span>            :      * @see Length()</a>
<a name="448"><span class="lineNum">     448 </span>            :      * @see Area()</a>
<a name="449"><span class="lineNum">     449 </span>            :      * @see Volume()</a>
<a name="450"><span class="lineNum">     450 </span>            :      * @todo could be replaced by something more suitable (comment by janosch)</a>
<a name="451"><span class="lineNum">     451 </span>            :      */</a>
<a name="452"><span class="lineNum">     452 </span><span class="lineNoCov">          0 :     double DomainSize() const override</span></a>
<a name="453"><span class="lineNum">     453 </span>            :     {</a>
<a name="454"><span class="lineNum">     454 </span><span class="lineNoCov">          0 :         return Area();</span></a>
<a name="455"><span class="lineNum">     455 </span>            :     }</a>
<a name="456"><span class="lineNum">     456 </span>            : </a>
<a name="457"><span class="lineNum">     457 </span>            :     /**</a>
<a name="458"><span class="lineNum">     458 </span>            :      * @brief Returns whether given arbitrary point is inside the Geometry and the respective</a>
<a name="459"><span class="lineNum">     459 </span>            :      * local point for the given global point</a>
<a name="460"><span class="lineNum">     460 </span>            :      * @param rPoint The point to be checked if is inside o note in global coordinates</a>
<a name="461"><span class="lineNum">     461 </span>            :      * @param rResult The local coordinates of the point</a>
<a name="462"><span class="lineNum">     462 </span>            :      * @param Tolerance The  tolerance that will be considered to check if the point is inside or not</a>
<a name="463"><span class="lineNum">     463 </span>            :      * @return True if the point is inside, false otherwise</a>
<a name="464"><span class="lineNum">     464 </span>            :      */</a>
<a name="465"><span class="lineNum">     465 </span><span class="lineNoCov">          0 :     bool IsInside(</span></a>
<a name="466"><span class="lineNum">     466 </span>            :         const CoordinatesArrayType&amp; rPoint,</a>
<a name="467"><span class="lineNum">     467 </span>            :         CoordinatesArrayType&amp; rResult,</a>
<a name="468"><span class="lineNum">     468 </span>            :         const double Tolerance = std::numeric_limits&lt;double&gt;::epsilon()</a>
<a name="469"><span class="lineNum">     469 </span>            :         ) const override</a>
<a name="470"><span class="lineNum">     470 </span>            :     {</a>
<a name="471"><span class="lineNum">     471 </span><span class="lineNoCov">          0 :         this-&gt;PointLocalCoordinates( rResult, rPoint );</span></a>
<a name="472"><span class="lineNum">     472 </span>            : </a>
<a name="473"><span class="lineNum">     473 </span><span class="lineNoCov">          0 :         if ( std::abs( rResult[0] ) &lt;= (1.0 + Tolerance) )</span></a>
<a name="474"><span class="lineNum">     474 </span>            :         {</a>
<a name="475"><span class="lineNum">     475 </span><span class="lineNoCov">          0 :             if ( std::abs( rResult[1] ) &lt;= (1.0 + Tolerance) )</span></a>
<a name="476"><span class="lineNum">     476 </span>            :             {</a>
<a name="477"><span class="lineNum">     477 </span><span class="lineNoCov">          0 :                 return true;</span></a>
<a name="478"><span class="lineNum">     478 </span>            :             }</a>
<a name="479"><span class="lineNum">     479 </span>            :         }</a>
<a name="480"><span class="lineNum">     480 </span>            : </a>
<a name="481"><span class="lineNum">     481 </span>            :         return false;</a>
<a name="482"><span class="lineNum">     482 </span>            :     }</a>
<a name="483"><span class="lineNum">     483 </span>            : </a>
<a name="484"><span class="lineNum">     484 </span>            :     /**</a>
<a name="485"><span class="lineNum">     485 </span>            :      * Jacobian</a>
<a name="486"><span class="lineNum">     486 </span>            :      */</a>
<a name="487"><span class="lineNum">     487 </span>            :     /**</a>
<a name="488"><span class="lineNum">     488 </span>            :      * TODO: implemented but not yet tested</a>
<a name="489"><span class="lineNum">     489 </span>            :      */</a>
<a name="490"><span class="lineNum">     490 </span>            :     /**</a>
<a name="491"><span class="lineNum">     491 </span>            :      * Jacobians for given  method.</a>
<a name="492"><span class="lineNum">     492 </span>            :      * This method claculates the jacobian matrices in all</a>
<a name="493"><span class="lineNum">     493 </span>            :      * integrations points of given integration method.</a>
<a name="494"><span class="lineNum">     494 </span>            :      *</a>
<a name="495"><span class="lineNum">     495 </span>            :      * @param ThisMethod integration method which jacobians has to</a>
<a name="496"><span class="lineNum">     496 </span>            :      * be calculated in its integration points.</a>
<a name="497"><span class="lineNum">     497 </span>            :      *</a>
<a name="498"><span class="lineNum">     498 </span>            :      * @return JacobiansType a Vector of jacobian</a>
<a name="499"><span class="lineNum">     499 </span>            :      * matrices \f$ J_i \f$ where \f$ i=1,2,...,n \f$ is the integration</a>
<a name="500"><span class="lineNum">     500 </span>            :      * point index of given integration method.</a>
<a name="501"><span class="lineNum">     501 </span>            :      *</a>
<a name="502"><span class="lineNum">     502 </span>            :      * @see DeterminantOfJacobian</a>
<a name="503"><span class="lineNum">     503 </span>            :      * @see InverseOfJacobian</a>
<a name="504"><span class="lineNum">     504 </span>            :      */</a>
<a name="505"><span class="lineNum">     505 </span><span class="lineNoCov">          0 :     JacobiansType&amp; Jacobian( JacobiansType&amp; rResult,</span></a>
<a name="506"><span class="lineNum">     506 </span>            :                                      IntegrationMethod ThisMethod ) const override</a>
<a name="507"><span class="lineNum">     507 </span>            :     {</a>
<a name="508"><span class="lineNum">     508 </span>            :         //getting derivatives of shape functions</a>
<a name="509"><span class="lineNum">     509 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType shape_functions_gradients =</span></a>
<a name="510"><span class="lineNum">     510 </span>            :             CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="511"><span class="lineNum">     511 </span>            :         //getting values of shape functions</a>
<a name="512"><span class="lineNum">     512 </span><span class="lineNoCov">          0 :         Matrix shape_functions_values =</span></a>
<a name="513"><span class="lineNum">     513 </span>            :             CalculateShapeFunctionsIntegrationPointsValues( ThisMethod );</a>
<a name="514"><span class="lineNum">     514 </span>            :         //workaround by riccardo...</a>
<a name="515"><span class="lineNum">     515 </span>            : </a>
<a name="516"><span class="lineNum">     516 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;IntegrationPointsNumber( ThisMethod ) )</span></a>
<a name="517"><span class="lineNum">     517 </span>            :         {</a>
<a name="518"><span class="lineNum">     518 </span>            :             // KLUDGE: While there is a bug in ublas</a>
<a name="519"><span class="lineNum">     519 </span>            :             // vector resize, I have to put this beside resizing!!</a>
<a name="520"><span class="lineNum">     520 </span>            :             JacobiansType temp( this-&gt;IntegrationPointsNumber( ThisMethod ) );</a>
<a name="521"><span class="lineNum">     521 </span>            :             rResult.swap( temp );</a>
<a name="522"><span class="lineNum">     522 </span>            :         }</a>
<a name="523"><span class="lineNum">     523 </span>            : </a>
<a name="524"><span class="lineNum">     524 </span>            :         //loop over all integration points</a>
<a name="525"><span class="lineNum">     525 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; this-&gt;IntegrationPointsNumber( ThisMethod ); pnt++ )</span></a>
<a name="526"><span class="lineNum">     526 </span>            :         {</a>
<a name="527"><span class="lineNum">     527 </span>            :             //defining single jacobian matrix</a>
<a name="528"><span class="lineNum">     528 </span><span class="lineNoCov">          0 :             Matrix jacobian = ZeroMatrix( 2, 2 );</span></a>
<a name="529"><span class="lineNum">     529 </span>            :             //loop over all nodes</a>
<a name="530"><span class="lineNum">     530 </span>            : </a>
<a name="531"><span class="lineNum">     531 </span><span class="lineNoCov">          0 :             for ( unsigned int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="532"><span class="lineNum">     532 </span>            :             {</a>
<a name="533"><span class="lineNum">     533 </span><span class="lineNoCov">          0 :                 jacobian( 0, 0 ) += ( this-&gt;GetPoint( i ).X() ) * ( shape_functions_gradients[pnt]( i, 0 ) );</span></a>
<a name="534"><span class="lineNum">     534 </span><span class="lineNoCov">          0 :                 jacobian( 0, 1 ) += ( this-&gt;GetPoint( i ).X() ) * ( shape_functions_gradients[pnt]( i, 1 ) );</span></a>
<a name="535"><span class="lineNum">     535 </span><span class="lineNoCov">          0 :                 jacobian( 1, 0 ) += ( this-&gt;GetPoint( i ).Y() ) * ( shape_functions_gradients[pnt]( i, 0 ) );</span></a>
<a name="536"><span class="lineNum">     536 </span><span class="lineNoCov">          0 :                 jacobian( 1, 1 ) += ( this-&gt;GetPoint( i ).Y() ) * ( shape_functions_gradients[pnt]( i, 1 ) );</span></a>
<a name="537"><span class="lineNum">     537 </span>            :             }</a>
<a name="538"><span class="lineNum">     538 </span>            : </a>
<a name="539"><span class="lineNum">     539 </span><span class="lineNoCov">          0 :             rResult[pnt] = jacobian;</span></a>
<a name="540"><span class="lineNum">     540 </span>            :         }//end of loop over all integration points</a>
<a name="541"><span class="lineNum">     541 </span>            : </a>
<a name="542"><span class="lineNum">     542 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="543"><span class="lineNum">     543 </span>            :     }</a>
<a name="544"><span class="lineNum">     544 </span>            : </a>
<a name="545"><span class="lineNum">     545 </span>            :     /**</a>
<a name="546"><span class="lineNum">     546 </span>            :      * Jacobians for given  method.</a>
<a name="547"><span class="lineNum">     547 </span>            :      * This method claculates the jacobian matrices in all</a>
<a name="548"><span class="lineNum">     548 </span>            :      * integrations points of given integration method.</a>
<a name="549"><span class="lineNum">     549 </span>            :      *</a>
<a name="550"><span class="lineNum">     550 </span>            :      * @param ThisMethod integration method which jacobians has to</a>
<a name="551"><span class="lineNum">     551 </span>            :      * be calculated in its integration points.</a>
<a name="552"><span class="lineNum">     552 </span>            :      *</a>
<a name="553"><span class="lineNum">     553 </span>            :      * @return JacobiansType a Vector of jacobian</a>
<a name="554"><span class="lineNum">     554 </span>            :      * matrices \f$ J_i \f$ where \f$ i=1,2,...,n \f$ is the integration</a>
<a name="555"><span class="lineNum">     555 </span>            :      * point index of given integration method.</a>
<a name="556"><span class="lineNum">     556 </span>            :      *</a>
<a name="557"><span class="lineNum">     557 </span>            :      * @param DeltaPosition Matrix with the nodes position increment which describes</a>
<a name="558"><span class="lineNum">     558 </span>            :      * the configuration where the jacobian has to be calculated.</a>
<a name="559"><span class="lineNum">     559 </span>            :      *</a>
<a name="560"><span class="lineNum">     560 </span>            :      * @see DeterminantOfJacobian</a>
<a name="561"><span class="lineNum">     561 </span>            :      * @see InverseOfJacobian</a>
<a name="562"><span class="lineNum">     562 </span>            :      */</a>
<a name="563"><span class="lineNum">     563 </span><span class="lineNoCov">          0 :     JacobiansType&amp; Jacobian( JacobiansType&amp; rResult,</span></a>
<a name="564"><span class="lineNum">     564 </span>            :                                      IntegrationMethod ThisMethod,</a>
<a name="565"><span class="lineNum">     565 </span>            :                                      Matrix &amp; DeltaPosition ) const override</a>
<a name="566"><span class="lineNum">     566 </span>            :     {</a>
<a name="567"><span class="lineNum">     567 </span>            :         //getting derivatives of shape functions</a>
<a name="568"><span class="lineNum">     568 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType shape_functions_gradients =</span></a>
<a name="569"><span class="lineNum">     569 </span>            :             CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="570"><span class="lineNum">     570 </span>            :         //getting values of shape functions</a>
<a name="571"><span class="lineNum">     571 </span><span class="lineNoCov">          0 :         Matrix shape_functions_values =</span></a>
<a name="572"><span class="lineNum">     572 </span>            :             CalculateShapeFunctionsIntegrationPointsValues( ThisMethod );</a>
<a name="573"><span class="lineNum">     573 </span>            :         //workaround by riccardo...</a>
<a name="574"><span class="lineNum">     574 </span>            : </a>
<a name="575"><span class="lineNum">     575 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;IntegrationPointsNumber( ThisMethod ) )</span></a>
<a name="576"><span class="lineNum">     576 </span>            :         {</a>
<a name="577"><span class="lineNum">     577 </span>            :             // KLUDGE: While there is a bug in ublas</a>
<a name="578"><span class="lineNum">     578 </span>            :             // vector resize, I have to put this beside resizing!!</a>
<a name="579"><span class="lineNum">     579 </span>            :             JacobiansType temp( this-&gt;IntegrationPointsNumber( ThisMethod ) );</a>
<a name="580"><span class="lineNum">     580 </span>            :             rResult.swap( temp );</a>
<a name="581"><span class="lineNum">     581 </span>            :         }</a>
<a name="582"><span class="lineNum">     582 </span>            : </a>
<a name="583"><span class="lineNum">     583 </span>            :         //loop over all integration points</a>
<a name="584"><span class="lineNum">     584 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; this-&gt;IntegrationPointsNumber( ThisMethod ); pnt++ )</span></a>
<a name="585"><span class="lineNum">     585 </span>            :         {</a>
<a name="586"><span class="lineNum">     586 </span>            :             //defining single jacobian matrix</a>
<a name="587"><span class="lineNum">     587 </span><span class="lineNoCov">          0 :             Matrix jacobian = ZeroMatrix( 2, 2 );</span></a>
<a name="588"><span class="lineNum">     588 </span>            :             //loop over all nodes</a>
<a name="589"><span class="lineNum">     589 </span>            : </a>
<a name="590"><span class="lineNum">     590 </span><span class="lineNoCov">          0 :             for ( unsigned int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="591"><span class="lineNum">     591 </span>            :             {</a>
<a name="592"><span class="lineNum">     592 </span><span class="lineNoCov">          0 :                 jacobian( 0, 0 ) += ( this-&gt;GetPoint( i ).X() - DeltaPosition(i,0) ) * ( shape_functions_gradients[pnt]( i, 0 ) );</span></a>
<a name="593"><span class="lineNum">     593 </span><span class="lineNoCov">          0 :                 jacobian( 0, 1 ) += ( this-&gt;GetPoint( i ).X() - DeltaPosition(i,0) ) * ( shape_functions_gradients[pnt]( i, 1 ) );</span></a>
<a name="594"><span class="lineNum">     594 </span><span class="lineNoCov">          0 :                 jacobian( 1, 0 ) += ( this-&gt;GetPoint( i ).Y() - DeltaPosition(i,1) ) * ( shape_functions_gradients[pnt]( i, 0 ) );</span></a>
<a name="595"><span class="lineNum">     595 </span><span class="lineNoCov">          0 :                 jacobian( 1, 1 ) += ( this-&gt;GetPoint( i ).Y() - DeltaPosition(i,1) ) * ( shape_functions_gradients[pnt]( i, 1 ) );</span></a>
<a name="596"><span class="lineNum">     596 </span>            :             }</a>
<a name="597"><span class="lineNum">     597 </span>            : </a>
<a name="598"><span class="lineNum">     598 </span><span class="lineNoCov">          0 :             rResult[pnt] = jacobian;</span></a>
<a name="599"><span class="lineNum">     599 </span>            :         }//end of loop over all integration points</a>
<a name="600"><span class="lineNum">     600 </span>            : </a>
<a name="601"><span class="lineNum">     601 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="602"><span class="lineNum">     602 </span>            :     }</a>
<a name="603"><span class="lineNum">     603 </span>            : </a>
<a name="604"><span class="lineNum">     604 </span>            :     /**</a>
<a name="605"><span class="lineNum">     605 </span>            :      * TODO: implemented but not yet tested</a>
<a name="606"><span class="lineNum">     606 </span>            :      */</a>
<a name="607"><span class="lineNum">     607 </span>            :     /**</a>
<a name="608"><span class="lineNum">     608 </span>            :      * Jacobian in specific integration point of given integration</a>
<a name="609"><span class="lineNum">     609 </span>            :      * method. This method calculate jacobian matrix in given</a>
<a name="610"><span class="lineNum">     610 </span>            :      * integration point of given integration method.</a>
<a name="611"><span class="lineNum">     611 </span>            :      *</a>
<a name="612"><span class="lineNum">     612 </span>            :      * @param IntegrationPointIndex index of integration point which jacobians has to</a>
<a name="613"><span class="lineNum">     613 </span>            :      * be calculated in it.</a>
<a name="614"><span class="lineNum">     614 </span>            :      *</a>
<a name="615"><span class="lineNum">     615 </span>            :      * @param ThisMethod integration method which jacobians has to</a>
<a name="616"><span class="lineNum">     616 </span>            :      * be calculated in its integration points.</a>
<a name="617"><span class="lineNum">     617 </span>            :      *</a>
<a name="618"><span class="lineNum">     618 </span>            :      * @return Matrix(double) Jacobian matrix \f$ J_i \f$ where \f$</a>
<a name="619"><span class="lineNum">     619 </span>            :      * i \f$ is the given integration point index of given</a>
<a name="620"><span class="lineNum">     620 </span>            :      * integration method.</a>
<a name="621"><span class="lineNum">     621 </span>            :      * @see DeterminantOfJacobian</a>
<a name="622"><span class="lineNum">     622 </span>            :      * @see InverseOfJacobian</a>
<a name="623"><span class="lineNum">     623 </span>            :      */</a>
<a name="624"><span class="lineNum">     624 </span><span class="lineNoCov">          0 :     Matrix&amp; Jacobian( Matrix&amp; rResult, IndexType IntegrationPointIndex, IntegrationMethod ThisMethod ) const override</span></a>
<a name="625"><span class="lineNum">     625 </span>            :     {</a>
<a name="626"><span class="lineNum">     626 </span>            :         // Setting up size of jacobian matrix</a>
<a name="627"><span class="lineNum">     627 </span><span class="lineNoCov">          0 :         if (rResult.size1() != 2 || rResult.size2() != 2)</span></a>
<a name="628"><span class="lineNum">     628 </span><span class="lineNoCov">          0 :             rResult.resize( 2, 2 , false);</span></a>
<a name="629"><span class="lineNum">     629 </span>            :         rResult.clear();</a>
<a name="630"><span class="lineNum">     630 </span>            :         //derivatives of shape functions</a>
<a name="631"><span class="lineNum">     631 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType shape_functions_gradients = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</span></a>
<a name="632"><span class="lineNum">     632 </span>            :         Matrix ShapeFunctionsGradientInIntegrationPoint = shape_functions_gradients( IntegrationPointIndex );</a>
<a name="633"><span class="lineNum">     633 </span>            :         //values of shape functions in integration points</a>
<a name="634"><span class="lineNum">     634 </span><span class="lineNoCov">          0 :         DenseVector&lt;double&gt; ShapeFunctionsValuesInIntegrationPoint = ZeroVector( 8 );</span></a>
<a name="635"><span class="lineNum">     635 </span><span class="lineNoCov">          0 :         ShapeFunctionsValuesInIntegrationPoint =row( CalculateShapeFunctionsIntegrationPointsValues( ThisMethod ), IntegrationPointIndex );</span></a>
<a name="636"><span class="lineNum">     636 </span>            : </a>
<a name="637"><span class="lineNum">     637 </span>            :         //Elements of jacobian matrix (e.g. J(1,1) = dX1/dXi1)</a>
<a name="638"><span class="lineNum">     638 </span>            :         // Loop over all nodes</a>
<a name="639"><span class="lineNum">     639 </span><span class="lineNoCov">          0 :         for ( unsigned int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="640"><span class="lineNum">     640 </span>            :         {</a>
<a name="641"><span class="lineNum">     641 </span><span class="lineNoCov">          0 :             rResult( 0, 0 ) +=</span></a>
<a name="642"><span class="lineNum">     642 </span><span class="lineNoCov">          0 :                 ( this-&gt;GetPoint( i ).X() ) * ( ShapeFunctionsGradientInIntegrationPoint( i, 0 ) );</span></a>
<a name="643"><span class="lineNum">     643 </span><span class="lineNoCov">          0 :             rResult( 0, 1 ) +=</span></a>
<a name="644"><span class="lineNum">     644 </span><span class="lineNoCov">          0 :                 ( this-&gt;GetPoint( i ).X() ) * ( ShapeFunctionsGradientInIntegrationPoint( i, 1 ) );</span></a>
<a name="645"><span class="lineNum">     645 </span><span class="lineNoCov">          0 :             rResult( 1, 0 ) +=</span></a>
<a name="646"><span class="lineNum">     646 </span><span class="lineNoCov">          0 :                 ( this-&gt;GetPoint( i ).Y() ) * ( ShapeFunctionsGradientInIntegrationPoint( i, 0 ) );</span></a>
<a name="647"><span class="lineNum">     647 </span><span class="lineNoCov">          0 :             rResult( 1, 1 ) +=</span></a>
<a name="648"><span class="lineNum">     648 </span><span class="lineNoCov">          0 :                 ( this-&gt;GetPoint( i ).Y() ) * ( ShapeFunctionsGradientInIntegrationPoint( i, 1 ) );</span></a>
<a name="649"><span class="lineNum">     649 </span>            :         }</a>
<a name="650"><span class="lineNum">     650 </span>            : </a>
<a name="651"><span class="lineNum">     651 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="652"><span class="lineNum">     652 </span>            :     }</a>
<a name="653"><span class="lineNum">     653 </span>            : </a>
<a name="654"><span class="lineNum">     654 </span>            :     /**</a>
<a name="655"><span class="lineNum">     655 </span>            :      * TODO: implemented but not yet tested</a>
<a name="656"><span class="lineNum">     656 </span>            :      */</a>
<a name="657"><span class="lineNum">     657 </span>            :     /**</a>
<a name="658"><span class="lineNum">     658 </span>            :      * Jacobian in given point.</a>
<a name="659"><span class="lineNum">     659 </span>            :      * This method calculates the jacobian</a>
<a name="660"><span class="lineNum">     660 </span>            :      * matrix in given point.</a>
<a name="661"><span class="lineNum">     661 </span>            :      *</a>
<a name="662"><span class="lineNum">     662 </span>            :      * @param rPoint point which jacobians has to</a>
<a name="663"><span class="lineNum">     663 </span>            :      * be calculated in it.</a>
<a name="664"><span class="lineNum">     664 </span>            :      *</a>
<a name="665"><span class="lineNum">     665 </span>            :      * @return Matrix of double which is jacobian matrix \f$ J \f$ in given point.</a>
<a name="666"><span class="lineNum">     666 </span>            :      *</a>
<a name="667"><span class="lineNum">     667 </span>            :      * @see DeterminantOfJacobian</a>
<a name="668"><span class="lineNum">     668 </span>            :      * @see InverseOfJacobian</a>
<a name="669"><span class="lineNum">     669 </span>            :      */</a>
<a name="670"><span class="lineNum">     670 </span><span class="lineNoCov">          0 :     Matrix&amp; Jacobian( Matrix&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="671"><span class="lineNum">     671 </span>            :     {</a>
<a name="672"><span class="lineNum">     672 </span>            :         // Setting up size of jacobian matrix</a>
<a name="673"><span class="lineNum">     673 </span><span class="lineNoCov">          0 :         if (rResult.size1() != 2 || rResult.size2() != 2)</span></a>
<a name="674"><span class="lineNum">     674 </span><span class="lineNoCov">          0 :             rResult.resize( 2, 2 , false);</span></a>
<a name="675"><span class="lineNum">     675 </span>            :         rResult.clear();</a>
<a name="676"><span class="lineNum">     676 </span>            :         //derivatives of shape functions</a>
<a name="677"><span class="lineNum">     677 </span>            :         Matrix shape_functions_gradients;</a>
<a name="678"><span class="lineNum">     678 </span><span class="lineNoCov">          0 :         shape_functions_gradients = ShapeFunctionsLocalGradients( shape_functions_gradients, rPoint );</span></a>
<a name="679"><span class="lineNum">     679 </span>            :         //Elements of jacobian matrix (e.g. J(1,1) = dX1/dXi1)</a>
<a name="680"><span class="lineNum">     680 </span>            :         //loop over all nodes</a>
<a name="681"><span class="lineNum">     681 </span>            : </a>
<a name="682"><span class="lineNum">     682 </span><span class="lineNoCov">          0 :         for ( unsigned int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="683"><span class="lineNum">     683 </span>            :         {</a>
<a name="684"><span class="lineNum">     684 </span><span class="lineNoCov">          0 :             rResult( 0, 0 ) += ( this-&gt;GetPoint( i ).X() ) * ( shape_functions_gradients( i, 0 ) );</span></a>
<a name="685"><span class="lineNum">     685 </span><span class="lineNoCov">          0 :             rResult( 0, 1 ) += ( this-&gt;GetPoint( i ).X() ) * ( shape_functions_gradients( i, 1 ) );</span></a>
<a name="686"><span class="lineNum">     686 </span><span class="lineNoCov">          0 :             rResult( 1, 0 ) += ( this-&gt;GetPoint( i ).Y() ) * ( shape_functions_gradients( i, 0 ) );</span></a>
<a name="687"><span class="lineNum">     687 </span><span class="lineNoCov">          0 :             rResult( 1, 1 ) += ( this-&gt;GetPoint( i ).Y() ) * ( shape_functions_gradients( i, 1 ) );</span></a>
<a name="688"><span class="lineNum">     688 </span>            :         }</a>
<a name="689"><span class="lineNum">     689 </span>            : </a>
<a name="690"><span class="lineNum">     690 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="691"><span class="lineNum">     691 </span>            :     }</a>
<a name="692"><span class="lineNum">     692 </span>            : </a>
<a name="693"><span class="lineNum">     693 </span>            :     /**</a>
<a name="694"><span class="lineNum">     694 </span>            :      * Determinant of jacobians for given integration method.</a>
<a name="695"><span class="lineNum">     695 </span>            :      * This method calculate determinant of jacobian in all</a>
<a name="696"><span class="lineNum">     696 </span>            :      * integrations points of given integration method.</a>
<a name="697"><span class="lineNum">     697 </span>            :      *</a>
<a name="698"><span class="lineNum">     698 </span>            :      * @return Vector of double which is vector of determinants of</a>
<a name="699"><span class="lineNum">     699 </span>            :      * jacobians \f$ |J|_i \f$ where \f$ i=1,2,...,n \f$ is the</a>
<a name="700"><span class="lineNum">     700 </span>            :      * integration point index of given integration method.</a>
<a name="701"><span class="lineNum">     701 </span>            :      *</a>
<a name="702"><span class="lineNum">     702 </span>            :      * @see Jacobian</a>
<a name="703"><span class="lineNum">     703 </span>            :      * @see InverseOfJacobian</a>
<a name="704"><span class="lineNum">     704 </span>            :      */</a>
<a name="705"><span class="lineNum">     705 </span><span class="lineNoCov">          0 :     Vector&amp; DeterminantOfJacobian(</span></a>
<a name="706"><span class="lineNum">     706 </span>            :         Vector&amp; rResult,</a>
<a name="707"><span class="lineNum">     707 </span>            :         IntegrationMethod ThisMethod</a>
<a name="708"><span class="lineNum">     708 </span>            :         ) const override</a>
<a name="709"><span class="lineNum">     709 </span>            :     {</a>
<a name="710"><span class="lineNum">     710 </span><span class="lineNoCov">          0 :         if( rResult.size() != this-&gt;IntegrationPointsNumber( ThisMethod ) )</span></a>
<a name="711"><span class="lineNum">     711 </span><span class="lineNoCov">          0 :             rResult.resize( this-&gt;IntegrationPointsNumber( ThisMethod ), false );</span></a>
<a name="712"><span class="lineNum">     712 </span>            : </a>
<a name="713"><span class="lineNum">     713 </span>            :         Matrix J( this-&gt;WorkingSpaceDimension(), this-&gt;LocalSpaceDimension());</a>
<a name="714"><span class="lineNum">     714 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; this-&gt;IntegrationPointsNumber( ThisMethod ); pnt++ ) {</span></a>
<a name="715"><span class="lineNum">     715 </span><span class="lineNoCov">          0 :             this-&gt;Jacobian( J, pnt, ThisMethod);</span></a>
<a name="716"><span class="lineNum">     716 </span><span class="lineNoCov">          0 :             rResult[pnt] = (( J( 0, 0 )*J( 1, 1 ) ) - ( J( 0, 1 )*J( 1, 0 ) ) );</span></a>
<a name="717"><span class="lineNum">     717 </span>            :         }</a>
<a name="718"><span class="lineNum">     718 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="719"><span class="lineNum">     719 </span>            :     }</a>
<a name="720"><span class="lineNum">     720 </span>            : </a>
<a name="721"><span class="lineNum">     721 </span>            :     /**</a>
<a name="722"><span class="lineNum">     722 </span>            :      * TODO: implemented but not yet tested</a>
<a name="723"><span class="lineNum">     723 </span>            :      */</a>
<a name="724"><span class="lineNum">     724 </span>            :     /**</a>
<a name="725"><span class="lineNum">     725 </span>            :      * Determinant of jacobian in specific integration point of</a>
<a name="726"><span class="lineNum">     726 </span>            :      * given integration method. This method calculate determinant</a>
<a name="727"><span class="lineNum">     727 </span>            :      * of jacobian in given integration point of given integration</a>
<a name="728"><span class="lineNum">     728 </span>            :      * method.</a>
<a name="729"><span class="lineNum">     729 </span>            :      *</a>
<a name="730"><span class="lineNum">     730 </span>            :      * @param IntegrationPointIndex index of integration point which jacobians has to</a>
<a name="731"><span class="lineNum">     731 </span>            :      * be calculated in it.</a>
<a name="732"><span class="lineNum">     732 </span>            :      *</a>
<a name="733"><span class="lineNum">     733 </span>            :      * @param IntegrationPointIndex index of integration point</a>
<a name="734"><span class="lineNum">     734 </span>            :      * which determinant of jacobians has to be calculated in it.</a>
<a name="735"><span class="lineNum">     735 </span>            :      *</a>
<a name="736"><span class="lineNum">     736 </span>            :      * @return Determinamt of jacobian matrix \f$ |J|_i \f$ where \f$</a>
<a name="737"><span class="lineNum">     737 </span>            :      * i \f$ is the given integration point index of given</a>
<a name="738"><span class="lineNum">     738 </span>            :      * integration method.</a>
<a name="739"><span class="lineNum">     739 </span>            :      *</a>
<a name="740"><span class="lineNum">     740 </span>            :      * @see Jacobian</a>
<a name="741"><span class="lineNum">     741 </span>            :      * @see InverseOfJacobian</a>
<a name="742"><span class="lineNum">     742 </span>            :      */</a>
<a name="743"><span class="lineNum">     743 </span><span class="lineNoCov">          0 :     double DeterminantOfJacobian( IndexType IntegrationPointIndex, IntegrationMethod ThisMethod ) const override</span></a>
<a name="744"><span class="lineNum">     744 </span>            :     {</a>
<a name="745"><span class="lineNum">     745 </span>            :         Matrix jacobian( 2, 2 );</a>
<a name="746"><span class="lineNum">     746 </span><span class="lineNoCov">          0 :         jacobian = Jacobian( jacobian, IntegrationPointIndex, ThisMethod );</span></a>
<a name="747"><span class="lineNum">     747 </span><span class="lineNoCov">          0 :         return(( jacobian( 0, 0 )*jacobian( 1, 1 ) ) - ( jacobian( 0, 1 )*jacobian( 1, 0 ) ) );</span></a>
<a name="748"><span class="lineNum">     748 </span>            :     }</a>
<a name="749"><span class="lineNum">     749 </span>            : </a>
<a name="750"><span class="lineNum">     750 </span>            :     /**</a>
<a name="751"><span class="lineNum">     751 </span>            :      * TODO: implemented but not yet tested</a>
<a name="752"><span class="lineNum">     752 </span>            :      */</a>
<a name="753"><span class="lineNum">     753 </span>            :     /**</a>
<a name="754"><span class="lineNum">     754 </span>            :      * Determinant of jacobian in given point.</a>
<a name="755"><span class="lineNum">     755 </span>            :      * This method calculate determinant of jacobian</a>
<a name="756"><span class="lineNum">     756 </span>            :      * matrix in given point.</a>
<a name="757"><span class="lineNum">     757 </span>            :      *</a>
<a name="758"><span class="lineNum">     758 </span>            :      * @param rPoint point which determinant of jacobians has to</a>
<a name="759"><span class="lineNum">     759 </span>            :      * be calculated in it.</a>
<a name="760"><span class="lineNum">     760 </span>            :      *</a>
<a name="761"><span class="lineNum">     761 </span>            :      * @return Determinamt of jacobian matrix \f$ |J| \f$ in given</a>
<a name="762"><span class="lineNum">     762 </span>            :      * point.</a>
<a name="763"><span class="lineNum">     763 </span>            :      *</a>
<a name="764"><span class="lineNum">     764 </span>            :      * @see DeterminantOfJacobian</a>
<a name="765"><span class="lineNum">     765 </span>            :      * @see InverseOfJacobian</a>
<a name="766"><span class="lineNum">     766 </span>            :      */</a>
<a name="767"><span class="lineNum">     767 </span><span class="lineNoCov">          0 :     double DeterminantOfJacobian( const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="768"><span class="lineNum">     768 </span>            :     {</a>
<a name="769"><span class="lineNum">     769 </span>            :         Matrix jacobian( 2, 2 );</a>
<a name="770"><span class="lineNum">     770 </span><span class="lineNoCov">          0 :         jacobian = Jacobian( jacobian, rPoint );</span></a>
<a name="771"><span class="lineNum">     771 </span><span class="lineNoCov">          0 :         return(( jacobian( 0, 0 )*jacobian( 1, 1 ) ) - ( jacobian( 0, 1 )*jacobian( 1, 0 ) ) );</span></a>
<a name="772"><span class="lineNum">     772 </span>            :     }</a>
<a name="773"><span class="lineNum">     773 </span>            : </a>
<a name="774"><span class="lineNum">     774 </span>            :     /**</a>
<a name="775"><span class="lineNum">     775 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="776"><span class="lineNum">     776 </span>            :      */</a>
<a name="777"><span class="lineNum">     777 </span>            :     /**</a>
<a name="778"><span class="lineNum">     778 </span>            :      * Inverse of jacobians for given integration method. This method</a>
<a name="779"><span class="lineNum">     779 </span>            :      * calculate inverse of jacobians matrices in all integrations points of</a>
<a name="780"><span class="lineNum">     780 </span>            :      * given integration method.</a>
<a name="781"><span class="lineNum">     781 </span>            :      *</a>
<a name="782"><span class="lineNum">     782 </span>            :      * @param ThisMethod integration method which inverse of jacobians has to</a>
<a name="783"><span class="lineNum">     783 </span>            :      * be calculated in its integration points.</a>
<a name="784"><span class="lineNum">     784 </span>            :      *</a>
<a name="785"><span class="lineNum">     785 </span>            :      * @return Inverse of jacobian</a>
<a name="786"><span class="lineNum">     786 </span>            :      * matrices \f$ J^{-1}_i \f$ where \f$ i=1,2,...,n \f$ is the integration</a>
<a name="787"><span class="lineNum">     787 </span>            :      * point index of given integration method.</a>
<a name="788"><span class="lineNum">     788 </span>            :      *</a>
<a name="789"><span class="lineNum">     789 </span>            :      * @see Jacobian</a>
<a name="790"><span class="lineNum">     790 </span>            :      * @see DeterminantOfJacobian</a>
<a name="791"><span class="lineNum">     791 </span>            :      *</a>
<a name="792"><span class="lineNum">     792 </span>            :      * KLUDGE: works only with explicitly generated Matrix object</a>
<a name="793"><span class="lineNum">     793 </span>            :      */</a>
<a name="794"><span class="lineNum">     794 </span><span class="lineNoCov">          0 :     JacobiansType&amp; InverseOfJacobian( JacobiansType&amp; rResult, IntegrationMethod ThisMethod ) const override</span></a>
<a name="795"><span class="lineNum">     795 </span>            :     {</a>
<a name="796"><span class="lineNum">     796 </span>            :         //workaround by riccardo</a>
<a name="797"><span class="lineNum">     797 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;IntegrationPointsNumber( ThisMethod ) )</span></a>
<a name="798"><span class="lineNum">     798 </span>            :         {</a>
<a name="799"><span class="lineNum">     799 </span>            :             // KLUDGE: While there is a bug in ublas</a>
<a name="800"><span class="lineNum">     800 </span>            :             // vector resize, I have to put this beside resizing!!</a>
<a name="801"><span class="lineNum">     801 </span>            :             JacobiansType temp( this-&gt;IntegrationPointsNumber( ThisMethod ) );</a>
<a name="802"><span class="lineNum">     802 </span>            :             rResult.swap( temp );</a>
<a name="803"><span class="lineNum">     803 </span>            :         }</a>
<a name="804"><span class="lineNum">     804 </span>            : </a>
<a name="805"><span class="lineNum">     805 </span>            :         //loop over all integration points</a>
<a name="806"><span class="lineNum">     806 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; this-&gt;IntegrationPointsNumber( ThisMethod ); pnt++ )</span></a>
<a name="807"><span class="lineNum">     807 </span>            :         {</a>
<a name="808"><span class="lineNum">     808 </span>            :             Matrix tempMatrix( 2, 2 );</a>
<a name="809"><span class="lineNum">     809 </span><span class="lineNoCov">          0 :             rResult[pnt] = InverseOfJacobian( tempMatrix, pnt, ThisMethod );</span></a>
<a name="810"><span class="lineNum">     810 </span>            :         }</a>
<a name="811"><span class="lineNum">     811 </span>            : </a>
<a name="812"><span class="lineNum">     812 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="813"><span class="lineNum">     813 </span>            :     }</a>
<a name="814"><span class="lineNum">     814 </span>            : </a>
<a name="815"><span class="lineNum">     815 </span>            :     /**</a>
<a name="816"><span class="lineNum">     816 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="817"><span class="lineNum">     817 </span>            :      */</a>
<a name="818"><span class="lineNum">     818 </span>            :     /**</a>
<a name="819"><span class="lineNum">     819 </span>            :      * Inverse of jacobian in specific integration point of given integration</a>
<a name="820"><span class="lineNum">     820 </span>            :      * method. This method calculate Inverse of jacobian matrix in given</a>
<a name="821"><span class="lineNum">     821 </span>            :      * integration point of given integration method.</a>
<a name="822"><span class="lineNum">     822 </span>            :      *</a>
<a name="823"><span class="lineNum">     823 </span>            :      * @param IntegrationPointIndex index of integration point which</a>
<a name="824"><span class="lineNum">     824 </span>            :      * inverse of jacobians has to</a>
<a name="825"><span class="lineNum">     825 </span>            :      * be calculated in it.</a>
<a name="826"><span class="lineNum">     826 </span>            :      *</a>
<a name="827"><span class="lineNum">     827 </span>            :      * @param ThisMethod integration method which inverse of jacobians has to</a>
<a name="828"><span class="lineNum">     828 </span>            :      * be calculated in its integration points.</a>
<a name="829"><span class="lineNum">     829 </span>            :      *</a>
<a name="830"><span class="lineNum">     830 </span>            :      * @return Inverse of jacobian matrix \f$ J^{-1}_i \f$ where \f$</a>
<a name="831"><span class="lineNum">     831 </span>            :      * i \f$ is the given integration point index of given</a>
<a name="832"><span class="lineNum">     832 </span>            :      * integration method.</a>
<a name="833"><span class="lineNum">     833 </span>            :      *</a>
<a name="834"><span class="lineNum">     834 </span>            :      * @see Jacobian</a>
<a name="835"><span class="lineNum">     835 </span>            :      * @see DeterminantOfJacobian</a>
<a name="836"><span class="lineNum">     836 </span>            :      *</a>
<a name="837"><span class="lineNum">     837 </span>            :      * KLUDGE: works only with explicitly generated Matrix object</a>
<a name="838"><span class="lineNum">     838 </span>            :      */</a>
<a name="839"><span class="lineNum">     839 </span><span class="lineNoCov">          0 :     Matrix&amp; InverseOfJacobian( Matrix&amp; rResult, IndexType IntegrationPointIndex, IntegrationMethod ThisMethod ) const override</span></a>
<a name="840"><span class="lineNum">     840 </span>            :     {</a>
<a name="841"><span class="lineNum">     841 </span>            :         // Current jacobian</a>
<a name="842"><span class="lineNum">     842 </span><span class="lineNoCov">          0 :         Matrix tempMatrix = ZeroMatrix( 2, 2 );</span></a>
<a name="843"><span class="lineNum">     843 </span><span class="lineNoCov">          0 :         tempMatrix = Jacobian( tempMatrix, IntegrationPointIndex, ThisMethod );</span></a>
<a name="844"><span class="lineNum">     844 </span>            : </a>
<a name="845"><span class="lineNum">     845 </span>            :         // Determinant of jacobian</a>
<a name="846"><span class="lineNum">     846 </span><span class="lineNoCov">          0 :         const double det_j = DeterminantOfJacobian( IntegrationPointIndex, ThisMethod );</span></a>
<a name="847"><span class="lineNum">     847 </span>            : </a>
<a name="848"><span class="lineNum">     848 </span>            :         // Checking for singularity</a>
<a name="849"><span class="lineNum">     849 </span><span class="lineNoCov">          0 :         if ( det_j == 0.00 )</span></a>
<a name="850"><span class="lineNum">     850 </span>            :         {</a>
<a name="851"><span class="lineNum">     851 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Zero determinant of jacobian.&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="852"><span class="lineNum">     852 </span>            :         }</a>
<a name="853"><span class="lineNum">     853 </span>            : </a>
<a name="854"><span class="lineNum">     854 </span>            :         // Setting up result matrix</a>
<a name="855"><span class="lineNum">     855 </span><span class="lineNoCov">          0 :         rResult.resize( 2, 2 , false);</span></a>
<a name="856"><span class="lineNum">     856 </span>            : </a>
<a name="857"><span class="lineNum">     857 </span>            :         // Filling matrix</a>
<a name="858"><span class="lineNum">     858 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = ( tempMatrix( 1, 1 ) ) / ( det_j );</span></a>
<a name="859"><span class="lineNum">     859 </span>            : </a>
<a name="860"><span class="lineNum">     860 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) = -( tempMatrix( 1, 0 ) ) / ( det_j );</span></a>
<a name="861"><span class="lineNum">     861 </span>            : </a>
<a name="862"><span class="lineNum">     862 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = -( tempMatrix( 0, 1 ) ) / ( det_j );</span></a>
<a name="863"><span class="lineNum">     863 </span>            : </a>
<a name="864"><span class="lineNum">     864 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="865"><span class="lineNum">     865 </span>            :     }</a>
<a name="866"><span class="lineNum">     866 </span>            : </a>
<a name="867"><span class="lineNum">     867 </span>            :     /**</a>
<a name="868"><span class="lineNum">     868 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="869"><span class="lineNum">     869 </span>            :      */</a>
<a name="870"><span class="lineNum">     870 </span>            :     /**</a>
<a name="871"><span class="lineNum">     871 </span>            :      * Inverse of jacobian in given point.</a>
<a name="872"><span class="lineNum">     872 </span>            :      * This method calculate inverse of jacobian</a>
<a name="873"><span class="lineNum">     873 </span>            :      * matrix in given point.</a>
<a name="874"><span class="lineNum">     874 </span>            :      *</a>
<a name="875"><span class="lineNum">     875 </span>            :      * @param rPoint point which inverse of jacobians has to</a>
<a name="876"><span class="lineNum">     876 </span>            :      * be calculated in it.</a>
<a name="877"><span class="lineNum">     877 </span>            :      *</a>
<a name="878"><span class="lineNum">     878 </span>            :      * @return Inverse of jacobian matrix \f$ J^{-1} \f$ in given point.</a>
<a name="879"><span class="lineNum">     879 </span>            :      *</a>
<a name="880"><span class="lineNum">     880 </span>            :      * @see DeterminantOfJacobian</a>
<a name="881"><span class="lineNum">     881 </span>            :      * @see InverseOfJacobian</a>
<a name="882"><span class="lineNum">     882 </span>            :      *</a>
<a name="883"><span class="lineNum">     883 </span>            :      */</a>
<a name="884"><span class="lineNum">     884 </span><span class="lineNoCov">          0 :     Matrix&amp; InverseOfJacobian( Matrix&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="885"><span class="lineNum">     885 </span>            :     {</a>
<a name="886"><span class="lineNum">     886 </span>            :         //current jacobian</a>
<a name="887"><span class="lineNum">     887 </span>            :         Matrix tempMatrix;</a>
<a name="888"><span class="lineNum">     888 </span><span class="lineNoCov">          0 :         tempMatrix.resize( 2, 2, false );</span></a>
<a name="889"><span class="lineNum">     889 </span><span class="lineNoCov">          0 :         tempMatrix = this-&gt;Jacobian( tempMatrix, rPoint );</span></a>
<a name="890"><span class="lineNum">     890 </span>            :         //deteminant of Jacobian</a>
<a name="891"><span class="lineNum">     891 </span><span class="lineNoCov">          0 :         double det_j = DeterminantOfJacobian( rPoint );</span></a>
<a name="892"><span class="lineNum">     892 </span>            :         //checking for singularity</a>
<a name="893"><span class="lineNum">     893 </span>            : </a>
<a name="894"><span class="lineNum">     894 </span><span class="lineNoCov">          0 :         if ( det_j == 0.0 )</span></a>
<a name="895"><span class="lineNum">     895 </span>            :         {</a>
<a name="896"><span class="lineNum">     896 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Zero determinant of jacobian.&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="897"><span class="lineNum">     897 </span>            :         }</a>
<a name="898"><span class="lineNum">     898 </span>            : </a>
<a name="899"><span class="lineNum">     899 </span>            :         //setting up result matrix</a>
<a name="900"><span class="lineNum">     900 </span><span class="lineNoCov">          0 :         rResult.resize( 2, 2 , false);</span></a>
<a name="901"><span class="lineNum">     901 </span>            : </a>
<a name="902"><span class="lineNum">     902 </span>            :         //filling matrix</a>
<a name="903"><span class="lineNum">     903 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = ( tempMatrix( 1, 1 ) ) / ( det_j );</span></a>
<a name="904"><span class="lineNum">     904 </span>            : </a>
<a name="905"><span class="lineNum">     905 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) = -( tempMatrix( 1, 0 ) ) / ( det_j );</span></a>
<a name="906"><span class="lineNum">     906 </span>            : </a>
<a name="907"><span class="lineNum">     907 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = -( tempMatrix( 0, 1 ) ) / ( det_j );</span></a>
<a name="908"><span class="lineNum">     908 </span>            : </a>
<a name="909"><span class="lineNum">     909 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) = ( tempMatrix( 0, 0 ) ) / ( det_j );</span></a>
<a name="910"><span class="lineNum">     910 </span>            : </a>
<a name="911"><span class="lineNum">     911 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="912"><span class="lineNum">     912 </span>            :     }</a>
<a name="913"><span class="lineNum">     913 </span>            : </a>
<a name="914"><span class="lineNum">     914 </span>            :     ///@}</a>
<a name="915"><span class="lineNum">     915 </span>            :     ///@name Edge</a>
<a name="916"><span class="lineNum">     916 </span>            :     ///@{</a>
<a name="917"><span class="lineNum">     917 </span>            : </a>
<a name="918"><span class="lineNum">     918 </span>            :     /**</a>
<a name="919"><span class="lineNum">     919 </span>            :      * @brief This method gives you number of all edges of this geometry.</a>
<a name="920"><span class="lineNum">     920 </span>            :      * @details For example, for a hexahedron, this would be 12</a>
<a name="921"><span class="lineNum">     921 </span>            :      * @return SizeType containes number of this geometry edges.</a>
<a name="922"><span class="lineNum">     922 </span>            :      * @see EdgesNumber()</a>
<a name="923"><span class="lineNum">     923 </span>            :      * @see Edges()</a>
<a name="924"><span class="lineNum">     924 </span>            :      * @see GenerateEdges()</a>
<a name="925"><span class="lineNum">     925 </span>            :      * @see FacesNumber()</a>
<a name="926"><span class="lineNum">     926 </span>            :      * @see Faces()</a>
<a name="927"><span class="lineNum">     927 </span>            :      * @see GenerateFaces()</a>
<a name="928"><span class="lineNum">     928 </span>            :      */</a>
<a name="929"><span class="lineNum">     929 </span><span class="lineNoCov">          0 :     SizeType EdgesNumber() const override</span></a>
<a name="930"><span class="lineNum">     930 </span>            :     {</a>
<a name="931"><span class="lineNum">     931 </span><span class="lineNoCov">          0 :         return 4;</span></a>
<a name="932"><span class="lineNum">     932 </span>            :     }</a>
<a name="933"><span class="lineNum">     933 </span>            : </a>
<a name="934"><span class="lineNum">     934 </span>            :     /**</a>
<a name="935"><span class="lineNum">     935 </span>            :      * @brief This method gives you all edges of this geometry.</a>
<a name="936"><span class="lineNum">     936 </span>            :      * @details This method will gives you all the edges with one dimension less than this geometry.</a>
<a name="937"><span class="lineNum">     937 </span>            :      * For example a triangle would return three lines as its edges or a tetrahedral would return four triangle as its edges but won't return its six edge lines by this method.</a>
<a name="938"><span class="lineNum">     938 </span>            :      * @return GeometriesArrayType containes this geometry edges.</a>
<a name="939"><span class="lineNum">     939 </span>            :      * @see EdgesNumber()</a>
<a name="940"><span class="lineNum">     940 </span>            :      * @see Edge()</a>
<a name="941"><span class="lineNum">     941 </span>            :      */</a>
<a name="942"><span class="lineNum">     942 </span><span class="lineNoCov">          0 :     GeometriesArrayType GenerateEdges() const override</span></a>
<a name="943"><span class="lineNum">     943 </span>            :     {</a>
<a name="944"><span class="lineNum">     944 </span>            :         GeometriesArrayType edges = GeometriesArrayType();</a>
<a name="945"><span class="lineNum">     945 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 0 ), this-&gt;pGetPoint( 1 ), this-&gt;pGetPoint( 4 ) ) );</span></a>
<a name="946"><span class="lineNum">     946 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 1 ), this-&gt;pGetPoint( 2 ), this-&gt;pGetPoint( 5 ) ) );</span></a>
<a name="947"><span class="lineNum">     947 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 2 ), this-&gt;pGetPoint( 3 ), this-&gt;pGetPoint( 6 ) ) );</span></a>
<a name="948"><span class="lineNum">     948 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 3 ), this-&gt;pGetPoint( 0 ), this-&gt;pGetPoint( 7 ) ) );</span></a>
<a name="949"><span class="lineNum">     949 </span><span class="lineNoCov">          0 :         return edges;</span></a>
<a name="950"><span class="lineNum">     950 </span>            :     }</a>
<a name="951"><span class="lineNum">     951 </span>            : </a>
<a name="952"><span class="lineNum">     952 </span>            :     /**</a>
<a name="953"><span class="lineNum">     953 </span>            :      * Shape Function</a>
<a name="954"><span class="lineNum">     954 </span>            :      */</a>
<a name="955"><span class="lineNum">     955 </span>            : </a>
<a name="956"><span class="lineNum">     956 </span>            :     /**</a>
<a name="957"><span class="lineNum">     957 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="958"><span class="lineNum">     958 </span>            :      */</a>
<a name="959"><span class="lineNum">     959 </span>            :     /**</a>
<a name="960"><span class="lineNum">     960 </span>            :      * Calculates the value of a given shape function at a given point.</a>
<a name="961"><span class="lineNum">     961 </span>            :      *</a>
<a name="962"><span class="lineNum">     962 </span>            :      * @param ShapeFunctionIndex The number of the desired shape function</a>
<a name="963"><span class="lineNum">     963 </span>            :      * @param rPoint the given point in local coordinates at which the</a>
<a name="964"><span class="lineNum">     964 </span>            :      * value of the shape function is calculated</a>
<a name="965"><span class="lineNum">     965 </span>            :      *</a>
<a name="966"><span class="lineNum">     966 </span>            :      * @return the value of the shape function at the given point</a>
<a name="967"><span class="lineNum">     967 </span>            :      */</a>
<a name="968"><span class="lineNum">     968 </span><span class="lineNoCov">          0 :     double ShapeFunctionValue( IndexType ShapeFunctionIndex,</span></a>
<a name="969"><span class="lineNum">     969 </span>            :                                        const CoordinatesArrayType&amp; rPoint ) const override</a>
<a name="970"><span class="lineNum">     970 </span>            :     {</a>
<a name="971"><span class="lineNum">     971 </span><span class="lineNoCov">          0 :         switch ( ShapeFunctionIndex )</span></a>
<a name="972"><span class="lineNum">     972 </span>            :         {</a>
<a name="973"><span class="lineNum">     973 </span>            :             // Primary nodes</a>
<a name="974"><span class="lineNum">     974 </span>            :             case 0:</a>
<a name="975"><span class="lineNum">     975 </span><span class="lineNoCov">          0 :                 return -(( 1.0 - rPoint[0] )*( 1.0 - rPoint[1] )</span></a>
<a name="976"><span class="lineNum">     976 </span><span class="lineNoCov">          0 :                         *( 1.0 + rPoint[0] + rPoint[1] ) ) / 4.0;</span></a>
<a name="977"><span class="lineNum">     977 </span>            :             case 1:</a>
<a name="978"><span class="lineNum">     978 </span><span class="lineNoCov">          0 :                 return -(( 1.0 + rPoint[0] )*( 1.0 - rPoint[1] )</span></a>
<a name="979"><span class="lineNum">     979 </span><span class="lineNoCov">          0 :                         *( 1.0 - rPoint[0] + rPoint[1] ) ) / 4.0;</span></a>
<a name="980"><span class="lineNum">     980 </span>            :             case 2:</a>
<a name="981"><span class="lineNum">     981 </span><span class="lineNoCov">          0 :                 return -(( 1.0 + rPoint[0] )*( 1.0 + rPoint[1] )</span></a>
<a name="982"><span class="lineNum">     982 </span><span class="lineNoCov">          0 :                         *( 1.0 - rPoint[0] - rPoint[1] ) ) / 4.0;</span></a>
<a name="983"><span class="lineNum">     983 </span>            :             case 3:</a>
<a name="984"><span class="lineNum">     984 </span><span class="lineNoCov">          0 :                 return -(( 1.0 - rPoint[0] )*( 1.0 + rPoint[1] )</span></a>
<a name="985"><span class="lineNum">     985 </span><span class="lineNoCov">          0 :                         *( 1.0 + rPoint[0] - rPoint[1] ) ) / 4.0;</span></a>
<a name="986"><span class="lineNum">     986 </span>            :             // Secondary nodes</a>
<a name="987"><span class="lineNum">     987 </span>            :             case 4:</a>
<a name="988"><span class="lineNum">     988 </span><span class="lineNoCov">          0 :                 return  (( 1.0 -rPoint[0]*rPoint[0] )</span></a>
<a name="989"><span class="lineNum">     989 </span><span class="lineNoCov">          0 :                         *( 1.0 - rPoint[1] ) ) / 2.0;</span></a>
<a name="990"><span class="lineNum">     990 </span>            :             case 5:</a>
<a name="991"><span class="lineNum">     991 </span><span class="lineNoCov">          0 :                 return  (( 1.0 + rPoint[0] )</span></a>
<a name="992"><span class="lineNum">     992 </span><span class="lineNoCov">          0 :                         *( 1.0 - rPoint[1]*rPoint[1] ) ) / 2.0 ;</span></a>
<a name="993"><span class="lineNum">     993 </span>            :             case 6:</a>
<a name="994"><span class="lineNum">     994 </span><span class="lineNoCov">          0 :                 return  (( 1.0 -rPoint[0]*rPoint[0] )</span></a>
<a name="995"><span class="lineNum">     995 </span><span class="lineNoCov">          0 :                         *( 1.0 + rPoint[1] ) ) / 2.0 ;</span></a>
<a name="996"><span class="lineNum">     996 </span>            :             case 7:</a>
<a name="997"><span class="lineNum">     997 </span><span class="lineNoCov">          0 :                 return  (( 1.0 -rPoint[0] )</span></a>
<a name="998"><span class="lineNum">     998 </span><span class="lineNoCov">          0 :                         *( 1.0 - rPoint[1]*rPoint[1] ) ) / 2.0 ;</span></a>
<a name="999"><span class="lineNum">     999 </span><span class="lineNoCov">          0 :             default:</span></a>
<a name="1000"><span class="lineNum">    1000 </span><span class="lineNoCov">          0 :                 KRATOS_ERROR &lt;&lt; &quot;Wrong index of shape function!&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="1001"><span class="lineNum">    1001 </span>            :         }</a>
<a name="1002"><span class="lineNum">    1002 </span>            : </a>
<a name="1003"><span class="lineNum">    1003 </span>            :         return 0;</a>
<a name="1004"><span class="lineNum">    1004 </span>            :     }</a>
<a name="1005"><span class="lineNum">    1005 </span>            : </a>
<a name="1006"><span class="lineNum">    1006 </span>            :     /** This method gives all non-zero shape functions values evaluated at the rCoordinates provided</a>
<a name="1007"><span class="lineNum">    1007 </span>            :      * @return Vector of values of shape functions \f$ F_{i} \f$ where i is the shape function index</a>
<a name="1008"><span class="lineNum">    1008 </span>            :      * (for NURBS it is the index</a>
<a name="1009"><span class="lineNum">    1009 </span>            :      * of the local enumeration in the element).</a>
<a name="1010"><span class="lineNum">    1010 </span>            :      * @see ShapeFunctionValue</a>
<a name="1011"><span class="lineNum">    1011 </span>            :      * @see ShapeFunctionsLocalGradients</a>
<a name="1012"><span class="lineNum">    1012 </span>            :      * @see ShapeFunctionLocalGradient</a>
<a name="1013"><span class="lineNum">    1013 </span>            :      */</a>
<a name="1014"><span class="lineNum">    1014 </span><span class="lineNoCov">          0 :     Vector&amp; ShapeFunctionsValues (</span></a>
<a name="1015"><span class="lineNum">    1015 </span>            :         Vector &amp;rResult,</a>
<a name="1016"><span class="lineNum">    1016 </span>            :         const CoordinatesArrayType&amp; rCoordinates</a>
<a name="1017"><span class="lineNum">    1017 </span>            :         ) const override</a>
<a name="1018"><span class="lineNum">    1018 </span>            :     {</a>
<a name="1019"><span class="lineNum">    1019 </span><span class="lineNoCov">          0 :         if(rResult.size() != 8)</span></a>
<a name="1020"><span class="lineNum">    1020 </span>            :         {</a>
<a name="1021"><span class="lineNum">    1021 </span><span class="lineNoCov">          0 :             rResult.resize(8,false);</span></a>
<a name="1022"><span class="lineNum">    1022 </span>            :         }</a>
<a name="1023"><span class="lineNum">    1023 </span>            : </a>
<a name="1024"><span class="lineNum">    1024 </span>            :         // Primary nodes</a>
<a name="1025"><span class="lineNum">    1025 </span><span class="lineNoCov">          0 :         rResult[0] = -(( 1.0 - rCoordinates[0] )*( 1.0 - rCoordinates[1] )</span></a>
<a name="1026"><span class="lineNum">    1026 </span><span class="lineNoCov">          0 :                      *( 1.0 + rCoordinates[0] + rCoordinates[1] ) ) / 4.0;</span></a>
<a name="1027"><span class="lineNum">    1027 </span><span class="lineNoCov">          0 :         rResult[1] = -(( 1.0 + rCoordinates[0] )*( 1.0 - rCoordinates[1] )</span></a>
<a name="1028"><span class="lineNum">    1028 </span><span class="lineNoCov">          0 :                      *( 1.0 - rCoordinates[0] + rCoordinates[1] ) ) / 4.0;</span></a>
<a name="1029"><span class="lineNum">    1029 </span><span class="lineNoCov">          0 :         rResult[2] = -(( 1.0 + rCoordinates[0] )*( 1.0 + rCoordinates[1] )</span></a>
<a name="1030"><span class="lineNum">    1030 </span><span class="lineNoCov">          0 :                      *( 1.0 - rCoordinates[0] - rCoordinates[1] ) ) / 4.0;</span></a>
<a name="1031"><span class="lineNum">    1031 </span><span class="lineNoCov">          0 :         rResult[3] = -(( 1.0 - rCoordinates[0] )*( 1.0 + rCoordinates[1] )</span></a>
<a name="1032"><span class="lineNum">    1032 </span><span class="lineNoCov">          0 :                      *( 1.0 + rCoordinates[0] - rCoordinates[1] ) ) / 4.0;</span></a>
<a name="1033"><span class="lineNum">    1033 </span>            : </a>
<a name="1034"><span class="lineNum">    1034 </span>            :         // Secondary nodes</a>
<a name="1035"><span class="lineNum">    1035 </span><span class="lineNoCov">          0 :         rResult[4] =  (( 1.0 -rCoordinates[0]*rCoordinates[0] )</span></a>
<a name="1036"><span class="lineNum">    1036 </span><span class="lineNoCov">          0 :                      *( 1.0 - rCoordinates[1] ) ) / 2.0;</span></a>
<a name="1037"><span class="lineNum">    1037 </span><span class="lineNoCov">          0 :         rResult[5] =  (( 1.0 + rCoordinates[0] )</span></a>
<a name="1038"><span class="lineNum">    1038 </span><span class="lineNoCov">          0 :                      *( 1.0 - rCoordinates[1]*rCoordinates[1] ) ) / 2.0 ;</span></a>
<a name="1039"><span class="lineNum">    1039 </span><span class="lineNoCov">          0 :         rResult[6] =  (( 1.0 -rCoordinates[0]*rCoordinates[0] )</span></a>
<a name="1040"><span class="lineNum">    1040 </span><span class="lineNoCov">          0 :                      *( 1.0 + rCoordinates[1] ) ) / 2.0 ;</span></a>
<a name="1041"><span class="lineNum">    1041 </span><span class="lineNoCov">          0 :         rResult[7] =  (( 1.0 -rCoordinates[0] )</span></a>
<a name="1042"><span class="lineNum">    1042 </span><span class="lineNoCov">          0 :                      *( 1.0 - rCoordinates[1]*rCoordinates[1] ) ) / 2.0 ;</span></a>
<a name="1043"><span class="lineNum">    1043 </span>            : </a>
<a name="1044"><span class="lineNum">    1044 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1045"><span class="lineNum">    1045 </span>            :     }</a>
<a name="1046"><span class="lineNum">    1046 </span>            :     /**</a>
<a name="1047"><span class="lineNum">    1047 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="1048"><span class="lineNum">    1048 </span>            :      */</a>
<a name="1049"><span class="lineNum">    1049 </span>            :     /**</a>
<a name="1050"><span class="lineNum">    1050 </span>            :      * Calculates the Gradients of the shape functions.</a>
<a name="1051"><span class="lineNum">    1051 </span>            :      * Calculates the gradients of the shape functions with regard to the global</a>
<a name="1052"><span class="lineNum">    1052 </span>            :      * coordinates in all</a>
<a name="1053"><span class="lineNum">    1053 </span>            :      * integration points (\f$ \frac{\partial N^i}{\partial X_j} \f$)</a>
<a name="1054"><span class="lineNum">    1054 </span>            :      *</a>
<a name="1055"><span class="lineNum">    1055 </span>            :      * @param rResult a container which takes the calculated gradients</a>
<a name="1056"><span class="lineNum">    1056 </span>            :      * @param ThisMethod the given IntegrationMethod</a>
<a name="1057"><span class="lineNum">    1057 </span>            :      *</a>
<a name="1058"><span class="lineNum">    1058 </span>            :      * @return the gradients of all shape functions with regard to the</a>
<a name="1059"><span class="lineNum">    1059 </span>            :      * global coordinates</a>
<a name="1060"><span class="lineNum">    1060 </span>            :      *</a>
<a name="1061"><span class="lineNum">    1061 </span>            :      * KLUDGE: method call only works with explicit JacobiansType</a>
<a name="1062"><span class="lineNum">    1062 </span>            :      * rather than creating JacobiansType within argument list</a>
<a name="1063"><span class="lineNum">    1063 </span>            :      */</a>
<a name="1064"><span class="lineNum">    1064 </span><span class="lineNoCov">          0 :     void ShapeFunctionsIntegrationPointsGradients(</span></a>
<a name="1065"><span class="lineNum">    1065 </span>            :         ShapeFunctionsGradientsType&amp; rResult,</a>
<a name="1066"><span class="lineNum">    1066 </span>            :         IntegrationMethod ThisMethod ) const override</a>
<a name="1067"><span class="lineNum">    1067 </span>            :     {</a>
<a name="1068"><span class="lineNum">    1068 </span><span class="lineNoCov">          0 :         const unsigned int integration_points_number =</span></a>
<a name="1069"><span class="lineNum">    1069 </span>            :             msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1070"><span class="lineNum">    1070 </span>            : </a>
<a name="1071"><span class="lineNum">    1071 </span><span class="lineNoCov">          0 :         if ( integration_points_number == 0 )</span></a>
<a name="1072"><span class="lineNum">    1072 </span>            :         {</a>
<a name="1073"><span class="lineNum">    1073 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;This integration method is not supported&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="1074"><span class="lineNum">    1074 </span>            :         }</a>
<a name="1075"><span class="lineNum">    1075 </span>            : </a>
<a name="1076"><span class="lineNum">    1076 </span>            :         //workaround by riccardo</a>
<a name="1077"><span class="lineNum">    1077 </span><span class="lineNoCov">          0 :         if ( rResult.size() != integration_points_number )</span></a>
<a name="1078"><span class="lineNum">    1078 </span>            :         {</a>
<a name="1079"><span class="lineNum">    1079 </span>            :             // KLUDGE: While there is a bug in ublas</a>
<a name="1080"><span class="lineNum">    1080 </span>            :             // vector resize, I have to put this beside resizing!!</a>
<a name="1081"><span class="lineNum">    1081 </span>            :             ShapeFunctionsGradientsType temp( integration_points_number );</a>
<a name="1082"><span class="lineNum">    1082 </span>            :             rResult.swap( temp );</a>
<a name="1083"><span class="lineNum">    1083 </span>            :         }</a>
<a name="1084"><span class="lineNum">    1084 </span>            : </a>
<a name="1085"><span class="lineNum">    1085 </span>            :         //calculating the local gradients</a>
<a name="1086"><span class="lineNum">    1086 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType locG =</span></a>
<a name="1087"><span class="lineNum">    1087 </span>            :             CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="1088"><span class="lineNum">    1088 </span>            : </a>
<a name="1089"><span class="lineNum">    1089 </span>            :         //getting the inverse jacobian matrices</a>
<a name="1090"><span class="lineNum">    1090 </span>            :         JacobiansType temp( integration_points_number );</a>
<a name="1091"><span class="lineNum">    1091 </span>            : </a>
<a name="1092"><span class="lineNum">    1092 </span><span class="lineNoCov">          0 :         JacobiansType invJ = InverseOfJacobian( temp, ThisMethod );</span></a>
<a name="1093"><span class="lineNum">    1093 </span>            : </a>
<a name="1094"><span class="lineNum">    1094 </span>            :         //loop over all integration points</a>
<a name="1095"><span class="lineNum">    1095 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1096"><span class="lineNum">    1096 </span>            :         {</a>
<a name="1097"><span class="lineNum">    1097 </span><span class="lineNoCov">          0 :             rResult[pnt].resize( 4, 2, false );</span></a>
<a name="1098"><span class="lineNum">    1098 </span>            : </a>
<a name="1099"><span class="lineNum">    1099 </span><span class="lineNoCov">          0 :             for ( unsigned int i = 0; i &lt; 4; i++ )</span></a>
<a name="1100"><span class="lineNum">    1100 </span>            :             {</a>
<a name="1101"><span class="lineNum">    1101 </span><span class="lineNoCov">          0 :                 for ( unsigned int j = 0; j &lt; 2; j++ )</span></a>
<a name="1102"><span class="lineNum">    1102 </span>            :                 {</a>
<a name="1103"><span class="lineNum">    1103 </span><span class="lineNoCov">          0 :                     rResult[pnt]( i, j ) =</span></a>
<a name="1104"><span class="lineNum">    1104 </span><span class="lineNoCov">          0 :                         ( locG[pnt]( i, 0 ) * invJ[pnt]( j, 0 ) )</span></a>
<a name="1105"><span class="lineNum">    1105 </span><span class="lineNoCov">          0 :                         + ( locG[pnt]( i, 1 ) * invJ[pnt]( j, 1 ) );</span></a>
<a name="1106"><span class="lineNum">    1106 </span>            :                 }</a>
<a name="1107"><span class="lineNum">    1107 </span>            :             }</a>
<a name="1108"><span class="lineNum">    1108 </span>            :         }//end of loop over integration points</a>
<a name="1109"><span class="lineNum">    1109 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1110"><span class="lineNum">    1110 </span>            : </a>
<a name="1111"><span class="lineNum">    1111 </span>            :     /**</a>
<a name="1112"><span class="lineNum">    1112 </span>            :      * Input and Output</a>
<a name="1113"><span class="lineNum">    1113 </span>            :      */</a>
<a name="1114"><span class="lineNum">    1114 </span>            : </a>
<a name="1115"><span class="lineNum">    1115 </span>            :     /**</a>
<a name="1116"><span class="lineNum">    1116 </span>            :      * Turn back information as a string.</a>
<a name="1117"><span class="lineNum">    1117 </span>            :      * @return String contains information about this geometry.</a>
<a name="1118"><span class="lineNum">    1118 </span>            :      * @see PrintData()</a>
<a name="1119"><span class="lineNum">    1119 </span>            :      * @see PrintInfo()</a>
<a name="1120"><span class="lineNum">    1120 </span>            :      */</a>
<a name="1121"><span class="lineNum">    1121 </span><span class="lineNoCov">          0 :     std::string Info() const override</span></a>
<a name="1122"><span class="lineNum">    1122 </span>            :     {</a>
<a name="1123"><span class="lineNum">    1123 </span><span class="lineNoCov">          0 :         return &quot;2 dimensional quadrilateral with eight nodes in 2D space&quot;;</span></a>
<a name="1124"><span class="lineNum">    1124 </span>            :     }</a>
<a name="1125"><span class="lineNum">    1125 </span>            : </a>
<a name="1126"><span class="lineNum">    1126 </span>            :     /**</a>
<a name="1127"><span class="lineNum">    1127 </span>            :      * Print information about this object.</a>
<a name="1128"><span class="lineNum">    1128 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="1129"><span class="lineNum">    1129 </span>            :      * @see PrintData()</a>
<a name="1130"><span class="lineNum">    1130 </span>            :      * @see Info()</a>
<a name="1131"><span class="lineNum">    1131 </span>            :      */</a>
<a name="1132"><span class="lineNum">    1132 </span><span class="lineNoCov">          0 :     void PrintInfo( std::ostream&amp; rOStream ) const override</span></a>
<a name="1133"><span class="lineNum">    1133 </span>            :     {</a>
<a name="1134"><span class="lineNum">    1134 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;2 dimensional quadrilateral with eight nodes in 2D space&quot;;</span></a>
<a name="1135"><span class="lineNum">    1135 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1136"><span class="lineNum">    1136 </span>            : </a>
<a name="1137"><span class="lineNum">    1137 </span>            :     /**</a>
<a name="1138"><span class="lineNum">    1138 </span>            :      * Print geometry's data into given stream.</a>
<a name="1139"><span class="lineNum">    1139 </span>            :      * Prints it's points by the order they stored in</a>
<a name="1140"><span class="lineNum">    1140 </span>            :      * the geometry and then center point of geometry.</a>
<a name="1141"><span class="lineNum">    1141 </span>            :      *</a>
<a name="1142"><span class="lineNum">    1142 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="1143"><span class="lineNum">    1143 </span>            :      * @see PrintInfo()</a>
<a name="1144"><span class="lineNum">    1144 </span>            :      * @see Info()</a>
<a name="1145"><span class="lineNum">    1145 </span>            :      */</a>
<a name="1146"><span class="lineNum">    1146 </span><span class="lineNoCov">          0 :     void PrintData( std::ostream&amp; rOStream ) const override</span></a>
<a name="1147"><span class="lineNum">    1147 </span>            :     {</a>
<a name="1148"><span class="lineNum">    1148 </span><span class="lineNoCov">          0 :         BaseType::PrintData( rOStream );</span></a>
<a name="1149"><span class="lineNum">    1149 </span>            :         std::cout &lt;&lt; std::endl;</a>
<a name="1150"><span class="lineNum">    1150 </span>            :         Matrix jacobian;</a>
<a name="1151"><span class="lineNum">    1151 </span><span class="lineNoCov">          0 :         Jacobian( jacobian, PointType() );</span></a>
<a name="1152"><span class="lineNum">    1152 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;    Jacobian in the origin\t : &quot; &lt;&lt; jacobian;</span></a>
<a name="1153"><span class="lineNum">    1153 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1154"><span class="lineNum">    1154 </span>            : </a>
<a name="1155"><span class="lineNum">    1155 </span>            :     /**</a>
<a name="1156"><span class="lineNum">    1156 </span>            :      * Calculates the local gradients for all integration points for</a>
<a name="1157"><span class="lineNum">    1157 </span>            :      * given integration method</a>
<a name="1158"><span class="lineNum">    1158 </span>            :      */</a>
<a name="1159"><span class="lineNum">    1159 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients(</span></a>
<a name="1160"><span class="lineNum">    1160 </span>            :         IntegrationMethod ThisMethod )</a>
<a name="1161"><span class="lineNum">    1161 </span>            :     {</a>
<a name="1162"><span class="lineNum">    1162 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="1163"><span class="lineNum">    1163 </span>            :         = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="1164"><span class="lineNum">    1164 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="1165"><span class="lineNum">    1165 </span>            :         = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1166"><span class="lineNum">    1166 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="1167"><span class="lineNum">    1167 </span>            : </a>
<a name="1168"><span class="lineNum">    1168 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1169"><span class="lineNum">    1169 </span>            :         {</a>
<a name="1170"><span class="lineNum">    1170 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="1171"><span class="lineNum">    1171 </span>            :         }</a>
<a name="1172"><span class="lineNum">    1172 </span>            : </a>
<a name="1173"><span class="lineNum">    1173 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="1174"><span class="lineNum">    1174 </span>            :     }</a>
<a name="1175"><span class="lineNum">    1175 </span>            : </a>
<a name="1176"><span class="lineNum">    1176 </span>            :     /**</a>
<a name="1177"><span class="lineNum">    1177 </span>            :      * Calculates the local gradients for all integration points for the</a>
<a name="1178"><span class="lineNum">    1178 </span>            :      * default integration method</a>
<a name="1179"><span class="lineNum">    1179 </span>            :      */</a>
<a name="1180"><span class="lineNum">    1180 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients()</span></a>
<a name="1181"><span class="lineNum">    1181 </span>            :     {</a>
<a name="1182"><span class="lineNum">    1182 </span>            :         IntegrationMethod ThisMethod = msGeometryData.DefaultIntegrationMethod();</a>
<a name="1183"><span class="lineNum">    1183 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="1184"><span class="lineNum">    1184 </span>            :         = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="1185"><span class="lineNum">    1185 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="1186"><span class="lineNum">    1186 </span>            :         = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1187"><span class="lineNum">    1187 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="1188"><span class="lineNum">    1188 </span>            : </a>
<a name="1189"><span class="lineNum">    1189 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1190"><span class="lineNum">    1190 </span>            :         {</a>
<a name="1191"><span class="lineNum">    1191 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="1192"><span class="lineNum">    1192 </span>            :         }</a>
<a name="1193"><span class="lineNum">    1193 </span>            : </a>
<a name="1194"><span class="lineNum">    1194 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="1195"><span class="lineNum">    1195 </span>            :     }</a>
<a name="1196"><span class="lineNum">    1196 </span>            : </a>
<a name="1197"><span class="lineNum">    1197 </span>            :     /**</a>
<a name="1198"><span class="lineNum">    1198 </span>            :     * Calculates the gradients in terms of local coordinates</a>
<a name="1199"><span class="lineNum">    1199 </span>            :     * of all shape functions in a given point.</a>
<a name="1200"><span class="lineNum">    1200 </span>            :     * @param rPoint the current point at which the gradients are calculated</a>
<a name="1201"><span class="lineNum">    1201 </span>            :     * @return the gradients of all shape functions</a>
<a name="1202"><span class="lineNum">    1202 </span>            :     * \f$ \frac{\partial N^i}{\partial \xi_j} \f$</a>
<a name="1203"><span class="lineNum">    1203 </span>            :      */</a>
<a name="1204"><span class="lineNum">    1204 </span><span class="lineNoCov">          0 :     Matrix&amp; ShapeFunctionsLocalGradients(</span></a>
<a name="1205"><span class="lineNum">    1205 </span>            :         Matrix&amp; rResult,</a>
<a name="1206"><span class="lineNum">    1206 </span>            :         const CoordinatesArrayType&amp; rPoint</a>
<a name="1207"><span class="lineNum">    1207 </span>            :         ) const override</a>
<a name="1208"><span class="lineNum">    1208 </span>            :     {</a>
<a name="1209"><span class="lineNum">    1209 </span>            :         // Setting up result matrix</a>
<a name="1210"><span class="lineNum">    1210 </span><span class="lineNoCov">          0 :         rResult.resize( 8, 2 , false);</span></a>
<a name="1211"><span class="lineNum">    1211 </span>            :         noalias( rResult ) = ZeroMatrix( 8, 2 );</a>
<a name="1212"><span class="lineNum">    1212 </span>            : </a>
<a name="1213"><span class="lineNum">    1213 </span>            :         // Primary nodes</a>
<a name="1214"><span class="lineNum">    1214 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = - ((-1.0 + rPoint[1])*( 2.0 * rPoint[0] + rPoint[1])) / 4.0;</span></a>
<a name="1215"><span class="lineNum">    1215 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = - ((-1.0 + rPoint[0])*( 2.0 * rPoint[1] + rPoint[0])) / 4.0;</span></a>
<a name="1216"><span class="lineNum">    1216 </span>            : </a>
<a name="1217"><span class="lineNum">    1217 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =   ((-1.0 + rPoint[1])*(-2.0 * rPoint[0] + rPoint[1])) / 4.0;</span></a>
<a name="1218"><span class="lineNum">    1218 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =   (( 1.0 + rPoint[0])*( 2.0 * rPoint[1] - rPoint[0])) / 4.0;</span></a>
<a name="1219"><span class="lineNum">    1219 </span>            : </a>
<a name="1220"><span class="lineNum">    1220 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =   (( 1.0 + rPoint[1])*( 2.0 * rPoint[0] + rPoint[1])) / 4.0;</span></a>
<a name="1221"><span class="lineNum">    1221 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =   (( 1.0 + rPoint[0])*( 2.0 * rPoint[1] + rPoint[0])) / 4.0;</span></a>
<a name="1222"><span class="lineNum">    1222 </span>            : </a>
<a name="1223"><span class="lineNum">    1223 </span><span class="lineNoCov">          0 :         rResult( 3, 0 ) = - (( 1.0 + rPoint[1])*(-2.0 * rPoint[0] + rPoint[1])) / 4.0;</span></a>
<a name="1224"><span class="lineNum">    1224 </span><span class="lineNoCov">          0 :         rResult( 3, 1 ) = - ((-1.0 + rPoint[0])*( 2.0 * rPoint[1] - rPoint[0])) / 4.0;</span></a>
<a name="1225"><span class="lineNum">    1225 </span>            : </a>
<a name="1226"><span class="lineNum">    1226 </span>            :         // Secondary nodes</a>
<a name="1227"><span class="lineNum">    1227 </span><span class="lineNoCov">          0 :         rResult( 4, 0 ) =   rPoint[0] * (-1.0 + rPoint[1]);</span></a>
<a name="1228"><span class="lineNum">    1228 </span><span class="lineNoCov">          0 :         rResult( 4, 1 ) =   ((1.0 + rPoint[0]) * (-1.0 + rPoint[0])) / 2.0;</span></a>
<a name="1229"><span class="lineNum">    1229 </span>            : </a>
<a name="1230"><span class="lineNum">    1230 </span><span class="lineNoCov">          0 :         rResult( 5, 0 ) = - ((1.0 + rPoint[1]) * (-1.0 + rPoint[1])) / 2.0;</span></a>
<a name="1231"><span class="lineNum">    1231 </span><span class="lineNoCov">          0 :         rResult( 5, 1 ) = - rPoint[1] * ( 1.0 + rPoint[0]);</span></a>
<a name="1232"><span class="lineNum">    1232 </span>            : </a>
<a name="1233"><span class="lineNum">    1233 </span><span class="lineNoCov">          0 :         rResult( 6, 0 ) = - rPoint[0] * ( 1.0 + rPoint[1]);</span></a>
<a name="1234"><span class="lineNum">    1234 </span><span class="lineNoCov">          0 :         rResult( 6, 1 ) = - ((1.0 + rPoint[0]) * (-1.0 + rPoint[0])) / 2.0;</span></a>
<a name="1235"><span class="lineNum">    1235 </span>            : </a>
<a name="1236"><span class="lineNum">    1236 </span><span class="lineNoCov">          0 :         rResult( 7, 0 ) =   ((1.0 + rPoint[1]) * (-1.0 + rPoint[1])) / 2.0;</span></a>
<a name="1237"><span class="lineNum">    1237 </span><span class="lineNoCov">          0 :         rResult( 7, 1 ) =   rPoint[1] * (-1.0 + rPoint[0]);</span></a>
<a name="1238"><span class="lineNum">    1238 </span>            : </a>
<a name="1239"><span class="lineNum">    1239 </span><span class="lineNoCov">          0 :         return( rResult );</span></a>
<a name="1240"><span class="lineNum">    1240 </span>            :     }</a>
<a name="1241"><span class="lineNum">    1241 </span>            : </a>
<a name="1242"><span class="lineNum">    1242 </span>            :     /**</a>
<a name="1243"><span class="lineNum">    1243 </span>            :      * returns the local coordinates of all nodes of the current geometry</a>
<a name="1244"><span class="lineNum">    1244 </span>            :      * @param rResult a Matrix object that will be overwritten by the result</a>
<a name="1245"><span class="lineNum">    1245 </span>            :      * @return the local coordinates of all nodes</a>
<a name="1246"><span class="lineNum">    1246 </span>            :      */</a>
<a name="1247"><span class="lineNum">    1247 </span><span class="lineNoCov">          0 :     Matrix&amp; PointsLocalCoordinates( Matrix&amp; rResult ) const override</span></a>
<a name="1248"><span class="lineNum">    1248 </span>            :     {</a>
<a name="1249"><span class="lineNum">    1249 </span><span class="lineNoCov">          0 :         rResult.resize( 8, 2 , false);</span></a>
<a name="1250"><span class="lineNum">    1250 </span>            :         noalias( rResult ) = ZeroMatrix( 8, 2 );</a>
<a name="1251"><span class="lineNum">    1251 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = -1.0;</span></a>
<a name="1252"><span class="lineNum">    1252 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = -1.0;</span></a>
<a name="1253"><span class="lineNum">    1253 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  1.0;</span></a>
<a name="1254"><span class="lineNum">    1254 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) = -1.0;</span></a>
<a name="1255"><span class="lineNum">    1255 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  1.0;</span></a>
<a name="1256"><span class="lineNum">    1256 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  1.0;</span></a>
<a name="1257"><span class="lineNum">    1257 </span><span class="lineNoCov">          0 :         rResult( 3, 0 ) = -1.0;</span></a>
<a name="1258"><span class="lineNum">    1258 </span><span class="lineNoCov">          0 :         rResult( 3, 1 ) =  1.0;</span></a>
<a name="1259"><span class="lineNum">    1259 </span><span class="lineNoCov">          0 :         rResult( 4, 0 ) =  0.0;</span></a>
<a name="1260"><span class="lineNum">    1260 </span><span class="lineNoCov">          0 :         rResult( 4, 1 ) = -1.0;</span></a>
<a name="1261"><span class="lineNum">    1261 </span><span class="lineNoCov">          0 :         rResult( 5, 0 ) =  1.0;</span></a>
<a name="1262"><span class="lineNum">    1262 </span><span class="lineNoCov">          0 :         rResult( 5, 1 ) =  0.0;</span></a>
<a name="1263"><span class="lineNum">    1263 </span><span class="lineNoCov">          0 :         rResult( 6, 0 ) =  0.0;</span></a>
<a name="1264"><span class="lineNum">    1264 </span><span class="lineNoCov">          0 :         rResult( 6, 1 ) =  1.0;</span></a>
<a name="1265"><span class="lineNum">    1265 </span><span class="lineNoCov">          0 :         rResult( 7, 0 ) = -1.0;</span></a>
<a name="1266"><span class="lineNum">    1266 </span><span class="lineNoCov">          0 :         rResult( 7, 1 ) =  0.0;</span></a>
<a name="1267"><span class="lineNum">    1267 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1268"><span class="lineNum">    1268 </span>            :     }</a>
<a name="1269"><span class="lineNum">    1269 </span>            : </a>
<a name="1270"><span class="lineNum">    1270 </span>            :     /**</a>
<a name="1271"><span class="lineNum">    1271 </span>            :      * Returns the shape function gradients in an arbitrary point,</a>
<a name="1272"><span class="lineNum">    1272 </span>            :      * given in local coordinates</a>
<a name="1273"><span class="lineNum">    1273 </span>            :      * @param rResult the matrix of gradients, will be overwritten</a>
<a name="1274"><span class="lineNum">    1274 </span>            :      * with the gradients for all</a>
<a name="1275"><span class="lineNum">    1275 </span>            :      * shape functions in given point</a>
<a name="1276"><span class="lineNum">    1276 </span>            :      * @param rPoint the given point the gradients are calculated in</a>
<a name="1277"><span class="lineNum">    1277 </span>            :      */</a>
<a name="1278"><span class="lineNum">    1278 </span><span class="lineNoCov">          0 :     virtual Matrix&amp; ShapeFunctionsGradients( Matrix&amp; rResult, PointType&amp; rPoint )</span></a>
<a name="1279"><span class="lineNum">    1279 </span>            :     {</a>
<a name="1280"><span class="lineNum">    1280 </span><span class="lineNoCov">          0 :         rResult.resize( 8, 2 , false);</span></a>
<a name="1281"><span class="lineNum">    1281 </span>            :         noalias( rResult ) = ZeroMatrix( 8, 2 );</a>
<a name="1282"><span class="lineNum">    1282 </span>            : </a>
<a name="1283"><span class="lineNum">    1283 </span>            :         const CoordinatesArrayType&amp; Coords = rPoint.Coordinates();</a>
<a name="1284"><span class="lineNum">    1284 </span>            : </a>
<a name="1285"><span class="lineNum">    1285 </span><span class="lineNoCov">          0 :         rResult = ShapeFunctionsLocalGradients(rResult, Coords);</span></a>
<a name="1286"><span class="lineNum">    1286 </span>            : </a>
<a name="1287"><span class="lineNum">    1287 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1288"><span class="lineNum">    1288 </span>            :     }</a>
<a name="1289"><span class="lineNum">    1289 </span>            : </a>
<a name="1290"><span class="lineNum">    1290 </span>            :     /**</a>
<a name="1291"><span class="lineNum">    1291 </span>            :      * Returns the second order derivatives of all shape functions</a>
<a name="1292"><span class="lineNum">    1292 </span>            :      * in given arbitrary points</a>
<a name="1293"><span class="lineNum">    1293 </span>            :      * @param rResult a third order tensor which contains the second derivatives</a>
<a name="1294"><span class="lineNum">    1294 </span>            :      * @param rPoint the given point the second order derivatives are calculated in</a>
<a name="1295"><span class="lineNum">    1295 </span>            :      */</a>
<a name="1296"><span class="lineNum">    1296 </span><span class="lineNoCov">          0 :     ShapeFunctionsSecondDerivativesType&amp; ShapeFunctionsSecondDerivatives( ShapeFunctionsSecondDerivativesType&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="1297"><span class="lineNum">    1297 </span>            :     {</a>
<a name="1298"><span class="lineNum">    1298 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="1299"><span class="lineNum">    1299 </span>            :         {</a>
<a name="1300"><span class="lineNum">    1300 </span>            :             // KLUDGE: While there is a bug in ublas</a>
<a name="1301"><span class="lineNum">    1301 </span>            :             // vector resize, I have to put this beside resizing!!</a>
<a name="1302"><span class="lineNum">    1302 </span>            :             ShapeFunctionsGradientsType temp( this-&gt;PointsNumber() );</a>
<a name="1303"><span class="lineNum">    1303 </span>            :             rResult.swap( temp );</a>
<a name="1304"><span class="lineNum">    1304 </span>            :         }</a>
<a name="1305"><span class="lineNum">    1305 </span>            : </a>
<a name="1306"><span class="lineNum">    1306 </span><span class="lineNoCov">          0 :         for ( unsigned  int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="1307"><span class="lineNum">    1307 </span>            :         {</a>
<a name="1308"><span class="lineNum">    1308 </span><span class="lineNoCov">          0 :             rResult[i].resize( 2, 2 , false);</span></a>
<a name="1309"><span class="lineNum">    1309 </span>            :             noalias( rResult[i] ) = ZeroMatrix( 2, 2 );</a>
<a name="1310"><span class="lineNum">    1310 </span>            :         }</a>
<a name="1311"><span class="lineNum">    1311 </span>            : </a>
<a name="1312"><span class="lineNum">    1312 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 0 ) = ( 4.0 - 4 * rPoint[1] ) / 8.0;</span></a>
<a name="1313"><span class="lineNum">    1313 </span>            : </a>
<a name="1314"><span class="lineNum">    1314 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 1 ) = ( -2.0 ) * ( 1.0 + 2.0 * rPoint[0] + rPoint[1] - 1.0 ) / 8.0</span></a>
<a name="1315"><span class="lineNum">    1315 </span><span class="lineNoCov">          0 :                              + (( -1.0 + rPoint[1] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1316"><span class="lineNum">    1316 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 0 ) = ( -2.0 ) * ( 1.0 + rPoint[0] + 2.0 * rPoint[1] - 1.0 ) / 8.0</span></a>
<a name="1317"><span class="lineNum">    1317 </span><span class="lineNoCov">          0 :                              + (( -1.0 + rPoint[0] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1318"><span class="lineNum">    1318 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 1 ) = (( -1.0 + rPoint[0] ) * ( -2.0 ) * ( 2.0 ) ) / 8.0;</span></a>
<a name="1319"><span class="lineNum">    1319 </span>            : </a>
<a name="1320"><span class="lineNum">    1320 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 0 ) = -(( -1.0 + rPoint[1] ) * ( -2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1321"><span class="lineNum">    1321 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 1 ) = ( 2.0 ) * ( 1.0 - 2.0 * rPoint[0] + rPoint[1] - 1.0 ) / 8.0</span></a>
<a name="1322"><span class="lineNum">    1322 </span><span class="lineNoCov">          0 :                              - (( -1.0 + rPoint[1] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1323"><span class="lineNum">    1323 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 0 ) = ( -1.0 + rPoint[0] - 2.0 * rPoint[1] + 1.0 ) * ( -2.0 ) / 8.0</span></a>
<a name="1324"><span class="lineNum">    1324 </span><span class="lineNoCov">          0 :                              + (( 1.0 + rPoint[0] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1325"><span class="lineNum">    1325 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 1 ) = (( 1.0 + rPoint[0] ) * ( -2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1326"><span class="lineNum">    1326 </span>            : </a>
<a name="1327"><span class="lineNum">    1327 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 0 ) = -(( 1.0 + rPoint[1] ) * ( 2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1328"><span class="lineNum">    1328 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 1 ) = -(( 1.0 ) * ( -1.0 + 2.0 * rPoint[0] + rPoint[1] + 1.0 ) * ( -2.0 ) ) / 8.0</span></a>
<a name="1329"><span class="lineNum">    1329 </span><span class="lineNoCov">          0 :                              - (( 1.0 + rPoint[1] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1330"><span class="lineNum">    1330 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 0 ) = -(( 1.0 ) * ( -1.0 + rPoint[0] + 2.0 * rPoint[1] + 1.0 ) * ( -2.0 ) ) / 8.0</span></a>
<a name="1331"><span class="lineNum">    1331 </span><span class="lineNoCov">          0 :                              - (( 1.0 + rPoint[0] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1332"><span class="lineNum">    1332 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 1 ) = -(( 1.0 + rPoint[0] ) * ( 2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1333"><span class="lineNum">    1333 </span>            : </a>
<a name="1334"><span class="lineNum">    1334 </span><span class="lineNoCov">          0 :         rResult[3]( 0, 0 ) = (( 1.0 + rPoint[1] ) * ( -2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1335"><span class="lineNum">    1335 </span><span class="lineNoCov">          0 :         rResult[3]( 0, 1 ) = (( 1.0 ) * ( -1.0 - 2.0 * rPoint[0] + rPoint[1] + 1.0 ) * ( -2.0 ) ) / 8.0</span></a>
<a name="1336"><span class="lineNum">    1336 </span><span class="lineNoCov">          0 :                              + (( 1.0 + rPoint[1] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1337"><span class="lineNum">    1337 </span><span class="lineNoCov">          0 :         rResult[3]( 1, 0 ) = -(( -2.0 ) * ( 1.0 + rPoint[0] - 2.0 * rPoint[1] - 1.0 ) ) / 8.0</span></a>
<a name="1338"><span class="lineNum">    1338 </span><span class="lineNoCov">          0 :                              - (( -1.0 + rPoint[0] ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1339"><span class="lineNum">    1339 </span><span class="lineNoCov">          0 :         rResult[3]( 1, 1 ) = -(( -1.0 + rPoint[0] ) * ( -2.0 ) * ( -2.0 ) ) / 8.0;</span></a>
<a name="1340"><span class="lineNum">    1340 </span>            : </a>
<a name="1341"><span class="lineNum">    1341 </span><span class="lineNoCov">          0 :         rResult[4]( 0, 0 ) = -(( -1.0 + rPoint[1] ) * ( -2.0 ) ) / 2.0;</span></a>
<a name="1342"><span class="lineNum">    1342 </span><span class="lineNoCov">          0 :         rResult[4]( 0, 1 ) = -( rPoint[0] * ( -2.0 ) ) / 2.0;</span></a>
<a name="1343"><span class="lineNum">    1343 </span><span class="lineNoCov">          0 :         rResult[4]( 1, 0 ) = -(( 2.0 * rPoint[0] ) * ( -2.0 ) ) / 4.0;</span></a>
<a name="1344"><span class="lineNum">    1344 </span><span class="lineNoCov">          0 :         rResult[4]( 1, 1 ) = 0.0;</span></a>
<a name="1345"><span class="lineNum">    1345 </span>            : </a>
<a name="1346"><span class="lineNum">    1346 </span><span class="lineNoCov">          0 :         rResult[5]( 0, 0 ) = 0.0;</span></a>
<a name="1347"><span class="lineNum">    1347 </span><span class="lineNoCov">          0 :         rResult[5]( 0, 1 ) = (( 2.0 * rPoint[1] ) * ( -2.0 ) ) / 4.0;</span></a>
<a name="1348"><span class="lineNum">    1348 </span><span class="lineNoCov">          0 :         rResult[5]( 1, 0 ) = ( rPoint[1] * ( -2.0 ) ) / 2.0;</span></a>
<a name="1349"><span class="lineNum">    1349 </span><span class="lineNoCov">          0 :         rResult[5]( 1, 1 ) = (( 1.0 + rPoint[0] ) * ( -2.0 ) ) / 2.0;</span></a>
<a name="1350"><span class="lineNum">    1350 </span>            : </a>
<a name="1351"><span class="lineNum">    1351 </span><span class="lineNoCov">          0 :         rResult[6]( 0, 0 ) = (( 1.0 + rPoint[1] ) * ( -2.0 ) ) / 2.0;</span></a>
<a name="1352"><span class="lineNum">    1352 </span><span class="lineNoCov">          0 :         rResult[6]( 0, 1 ) = ( rPoint[0] * ( -2.0 ) ) / 2.0;</span></a>
<a name="1353"><span class="lineNum">    1353 </span><span class="lineNoCov">          0 :         rResult[6]( 1, 0 ) = (( 2.0 * rPoint[0] ) * ( -2.0 ) ) / 4.0;</span></a>
<a name="1354"><span class="lineNum">    1354 </span><span class="lineNoCov">          0 :         rResult[6]( 1, 1 ) = 0.0;</span></a>
<a name="1355"><span class="lineNum">    1355 </span>            : </a>
<a name="1356"><span class="lineNum">    1356 </span><span class="lineNoCov">          0 :         rResult[7]( 0, 0 ) = 0.0;</span></a>
<a name="1357"><span class="lineNum">    1357 </span><span class="lineNoCov">          0 :         rResult[7]( 0, 1 ) = -(( 2.0 * rPoint[1] ) * ( -2.0 ) ) / 4.0;</span></a>
<a name="1358"><span class="lineNum">    1358 </span><span class="lineNoCov">          0 :         rResult[7]( 1, 0 ) = -( rPoint[1] * ( -2.0 ) ) / 2.0;</span></a>
<a name="1359"><span class="lineNum">    1359 </span><span class="lineNoCov">          0 :         rResult[7]( 1, 1 ) = -(( -1.0 + rPoint[0] ) * ( -2.0 ) ) / 2.0;</span></a>
<a name="1360"><span class="lineNum">    1360 </span>            : </a>
<a name="1361"><span class="lineNum">    1361 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1362"><span class="lineNum">    1362 </span>            :     }</a>
<a name="1363"><span class="lineNum">    1363 </span>            : </a>
<a name="1364"><span class="lineNum">    1364 </span>            :     /**</a>
<a name="1365"><span class="lineNum">    1365 </span>            :      * Returns the third order derivatives of all shape functions</a>
<a name="1366"><span class="lineNum">    1366 </span>            :      * in given arbitrary points</a>
<a name="1367"><span class="lineNum">    1367 </span>            :      *</a>
<a name="1368"><span class="lineNum">    1368 </span>            :      * @param rResult a fourth order tensor which contains the third derivatives</a>
<a name="1369"><span class="lineNum">    1369 </span>            :      * @param rPoint the given point the third order derivatives are calculated in</a>
<a name="1370"><span class="lineNum">    1370 </span>            :      */</a>
<a name="1371"><span class="lineNum">    1371 </span><span class="lineNoCov">          0 :     ShapeFunctionsThirdDerivativesType&amp; ShapeFunctionsThirdDerivatives(</span></a>
<a name="1372"><span class="lineNum">    1372 </span>            :         ShapeFunctionsThirdDerivativesType&amp; rResult,</a>
<a name="1373"><span class="lineNum">    1373 </span>            :         const CoordinatesArrayType&amp; rPoint</a>
<a name="1374"><span class="lineNum">    1374 </span>            :         ) const override</a>
<a name="1375"><span class="lineNum">    1375 </span>            :     {</a>
<a name="1376"><span class="lineNum">    1376 </span>            : </a>
<a name="1377"><span class="lineNum">    1377 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="1378"><span class="lineNum">    1378 </span>            :         {</a>
<a name="1379"><span class="lineNum">    1379 </span>            :             // KLUDGE: While there is a bug in</a>
<a name="1380"><span class="lineNum">    1380 </span>            :             // ublas vector resize, I have to put this beside resizing!!</a>
<a name="1381"><span class="lineNum">    1381 </span>            : //                 ShapeFunctionsGradientsType</a>
<a name="1382"><span class="lineNum">    1382 </span>            :             ShapeFunctionsThirdDerivativesType temp( this-&gt;PointsNumber() );</a>
<a name="1383"><span class="lineNum">    1383 </span>            :             rResult.swap( temp );</a>
<a name="1384"><span class="lineNum">    1384 </span>            :         }</a>
<a name="1385"><span class="lineNum">    1385 </span>            : </a>
<a name="1386"><span class="lineNum">    1386 </span><span class="lineNoCov">          0 :         for ( IndexType i = 0; i &lt; rResult.size(); i++ )</span></a>
<a name="1387"><span class="lineNum">    1387 </span>            :         {</a>
<a name="1388"><span class="lineNum">    1388 </span>            :             DenseVector&lt;Matrix&gt; temp( this-&gt;PointsNumber() );</a>
<a name="1389"><span class="lineNum">    1389 </span>            :             rResult[i].swap( temp );</a>
<a name="1390"><span class="lineNum">    1390 </span>            :         }</a>
<a name="1391"><span class="lineNum">    1391 </span>            : </a>
<a name="1392"><span class="lineNum">    1392 </span><span class="lineNoCov">          0 :         for ( unsigned int i = 0; i &lt; this-&gt;PointsNumber(); i++ )</span></a>
<a name="1393"><span class="lineNum">    1393 </span>            :         {</a>
<a name="1394"><span class="lineNum">    1394 </span><span class="lineNoCov">          0 :             for ( int j = 0; j &lt; 2; j++ )</span></a>
<a name="1395"><span class="lineNum">    1395 </span>            :             {</a>
<a name="1396"><span class="lineNum">    1396 </span><span class="lineNoCov">          0 :                 rResult[i][j].resize( 2, 2 , false);</span></a>
<a name="1397"><span class="lineNum">    1397 </span>            :                 noalias( rResult[i][j] ) = ZeroMatrix( 2, 2);</a>
<a name="1398"><span class="lineNum">    1398 </span>            :             }</a>
<a name="1399"><span class="lineNum">    1399 </span>            :         }</a>
<a name="1400"><span class="lineNum">    1400 </span>            : </a>
<a name="1401"><span class="lineNum">    1401 </span><span class="lineNoCov">          0 :         rResult[0][0]( 0, 0 ) = 0.0;</span></a>
<a name="1402"><span class="lineNum">    1402 </span>            : </a>
<a name="1403"><span class="lineNum">    1403 </span><span class="lineNoCov">          0 :         rResult[0][0]( 0, 1 ) = -0.5;</span></a>
<a name="1404"><span class="lineNum">    1404 </span><span class="lineNoCov">          0 :         rResult[0][0]( 1, 0 ) = -0.5;</span></a>
<a name="1405"><span class="lineNum">    1405 </span><span class="lineNoCov">          0 :         rResult[0][0]( 1, 1 ) = -0.5;</span></a>
<a name="1406"><span class="lineNum">    1406 </span><span class="lineNoCov">          0 :         rResult[0][1]( 0, 0 ) = -0.5;</span></a>
<a name="1407"><span class="lineNum">    1407 </span><span class="lineNoCov">          0 :         rResult[0][1]( 0, 1 ) = -0.5;</span></a>
<a name="1408"><span class="lineNum">    1408 </span><span class="lineNoCov">          0 :         rResult[0][1]( 1, 0 ) = -0.5;</span></a>
<a name="1409"><span class="lineNum">    1409 </span><span class="lineNoCov">          0 :         rResult[0][1]( 1, 1 ) = 0.0;</span></a>
<a name="1410"><span class="lineNum">    1410 </span><span class="lineNoCov">          0 :         rResult[1][0]( 0, 0 ) = 0.0;</span></a>
<a name="1411"><span class="lineNum">    1411 </span><span class="lineNoCov">          0 :         rResult[1][0]( 0, 1 ) = -0.5;</span></a>
<a name="1412"><span class="lineNum">    1412 </span><span class="lineNoCov">          0 :         rResult[1][0]( 1, 0 ) = -0.5;</span></a>
<a name="1413"><span class="lineNum">    1413 </span><span class="lineNoCov">          0 :         rResult[1][0]( 1, 1 ) = 0.5;</span></a>
<a name="1414"><span class="lineNum">    1414 </span><span class="lineNoCov">          0 :         rResult[1][1]( 0, 0 ) = -0.5;</span></a>
<a name="1415"><span class="lineNum">    1415 </span><span class="lineNoCov">          0 :         rResult[1][1]( 0, 1 ) = 0.5;</span></a>
<a name="1416"><span class="lineNum">    1416 </span><span class="lineNoCov">          0 :         rResult[1][1]( 1, 0 ) = 0.5;</span></a>
<a name="1417"><span class="lineNum">    1417 </span><span class="lineNoCov">          0 :         rResult[1][1]( 1, 1 ) = 0.0;</span></a>
<a name="1418"><span class="lineNum">    1418 </span><span class="lineNoCov">          0 :         rResult[2][0]( 0, 0 ) = 0.0;</span></a>
<a name="1419"><span class="lineNum">    1419 </span><span class="lineNoCov">          0 :         rResult[2][0]( 0, 1 ) = 0.5;</span></a>
<a name="1420"><span class="lineNum">    1420 </span><span class="lineNoCov">          0 :         rResult[2][0]( 1, 0 ) = 0.5;</span></a>
<a name="1421"><span class="lineNum">    1421 </span><span class="lineNoCov">          0 :         rResult[2][0]( 1, 1 ) = 0.5;</span></a>
<a name="1422"><span class="lineNum">    1422 </span><span class="lineNoCov">          0 :         rResult[2][1]( 0, 0 ) = 0.5;</span></a>
<a name="1423"><span class="lineNum">    1423 </span><span class="lineNoCov">          0 :         rResult[2][1]( 0, 1 ) = 0.5;</span></a>
<a name="1424"><span class="lineNum">    1424 </span><span class="lineNoCov">          0 :         rResult[2][1]( 1, 0 ) = 0.5;</span></a>
<a name="1425"><span class="lineNum">    1425 </span><span class="lineNoCov">          0 :         rResult[2][1]( 1, 1 ) = 0.0;</span></a>
<a name="1426"><span class="lineNum">    1426 </span><span class="lineNoCov">          0 :         rResult[3][0]( 0, 0 ) = 0.0;</span></a>
<a name="1427"><span class="lineNum">    1427 </span><span class="lineNoCov">          0 :         rResult[3][0]( 0, 1 ) = 0.5;</span></a>
<a name="1428"><span class="lineNum">    1428 </span><span class="lineNoCov">          0 :         rResult[3][0]( 1, 0 ) = 0.5;</span></a>
<a name="1429"><span class="lineNum">    1429 </span><span class="lineNoCov">          0 :         rResult[3][0]( 1, 1 ) = -0.5;</span></a>
<a name="1430"><span class="lineNum">    1430 </span><span class="lineNoCov">          0 :         rResult[3][1]( 0, 0 ) = 0.5;</span></a>
<a name="1431"><span class="lineNum">    1431 </span><span class="lineNoCov">          0 :         rResult[3][1]( 0, 1 ) = -0.5;</span></a>
<a name="1432"><span class="lineNum">    1432 </span><span class="lineNoCov">          0 :         rResult[3][1]( 1, 0 ) = -0.5;</span></a>
<a name="1433"><span class="lineNum">    1433 </span><span class="lineNoCov">          0 :         rResult[3][1]( 1, 1 ) = 0.0;</span></a>
<a name="1434"><span class="lineNum">    1434 </span><span class="lineNoCov">          0 :         rResult[4][0]( 0, 0 ) = 0.0;</span></a>
<a name="1435"><span class="lineNum">    1435 </span><span class="lineNoCov">          0 :         rResult[4][0]( 0, 1 ) = 1.0;</span></a>
<a name="1436"><span class="lineNum">    1436 </span><span class="lineNoCov">          0 :         rResult[4][0]( 1, 0 ) = 1.0;</span></a>
<a name="1437"><span class="lineNum">    1437 </span><span class="lineNoCov">          0 :         rResult[4][0]( 1, 1 ) = 0.0;</span></a>
<a name="1438"><span class="lineNum">    1438 </span><span class="lineNoCov">          0 :         rResult[4][1]( 0, 0 ) = 1.0;</span></a>
<a name="1439"><span class="lineNum">    1439 </span><span class="lineNoCov">          0 :         rResult[4][1]( 0, 1 ) = 0.0;</span></a>
<a name="1440"><span class="lineNum">    1440 </span><span class="lineNoCov">          0 :         rResult[4][1]( 1, 0 ) = 0.0;</span></a>
<a name="1441"><span class="lineNum">    1441 </span><span class="lineNoCov">          0 :         rResult[4][1]( 1, 1 ) = 0.0;</span></a>
<a name="1442"><span class="lineNum">    1442 </span><span class="lineNoCov">          0 :         rResult[5][0]( 0, 0 ) = 0.0;</span></a>
<a name="1443"><span class="lineNum">    1443 </span><span class="lineNoCov">          0 :         rResult[5][0]( 0, 1 ) = 0.0;</span></a>
<a name="1444"><span class="lineNum">    1444 </span><span class="lineNoCov">          0 :         rResult[5][0]( 1, 0 ) = 0.0;</span></a>
<a name="1445"><span class="lineNum">    1445 </span><span class="lineNoCov">          0 :         rResult[5][0]( 1, 1 ) = -1.0;</span></a>
<a name="1446"><span class="lineNum">    1446 </span><span class="lineNoCov">          0 :         rResult[5][1]( 0, 0 ) = 0.0;</span></a>
<a name="1447"><span class="lineNum">    1447 </span><span class="lineNoCov">          0 :         rResult[5][1]( 0, 1 ) = -1.0;</span></a>
<a name="1448"><span class="lineNum">    1448 </span><span class="lineNoCov">          0 :         rResult[5][1]( 1, 0 ) = 1.0;</span></a>
<a name="1449"><span class="lineNum">    1449 </span><span class="lineNoCov">          0 :         rResult[5][1]( 1, 1 ) = 0.0;</span></a>
<a name="1450"><span class="lineNum">    1450 </span><span class="lineNoCov">          0 :         rResult[6][0]( 0, 0 ) = 0.0;</span></a>
<a name="1451"><span class="lineNum">    1451 </span><span class="lineNoCov">          0 :         rResult[6][0]( 0, 1 ) = -1.0;</span></a>
<a name="1452"><span class="lineNum">    1452 </span><span class="lineNoCov">          0 :         rResult[6][0]( 1, 0 ) = -1.0;</span></a>
<a name="1453"><span class="lineNum">    1453 </span><span class="lineNoCov">          0 :         rResult[6][0]( 1, 1 ) = 0.0;</span></a>
<a name="1454"><span class="lineNum">    1454 </span><span class="lineNoCov">          0 :         rResult[6][1]( 0, 0 ) = -1.0;</span></a>
<a name="1455"><span class="lineNum">    1455 </span><span class="lineNoCov">          0 :         rResult[6][1]( 0, 1 ) = 0.0;</span></a>
<a name="1456"><span class="lineNum">    1456 </span><span class="lineNoCov">          0 :         rResult[6][1]( 1, 0 ) = 0.0;</span></a>
<a name="1457"><span class="lineNum">    1457 </span><span class="lineNoCov">          0 :         rResult[6][1]( 1, 1 ) = 0.0;</span></a>
<a name="1458"><span class="lineNum">    1458 </span><span class="lineNoCov">          0 :         rResult[7][0]( 0, 0 ) = 0.0;</span></a>
<a name="1459"><span class="lineNum">    1459 </span><span class="lineNoCov">          0 :         rResult[7][0]( 0, 1 ) = 0.0;</span></a>
<a name="1460"><span class="lineNum">    1460 </span><span class="lineNoCov">          0 :         rResult[7][0]( 1, 0 ) = 0.0;</span></a>
<a name="1461"><span class="lineNum">    1461 </span><span class="lineNoCov">          0 :         rResult[7][0]( 1, 1 ) = 1.0;</span></a>
<a name="1462"><span class="lineNum">    1462 </span><span class="lineNoCov">          0 :         rResult[7][1]( 0, 0 ) = 0.0;</span></a>
<a name="1463"><span class="lineNum">    1463 </span><span class="lineNoCov">          0 :         rResult[7][1]( 0, 1 ) = 1.0;</span></a>
<a name="1464"><span class="lineNum">    1464 </span>            :         rResult[7][1]( 1, 0 ) = -1.0;</a>
<a name="1465"><span class="lineNum">    1465 </span><span class="lineNoCov">          0 :         rResult[7][1]( 1, 0 ) = 0.0;</span></a>
<a name="1466"><span class="lineNum">    1466 </span>            : </a>
<a name="1467"><span class="lineNum">    1467 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1468"><span class="lineNum">    1468 </span>            :     }</a>
<a name="1469"><span class="lineNum">    1469 </span>            : </a>
<a name="1470"><span class="lineNum">    1470 </span>            : protected:</a>
<a name="1471"><span class="lineNum">    1471 </span>            : </a>
<a name="1472"><span class="lineNum">    1472 </span>            :     /**</a>
<a name="1473"><span class="lineNum">    1473 </span>            :      * there are no protected class members</a>
<a name="1474"><span class="lineNum">    1474 </span>            :      */</a>
<a name="1475"><span class="lineNum">    1475 </span>            : </a>
<a name="1476"><span class="lineNum">    1476 </span>            : private:</a>
<a name="1477"><span class="lineNum">    1477 </span>            : </a>
<a name="1478"><span class="lineNum">    1478 </span>            :     /**</a>
<a name="1479"><span class="lineNum">    1479 </span>            :      * Static Member Variables</a>
<a name="1480"><span class="lineNum">    1480 </span>            :      */</a>
<a name="1481"><span class="lineNum">    1481 </span>            : </a>
<a name="1482"><span class="lineNum">    1482 </span>            :     static const GeometryData msGeometryData;</a>
<a name="1483"><span class="lineNum">    1483 </span>            : </a>
<a name="1484"><span class="lineNum">    1484 </span>            :     static const GeometryDimension msGeometryDimension;</a>
<a name="1485"><span class="lineNum">    1485 </span>            : </a>
<a name="1486"><span class="lineNum">    1486 </span>            : </a>
<a name="1487"><span class="lineNum">    1487 </span>            :     ///@}</a>
<a name="1488"><span class="lineNum">    1488 </span>            :     ///@name Serialization</a>
<a name="1489"><span class="lineNum">    1489 </span>            :     ///@{</a>
<a name="1490"><span class="lineNum">    1490 </span>            : </a>
<a name="1491"><span class="lineNum">    1491 </span>            :     friend class Serializer;</a>
<a name="1492"><span class="lineNum">    1492 </span>            : </a>
<a name="1493"><span class="lineNum">    1493 </span><span class="lineNoCov">          0 :     void save( Serializer&amp; rSerializer ) const override</span></a>
<a name="1494"><span class="lineNum">    1494 </span>            :     {</a>
<a name="1495"><span class="lineNum">    1495 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_SAVE_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="1496"><span class="lineNum">    1496 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1497"><span class="lineNum">    1497 </span>            : </a>
<a name="1498"><span class="lineNum">    1498 </span><span class="lineNoCov">          0 :     void load( Serializer&amp; rSerializer ) override</span></a>
<a name="1499"><span class="lineNum">    1499 </span>            :     {</a>
<a name="1500"><span class="lineNum">    1500 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_LOAD_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="1501"><span class="lineNum">    1501 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1502"><span class="lineNum">    1502 </span>            : </a>
<a name="1503"><span class="lineNum">    1503 </span><span class="lineNoCov">          0 :     Quadrilateral2D8(): BaseType( PointsArrayType(), &amp;msGeometryData ) {}</span></a>
<a name="1504"><span class="lineNum">    1504 </span>            : </a>
<a name="1505"><span class="lineNum">    1505 </span>            :     /**</a>
<a name="1506"><span class="lineNum">    1506 </span>            :      * Private Operations</a>
<a name="1507"><span class="lineNum">    1507 </span>            :      */</a>
<a name="1508"><span class="lineNum">    1508 </span>            : </a>
<a name="1509"><span class="lineNum">    1509 </span>            :     /**</a>
<a name="1510"><span class="lineNum">    1510 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="1511"><span class="lineNum">    1511 </span>            :      */</a>
<a name="1512"><span class="lineNum">    1512 </span>            :     /**</a>
<a name="1513"><span class="lineNum">    1513 </span>            :      * Calculates the values of all shape function in all integration points.</a>
<a name="1514"><span class="lineNum">    1514 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="1515"><span class="lineNum">    1515 </span>            :      * @param ThisMethod the current integration method</a>
<a name="1516"><span class="lineNum">    1516 </span>            :      * @return the matrix of values of every shape function in each integration point</a>
<a name="1517"><span class="lineNum">    1517 </span>            :      *</a>
<a name="1518"><span class="lineNum">    1518 </span>            :      * :KLUDGE: the number of points is hard-coded -&gt; be careful when copying!</a>
<a name="1519"><span class="lineNum">    1519 </span>            :      */</a>
<a name="1520"><span class="lineNum">    1520 </span><span class="lineCov">         20 :     static Matrix CalculateShapeFunctionsIntegrationPointsValues( typename BaseType::IntegrationMethod ThisMethod )</span></a>
<a name="1521"><span class="lineNum">    1521 </span>            :     {</a>
<a name="1522"><span class="lineNum">    1522 </span><span class="lineCov">         20 :         IntegrationPointsContainerType all_integration_points = AllIntegrationPoints();</span></a>
<a name="1523"><span class="lineNum">    1523 </span><span class="lineCov">         20 :         IntegrationPointsArrayType integration_points = all_integration_points[static_cast&lt;int&gt;(ThisMethod)];</span></a>
<a name="1524"><span class="lineNum">    1524 </span>            : </a>
<a name="1525"><span class="lineNum">    1525 </span>            :         // Number of integration points</a>
<a name="1526"><span class="lineNum">    1526 </span><span class="lineCov">         20 :         const unsigned int integration_points_number = integration_points.size();</span></a>
<a name="1527"><span class="lineNum">    1527 </span>            : </a>
<a name="1528"><span class="lineNum">    1528 </span>            :         // Number of nodes in current geometry</a>
<a name="1529"><span class="lineNum">    1529 </span>            :         const unsigned int points_number = 8;</a>
<a name="1530"><span class="lineNum">    1530 </span>            : </a>
<a name="1531"><span class="lineNum">    1531 </span>            :         // Setting up return matrix</a>
<a name="1532"><span class="lineNum">    1532 </span><span class="lineCov">         20 :         Matrix shape_function_values( integration_points_number, points_number );</span></a>
<a name="1533"><span class="lineNum">    1533 </span>            : </a>
<a name="1534"><span class="lineNum">    1534 </span>            :         // Loop over all integration points</a>
<a name="1535"><span class="lineNum">    1535 </span><span class="lineCov">        240 :         for ( unsigned int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1536"><span class="lineNum">    1536 </span>            :         {</a>
<a name="1537"><span class="lineNum">    1537 </span>            :             // Primary nodes</a>
<a name="1538"><span class="lineNum">    1538 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[0] =</span></a>
<a name="1539"><span class="lineNum">    1539 </span><span class="lineCov">        220 :                 -(( 1.0 - integration_points[pnt].X() )</span></a>
<a name="1540"><span class="lineNum">    1540 </span><span class="lineCov">        220 :                   * ( 1.0 - integration_points[pnt].Y() )</span></a>
<a name="1541"><span class="lineNum">    1541 </span><span class="lineCov">        220 :                   * ( 1.0 + integration_points[pnt].X()</span></a>
<a name="1542"><span class="lineNum">    1542 </span><span class="lineCov">        220 :                       + integration_points[pnt].Y() ) ) / 4.0;</span></a>
<a name="1543"><span class="lineNum">    1543 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[1] =</span></a>
<a name="1544"><span class="lineNum">    1544 </span><span class="lineCov">        220 :                 -(( 1.0 + integration_points[pnt].X() )</span></a>
<a name="1545"><span class="lineNum">    1545 </span><span class="lineCov">        220 :                   * ( 1.0 - integration_points[pnt].Y() ) * ( 1.0</span></a>
<a name="1546"><span class="lineNum">    1546 </span><span class="lineCov">        220 :                           - integration_points[pnt].X()</span></a>
<a name="1547"><span class="lineNum">    1547 </span><span class="lineCov">        220 :                           + integration_points[pnt].Y() ) ) / 4.0;</span></a>
<a name="1548"><span class="lineNum">    1548 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[2] =</span></a>
<a name="1549"><span class="lineNum">    1549 </span><span class="lineCov">        220 :                 -(( 1.0 + integration_points[pnt].X() )</span></a>
<a name="1550"><span class="lineNum">    1550 </span><span class="lineCov">        220 :                   * ( 1.0 + integration_points[pnt].Y() ) * ( 1.0</span></a>
<a name="1551"><span class="lineNum">    1551 </span><span class="lineCov">        220 :                           - integration_points[pnt].X()</span></a>
<a name="1552"><span class="lineNum">    1552 </span><span class="lineCov">        220 :                           - integration_points[pnt].Y() ) ) / 4.0;</span></a>
<a name="1553"><span class="lineNum">    1553 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[3] =</span></a>
<a name="1554"><span class="lineNum">    1554 </span><span class="lineCov">        220 :                 -(( 1.0 - integration_points[pnt].X() ) * ( 1.0</span></a>
<a name="1555"><span class="lineNum">    1555 </span><span class="lineCov">        220 :                         + integration_points[pnt].Y() ) * ( 1.0 ) * ( 1.0</span></a>
<a name="1556"><span class="lineNum">    1556 </span><span class="lineCov">        220 :                         + integration_points[pnt].X()</span></a>
<a name="1557"><span class="lineNum">    1557 </span><span class="lineCov">        220 :                         - integration_points[pnt].Y() ) ) / 4.0;</span></a>
<a name="1558"><span class="lineNum">    1558 </span>            : </a>
<a name="1559"><span class="lineNum">    1559 </span>            :             // Secondary nodes</a>
<a name="1560"><span class="lineNum">    1560 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[4] =</span></a>
<a name="1561"><span class="lineNum">    1561 </span><span class="lineCov">        220 :                 (( 1.0 - integration_points[pnt].X()</span></a>
<a name="1562"><span class="lineNum">    1562 </span><span class="lineCov">        220 :                    * integration_points[pnt].X() )</span></a>
<a name="1563"><span class="lineNum">    1563 </span><span class="lineCov">        220 :                  * ( 1.0 - integration_points[pnt].Y() ) ) / 2.0;</span></a>
<a name="1564"><span class="lineNum">    1564 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[5] =</span></a>
<a name="1565"><span class="lineNum">    1565 </span><span class="lineCov">        220 :                 (( 1.0 + integration_points[pnt].X() )</span></a>
<a name="1566"><span class="lineNum">    1566 </span><span class="lineCov">        220 :                  * ( 1.0 - integration_points[pnt].Y()</span></a>
<a name="1567"><span class="lineNum">    1567 </span><span class="lineCov">        220 :                      * integration_points[pnt].Y() ) ) / 2.0 ;</span></a>
<a name="1568"><span class="lineNum">    1568 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[6] =</span></a>
<a name="1569"><span class="lineNum">    1569 </span><span class="lineCov">        220 :                 (( 1.0 - integration_points[pnt].X()</span></a>
<a name="1570"><span class="lineNum">    1570 </span><span class="lineCov">        220 :                    * integration_points[pnt].X() )</span></a>
<a name="1571"><span class="lineNum">    1571 </span><span class="lineCov">        220 :                  * ( 1.0 + integration_points[pnt].Y() ) ) / 2.0 ;</span></a>
<a name="1572"><span class="lineNum">    1572 </span><span class="lineCov">        220 :             row( shape_function_values, pnt )[7] =</span></a>
<a name="1573"><span class="lineNum">    1573 </span><span class="lineCov">        220 :                 (( 1.0 - integration_points[pnt].X() )</span></a>
<a name="1574"><span class="lineNum">    1574 </span><span class="lineCov">        220 :                  * ( 1.0 - integration_points[pnt].Y()</span></a>
<a name="1575"><span class="lineNum">    1575 </span><span class="lineCov">        220 :                      * integration_points[pnt].Y() ) ) / 2.0 ;</span></a>
<a name="1576"><span class="lineNum">    1576 </span>            :         }</a>
<a name="1577"><span class="lineNum">    1577 </span>            : </a>
<a name="1578"><span class="lineNum">    1578 </span><span class="lineCov">         20 :         return shape_function_values;</span></a>
<a name="1579"><span class="lineNum">    1579 </span><span class="lineCov">         20 :     }</span></a>
<a name="1580"><span class="lineNum">    1580 </span>            : </a>
<a name="1581"><span class="lineNum">    1581 </span>            :     /**</a>
<a name="1582"><span class="lineNum">    1582 </span>            :      * :TODO: implemented but not yet tested</a>
<a name="1583"><span class="lineNum">    1583 </span>            :      */</a>
<a name="1584"><span class="lineNum">    1584 </span>            :     /**</a>
<a name="1585"><span class="lineNum">    1585 </span>            :      * Calculates the local gradients of all shape functions in all integration points.</a>
<a name="1586"><span class="lineNum">    1586 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="1587"><span class="lineNum">    1587 </span>            :      *</a>
<a name="1588"><span class="lineNum">    1588 </span>            :      * @param ThisMethod the current integration method</a>
<a name="1589"><span class="lineNum">    1589 </span>            :      * @return the vector of the gradients of all shape functions in each integration</a>
<a name="1590"><span class="lineNum">    1590 </span>            :      * point</a>
<a name="1591"><span class="lineNum">    1591 </span>            :      */</a>
<a name="1592"><span class="lineNum">    1592 </span>            :     static ShapeFunctionsGradientsType</a>
<a name="1593"><span class="lineNum">    1593 </span><span class="lineCov">         20 :     CalculateShapeFunctionsIntegrationPointsLocalGradients(typename BaseType::IntegrationMethod ThisMethod )</span></a>
<a name="1594"><span class="lineNum">    1594 </span>            :     {</a>
<a name="1595"><span class="lineNum">    1595 </span><span class="lineCov">         20 :         IntegrationPointsContainerType all_integration_points = AllIntegrationPoints();</span></a>
<a name="1596"><span class="lineNum">    1596 </span><span class="lineCov">         20 :         IntegrationPointsArrayType integration_points = all_integration_points[static_cast&lt;int&gt;(ThisMethod)];</span></a>
<a name="1597"><span class="lineNum">    1597 </span>            :         // Number of integration points</a>
<a name="1598"><span class="lineNum">    1598 </span><span class="lineCov">         20 :         const unsigned int integration_points_number = integration_points.size();</span></a>
<a name="1599"><span class="lineNum">    1599 </span><span class="lineCov">         20 :         ShapeFunctionsGradientsType d_shape_f_values( integration_points_number );</span></a>
<a name="1600"><span class="lineNum">    1600 </span>            :         // Initialising container</a>
<a name="1601"><span class="lineNum">    1601 </span>            :         //std::fill(d_shape_f_values.begin(), d_shape_f_values.end(), Matrix(4,2));</a>
<a name="1602"><span class="lineNum">    1602 </span>            : </a>
<a name="1603"><span class="lineNum">    1603 </span>            :         // Loop over all integration points</a>
<a name="1604"><span class="lineNum">    1604 </span><span class="lineCov">        240 :         for ( unsigned int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1605"><span class="lineNum">    1605 </span>            :         {</a>
<a name="1606"><span class="lineNum">    1606 </span><span class="lineCov">        220 :             Matrix result = ZeroMatrix( 8, 2 );</span></a>
<a name="1607"><span class="lineNum">    1607 </span>            : </a>
<a name="1608"><span class="lineNum">    1608 </span>            :             // Primary nodes</a>
<a name="1609"><span class="lineNum">    1609 </span><span class="lineCov">        220 :             result( 0, 0 ) = - ((-1.0 + integration_points[pnt].Y())*( 2.0 * integration_points[pnt].X() + integration_points[pnt].Y())) / 4.0;</span></a>
<a name="1610"><span class="lineNum">    1610 </span><span class="lineCov">        220 :             result( 0, 1 ) = - ((-1.0 + integration_points[pnt].X())*( 2.0 * integration_points[pnt].Y() + integration_points[pnt].X())) / 4.0;</span></a>
<a name="1611"><span class="lineNum">    1611 </span>            : </a>
<a name="1612"><span class="lineNum">    1612 </span><span class="lineCov">        220 :             result( 1, 0 ) =   ((-1.0 + integration_points[pnt].Y())*(-2.0 * integration_points[pnt].X() + integration_points[pnt].Y())) / 4.0;</span></a>
<a name="1613"><span class="lineNum">    1613 </span><span class="lineCov">        220 :             result( 1, 1 ) =   (( 1.0 + integration_points[pnt].X())*( 2.0 * integration_points[pnt].Y() - integration_points[pnt].X())) / 4.0;</span></a>
<a name="1614"><span class="lineNum">    1614 </span>            : </a>
<a name="1615"><span class="lineNum">    1615 </span><span class="lineCov">        220 :             result( 2, 0 ) =   (( 1.0 + integration_points[pnt].Y())*( 2.0 * integration_points[pnt].X() + integration_points[pnt].Y())) / 4.0;</span></a>
<a name="1616"><span class="lineNum">    1616 </span><span class="lineCov">        220 :             result( 2, 1 ) =   (( 1.0 + integration_points[pnt].X())*( 2.0 * integration_points[pnt].Y() + integration_points[pnt].X())) / 4.0;</span></a>
<a name="1617"><span class="lineNum">    1617 </span>            : </a>
<a name="1618"><span class="lineNum">    1618 </span><span class="lineCov">        220 :             result( 3, 0 ) = - (( 1.0 + integration_points[pnt].Y())*(-2.0 * integration_points[pnt].X() + integration_points[pnt].Y())) / 4.0;</span></a>
<a name="1619"><span class="lineNum">    1619 </span><span class="lineCov">        220 :             result( 3, 1 ) = - ((-1.0 + integration_points[pnt].X())*( 2.0 * integration_points[pnt].Y() - integration_points[pnt].X())) / 4.0;</span></a>
<a name="1620"><span class="lineNum">    1620 </span>            : </a>
<a name="1621"><span class="lineNum">    1621 </span>            :             // Secondary nodes</a>
<a name="1622"><span class="lineNum">    1622 </span><span class="lineCov">        220 :             result( 4, 0 ) =   integration_points[pnt].X() * (-1.0 + integration_points[pnt].Y());</span></a>
<a name="1623"><span class="lineNum">    1623 </span><span class="lineCov">        220 :             result( 4, 1 ) =   ((1.0 + integration_points[pnt].X()) * (-1.0 + integration_points[pnt].X())) / 2.0;</span></a>
<a name="1624"><span class="lineNum">    1624 </span>            : </a>
<a name="1625"><span class="lineNum">    1625 </span><span class="lineCov">        220 :             result( 5, 0 ) = - ((1.0 + integration_points[pnt].Y()) * (-1.0 + integration_points[pnt].Y())) / 2.0;</span></a>
<a name="1626"><span class="lineNum">    1626 </span><span class="lineCov">        220 :             result( 5, 1 ) = - integration_points[pnt].Y() * ( 1.0 + integration_points[pnt].X());</span></a>
<a name="1627"><span class="lineNum">    1627 </span>            : </a>
<a name="1628"><span class="lineNum">    1628 </span><span class="lineCov">        220 :             result( 6, 0 ) = - integration_points[pnt].X() * ( 1.0 + integration_points[pnt].Y());</span></a>
<a name="1629"><span class="lineNum">    1629 </span><span class="lineCov">        220 :             result( 6, 1 ) = - ((1.0 + integration_points[pnt].X()) * (-1.0 + integration_points[pnt].X())) / 2.0;</span></a>
<a name="1630"><span class="lineNum">    1630 </span>            : </a>
<a name="1631"><span class="lineNum">    1631 </span><span class="lineCov">        220 :             result( 7, 0 ) =   ((1.0 + integration_points[pnt].Y()) * (-1.0 + integration_points[pnt].Y())) / 2.0;</span></a>
<a name="1632"><span class="lineNum">    1632 </span><span class="lineCov">        220 :             result( 7, 1 ) =   integration_points[pnt].Y() * (-1.0 + integration_points[pnt].X());</span></a>
<a name="1633"><span class="lineNum">    1633 </span>            : </a>
<a name="1634"><span class="lineNum">    1634 </span><span class="lineCov">        220 :             d_shape_f_values[pnt] = result;</span></a>
<a name="1635"><span class="lineNum">    1635 </span>            :         }</a>
<a name="1636"><span class="lineNum">    1636 </span>            : </a>
<a name="1637"><span class="lineNum">    1637 </span><span class="lineCov">         20 :         return d_shape_f_values;</span></a>
<a name="1638"><span class="lineNum">    1638 </span><span class="lineCov">         20 :     }</span></a>
<a name="1639"><span class="lineNum">    1639 </span>            : </a>
<a name="1640"><span class="lineNum">    1640 </span>            :     /**</a>
<a name="1641"><span class="lineNum">    1641 </span>            :      * :TODO: testing</a>
<a name="1642"><span class="lineNum">    1642 </span>            :      */</a>
<a name="1643"><span class="lineNum">    1643 </span><span class="lineCov">         44 :     static const IntegrationPointsContainerType AllIntegrationPoints()</span></a>
<a name="1644"><span class="lineNum">    1644 </span>            :     {</a>
<a name="1645"><span class="lineNum">    1645 </span><span class="lineCov">         44 :         IntegrationPointsContainerType integration_points =</span></a>
<a name="1646"><span class="lineNum">    1646 </span>            :         {</a>
<a name="1647"><span class="lineNum">    1647 </span>            :             {</a>
<a name="1648"><span class="lineNum">    1648 </span>            :                 //Quadrature&lt; QuadrilateralGaussLegendreIntegrationPointsNeu1,</a>
<a name="1649"><span class="lineNum">    1649 </span>            :                 Quadrature &lt; QuadrilateralGaussLegendreIntegrationPoints1,</a>
<a name="1650"><span class="lineNum">    1650 </span>            :                 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1651"><span class="lineNum">    1651 </span>            :                 Quadrature &lt; QuadrilateralGaussLegendreIntegrationPoints2,</a>
<a name="1652"><span class="lineNum">    1652 </span>            :                 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1653"><span class="lineNum">    1653 </span>            :                 Quadrature &lt; QuadrilateralGaussLegendreIntegrationPoints3,</a>
<a name="1654"><span class="lineNum">    1654 </span>            :                 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1655"><span class="lineNum">    1655 </span>            :                 Quadrature &lt; QuadrilateralGaussLegendreIntegrationPoints4,</a>
<a name="1656"><span class="lineNum">    1656 </span>            :                 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1657"><span class="lineNum">    1657 </span>            :                 Quadrature &lt; QuadrilateralGaussLegendreIntegrationPoints5,</a>
<a name="1658"><span class="lineNum">    1658 </span>            :                 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints()</a>
<a name="1659"><span class="lineNum">    1659 </span>            :             }</a>
<a name="1660"><span class="lineNum">    1660 </span>            :         };</a>
<a name="1661"><span class="lineNum">    1661 </span><span class="lineCov">         44 :         return integration_points;</span></a>
<a name="1662"><span class="lineNum">    1662 </span>            :     }</a>
<a name="1663"><span class="lineNum">    1663 </span>            : </a>
<a name="1664"><span class="lineNum">    1664 </span>            :     /**</a>
<a name="1665"><span class="lineNum">    1665 </span>            :      * :TODO: testing</a>
<a name="1666"><span class="lineNum">    1666 </span>            :      */</a>
<a name="1667"><span class="lineNum">    1667 </span><span class="lineCov">          4 :     static const ShapeFunctionsValuesContainerType AllShapeFunctionsValues()</span></a>
<a name="1668"><span class="lineNum">    1668 </span>            :     {</a>
<a name="1669"><span class="lineNum">    1669 </span><span class="lineCov">          4 :         ShapeFunctionsValuesContainerType shape_functions_values =</span></a>
<a name="1670"><span class="lineNum">    1670 </span>            :         {</a>
<a name="1671"><span class="lineNum">    1671 </span>            :             {</a>
<a name="1672"><span class="lineNum">    1672 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1673"><span class="lineNum">    1673 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_1 ),</a>
<a name="1674"><span class="lineNum">    1674 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1675"><span class="lineNum">    1675 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_2 ),</a>
<a name="1676"><span class="lineNum">    1676 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1677"><span class="lineNum">    1677 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_3 ),</a>
<a name="1678"><span class="lineNum">    1678 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1679"><span class="lineNum">    1679 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_4 ),</a>
<a name="1680"><span class="lineNum">    1680 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1681"><span class="lineNum">    1681 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_5 )</a>
<a name="1682"><span class="lineNum">    1682 </span>            :             }</a>
<a name="1683"><span class="lineNum">    1683 </span>            :         };</a>
<a name="1684"><span class="lineNum">    1684 </span><span class="lineCov">          4 :         return shape_functions_values;</span></a>
<a name="1685"><span class="lineNum">    1685 </span>            :     }</a>
<a name="1686"><span class="lineNum">    1686 </span>            : </a>
<a name="1687"><span class="lineNum">    1687 </span>            :     /**</a>
<a name="1688"><span class="lineNum">    1688 </span>            :      * :TODO: testing</a>
<a name="1689"><span class="lineNum">    1689 </span>            :      */</a>
<a name="1690"><span class="lineNum">    1690 </span>            :     static const ShapeFunctionsLocalGradientsContainerType</a>
<a name="1691"><span class="lineNum">    1691 </span><span class="lineCov">          4 :     AllShapeFunctionsLocalGradients()</span></a>
<a name="1692"><span class="lineNum">    1692 </span>            :     {</a>
<a name="1693"><span class="lineNum">    1693 </span><span class="lineCov">          4 :         ShapeFunctionsLocalGradientsContainerType shape_functions_local_gradients =</span></a>
<a name="1694"><span class="lineNum">    1694 </span>            :         {</a>
<a name="1695"><span class="lineNum">    1695 </span>            :             {</a>
<a name="1696"><span class="lineNum">    1696 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients(</a>
<a name="1697"><span class="lineNum">    1697 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_1 ),</a>
<a name="1698"><span class="lineNum">    1698 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients(</a>
<a name="1699"><span class="lineNum">    1699 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_2 ),</a>
<a name="1700"><span class="lineNum">    1700 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients(</a>
<a name="1701"><span class="lineNum">    1701 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_3 ),</a>
<a name="1702"><span class="lineNum">    1702 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients(</a>
<a name="1703"><span class="lineNum">    1703 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_4 ),</a>
<a name="1704"><span class="lineNum">    1704 </span>            :                 Quadrilateral2D8&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients(</a>
<a name="1705"><span class="lineNum">    1705 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_5 )</a>
<a name="1706"><span class="lineNum">    1706 </span>            :             }</a>
<a name="1707"><span class="lineNum">    1707 </span>            :         };</a>
<a name="1708"><span class="lineNum">    1708 </span><span class="lineCov">          4 :         return shape_functions_local_gradients;</span></a>
<a name="1709"><span class="lineNum">    1709 </span>            :     }</a>
<a name="1710"><span class="lineNum">    1710 </span>            : </a>
<a name="1711"><span class="lineNum">    1711 </span>            :     /**</a>
<a name="1712"><span class="lineNum">    1712 </span>            :      * Private Friends</a>
<a name="1713"><span class="lineNum">    1713 </span>            :      */</a>
<a name="1714"><span class="lineNum">    1714 </span>            : </a>
<a name="1715"><span class="lineNum">    1715 </span>            :     template&lt;class TOtherPointType&gt; friend class Quadrilateral2D8;</a>
<a name="1716"><span class="lineNum">    1716 </span>            : </a>
<a name="1717"><span class="lineNum">    1717 </span>            :     /**</a>
<a name="1718"><span class="lineNum">    1718 </span>            :      * Un accessible methods</a>
<a name="1719"><span class="lineNum">    1719 </span>            :      */</a>
<a name="1720"><span class="lineNum">    1720 </span>            : }; // Class Geometry</a>
<a name="1721"><span class="lineNum">    1721 </span>            : </a>
<a name="1722"><span class="lineNum">    1722 </span>            : /**</a>
<a name="1723"><span class="lineNum">    1723 </span>            :  * Input and output</a>
<a name="1724"><span class="lineNum">    1724 </span>            :  */</a>
<a name="1725"><span class="lineNum">    1725 </span>            : /**</a>
<a name="1726"><span class="lineNum">    1726 </span>            :  * input stream function</a>
<a name="1727"><span class="lineNum">    1727 </span>            :  */</a>
<a name="1728"><span class="lineNum">    1728 </span>            : template&lt; class TPointType &gt; inline std::istream&amp; operator &gt;&gt; (</a>
<a name="1729"><span class="lineNum">    1729 </span>            :     std::istream&amp; rIStream,</a>
<a name="1730"><span class="lineNum">    1730 </span>            :     Quadrilateral2D8&lt;TPointType&gt;&amp; rThis );</a>
<a name="1731"><span class="lineNum">    1731 </span>            : </a>
<a name="1732"><span class="lineNum">    1732 </span>            : /**</a>
<a name="1733"><span class="lineNum">    1733 </span>            :  * output stream function</a>
<a name="1734"><span class="lineNum">    1734 </span>            :  */</a>
<a name="1735"><span class="lineNum">    1735 </span><span class="lineNoCov">          0 : template&lt;class TPointType&gt; inline std::ostream&amp; operator &lt;&lt; (</span></a>
<a name="1736"><span class="lineNum">    1736 </span>            :     std::ostream&amp; rOStream,</a>
<a name="1737"><span class="lineNum">    1737 </span>            :     const Quadrilateral2D8&lt;TPointType&gt;&amp; rThis )</a>
<a name="1738"><span class="lineNum">    1738 </span>            : {</a>
<a name="1739"><span class="lineNum">    1739 </span><span class="lineNoCov">          0 :     rThis.PrintInfo( rOStream );</span></a>
<a name="1740"><span class="lineNum">    1740 </span>            :     rOStream &lt;&lt; std::endl;</a>
<a name="1741"><span class="lineNum">    1741 </span><span class="lineNoCov">          0 :     rThis.PrintData( rOStream );</span></a>
<a name="1742"><span class="lineNum">    1742 </span><span class="lineNoCov">          0 :     return rOStream;</span></a>
<a name="1743"><span class="lineNum">    1743 </span>            : }</a>
<a name="1744"><span class="lineNum">    1744 </span>            : </a>
<a name="1745"><span class="lineNum">    1745 </span>            : template&lt;class TPointType&gt;</a>
<a name="1746"><span class="lineNum">    1746 </span>            : const GeometryData Quadrilateral2D8&lt;TPointType&gt;::msGeometryData(</a>
<a name="1747"><span class="lineNum">    1747 </span>            :         &amp;msGeometryDimension,</a>
<a name="1748"><span class="lineNum">    1748 </span>            :         GeometryData::IntegrationMethod::GI_GAUSS_3,</a>
<a name="1749"><span class="lineNum">    1749 </span>            :         Quadrilateral2D8&lt;TPointType&gt;::AllIntegrationPoints(),</a>
<a name="1750"><span class="lineNum">    1750 </span>            :         Quadrilateral2D8&lt;TPointType&gt;::AllShapeFunctionsValues(),</a>
<a name="1751"><span class="lineNum">    1751 </span>            :         AllShapeFunctionsLocalGradients()</a>
<a name="1752"><span class="lineNum">    1752 </span>            : );</a>
<a name="1753"><span class="lineNum">    1753 </span>            : </a>
<a name="1754"><span class="lineNum">    1754 </span>            : template&lt;class TPointType&gt;</a>
<a name="1755"><span class="lineNum">    1755 </span>            : const GeometryDimension Quadrilateral2D8&lt;TPointType&gt;::msGeometryDimension(</a>
<a name="1756"><span class="lineNum">    1756 </span>            :     2, 2, 2);</a>
<a name="1757"><span class="lineNum">    1757 </span>            : </a>
<a name="1758"><span class="lineNum">    1758 </span>            : }  // namespace Kratos.</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
