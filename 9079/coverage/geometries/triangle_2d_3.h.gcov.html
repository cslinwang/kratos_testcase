<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - geometries/triangle_2d_3.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">geometries</a> - triangle_2d_3.h<span style="font-size: 80%;"> (source / <a href="triangle_2d_3.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">44</td>
            <td class="headerCovTableEntry">537</td>
            <td class="headerCovTableEntryLo">8.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2023-08-17 14:35:15</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntry">217</td>
            <td class="headerCovTableEntryLo">7.8 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : //    |  /           |</a>
<a name="2"><span class="lineNum">       2 </span>            : //    ' /   __| _` | __|  _ \   __|</a>
<a name="3"><span class="lineNum">       3 </span>            : //    . \  |   (   | |   (   |\__ `</a>
<a name="4"><span class="lineNum">       4 </span>            : //   _|\_\_|  \__,_|\__|\___/ ____/</a>
<a name="5"><span class="lineNum">       5 </span>            : //                   Multi-Physics</a>
<a name="6"><span class="lineNum">       6 </span>            : //</a>
<a name="7"><span class="lineNum">       7 </span>            : //  License:             BSD License</a>
<a name="8"><span class="lineNum">       8 </span>            : //                                       Kratos default license: kratos/license.txt</a>
<a name="9"><span class="lineNum">       9 </span>            : //</a>
<a name="10"><span class="lineNum">      10 </span>            : //  Main authors:    Riccardo Rossi</a>
<a name="11"><span class="lineNum">      11 </span>            : //                   Janosch Stascheit</a>
<a name="12"><span class="lineNum">      12 </span>            : //                   Felix Nagel</a>
<a name="13"><span class="lineNum">      13 </span>            : //  contributors:    Hoang Giang Bui</a>
<a name="14"><span class="lineNum">      14 </span>            : //                   Josep Maria Carbonell</a>
<a name="15"><span class="lineNum">      15 </span>            : //</a>
<a name="16"><span class="lineNum">      16 </span>            : </a>
<a name="17"><span class="lineNum">      17 </span>            : #if !defined(KRATOS_TRIANGLE_2D_3_H_INCLUDED )</a>
<a name="18"><span class="lineNum">      18 </span>            : #define  KRATOS_TRIANGLE_2D_3_H_INCLUDED</a>
<a name="19"><span class="lineNum">      19 </span>            : </a>
<a name="20"><span class="lineNum">      20 </span>            : </a>
<a name="21"><span class="lineNum">      21 </span>            : // System includes</a>
<a name="22"><span class="lineNum">      22 </span>            : </a>
<a name="23"><span class="lineNum">      23 </span>            : // External includes</a>
<a name="24"><span class="lineNum">      24 </span>            : </a>
<a name="25"><span class="lineNum">      25 </span>            : // Project includes</a>
<a name="26"><span class="lineNum">      26 </span>            : #include &quot;geometries/line_2d_2.h&quot;</a>
<a name="27"><span class="lineNum">      27 </span>            : #include &quot;integration/triangle_gauss_legendre_integration_points.h&quot;</a>
<a name="28"><span class="lineNum">      28 </span>            : #include &quot;integration/triangle_collocation_integration_points.h&quot;</a>
<a name="29"><span class="lineNum">      29 </span>            : </a>
<a name="30"><span class="lineNum">      30 </span>            : namespace Kratos</a>
<a name="31"><span class="lineNum">      31 </span>            : {</a>
<a name="32"><span class="lineNum">      32 </span>            : ///@name Kratos Globals</a>
<a name="33"><span class="lineNum">      33 </span>            : ///@{</a>
<a name="34"><span class="lineNum">      34 </span>            : </a>
<a name="35"><span class="lineNum">      35 </span>            : ///@}</a>
<a name="36"><span class="lineNum">      36 </span>            : ///@name Type Definitions</a>
<a name="37"><span class="lineNum">      37 </span>            : ///@{</a>
<a name="38"><span class="lineNum">      38 </span>            : </a>
<a name="39"><span class="lineNum">      39 </span>            : ///@}</a>
<a name="40"><span class="lineNum">      40 </span>            : ///@name  Enum's</a>
<a name="41"><span class="lineNum">      41 </span>            : ///@{</a>
<a name="42"><span class="lineNum">      42 </span>            : </a>
<a name="43"><span class="lineNum">      43 </span>            : ///@}</a>
<a name="44"><span class="lineNum">      44 </span>            : ///@name  Functions</a>
<a name="45"><span class="lineNum">      45 </span>            : ///@{</a>
<a name="46"><span class="lineNum">      46 </span>            : </a>
<a name="47"><span class="lineNum">      47 </span>            : ///@}</a>
<a name="48"><span class="lineNum">      48 </span>            : ///@name Kratos Classes</a>
<a name="49"><span class="lineNum">      49 </span>            : ///@{</a>
<a name="50"><span class="lineNum">      50 </span>            : </a>
<a name="51"><span class="lineNum">      51 </span>            : /**</a>
<a name="52"><span class="lineNum">      52 </span>            :  * @class Triangle2D3</a>
<a name="53"><span class="lineNum">      53 </span>            :  * @ingroup KratosCore</a>
<a name="54"><span class="lineNum">      54 </span>            :  * @brief A three node 2D triangle geometry with linear shape functions</a>
<a name="55"><span class="lineNum">      55 </span>            :  * @details While the shape functions are only defined in 2D it is possible to define an arbitrary orientation in space. Thus it can be used for defining surfaces on 3D elements.</a>
<a name="56"><span class="lineNum">      56 </span>            :  * The node ordering corresponds with:</a>
<a name="57"><span class="lineNum">      57 </span>            :  *      v</a>
<a name="58"><span class="lineNum">      58 </span>            :  *      ^</a>
<a name="59"><span class="lineNum">      59 </span>            :  *      |</a>
<a name="60"><span class="lineNum">      60 </span>            :  *      2</a>
<a name="61"><span class="lineNum">      61 </span>            :  *      |`\</a>
<a name="62"><span class="lineNum">      62 </span>            :  *      |  `\</a>
<a name="63"><span class="lineNum">      63 </span>            :  *      |    `\</a>
<a name="64"><span class="lineNum">      64 </span>            :  *      |      `\</a>
<a name="65"><span class="lineNum">      65 </span>            :  *      |        `\</a>
<a name="66"><span class="lineNum">      66 </span>            :  *      0----------1 --&gt; u</a>
<a name="67"><span class="lineNum">      67 </span>            :  * @author Riccardo Rossi</a>
<a name="68"><span class="lineNum">      68 </span>            :  * @author Janosch Stascheit</a>
<a name="69"><span class="lineNum">      69 </span>            :  * @author Felix Nagel</a>
<a name="70"><span class="lineNum">      70 </span>            :  */</a>
<a name="71"><span class="lineNum">      71 </span>            : template&lt;class TPointType&gt; class Triangle2D3</a>
<a name="72"><span class="lineNum">      72 </span>            :     : public Geometry&lt;TPointType&gt;</a>
<a name="73"><span class="lineNum">      73 </span>            : {</a>
<a name="74"><span class="lineNum">      74 </span>            : public:</a>
<a name="75"><span class="lineNum">      75 </span>            :     ///@}</a>
<a name="76"><span class="lineNum">      76 </span>            :     ///@name Type Definitions</a>
<a name="77"><span class="lineNum">      77 </span>            :     ///@{</a>
<a name="78"><span class="lineNum">      78 </span>            : </a>
<a name="79"><span class="lineNum">      79 </span>            :     /**</a>
<a name="80"><span class="lineNum">      80 </span>            :      * Geometry as base class.</a>
<a name="81"><span class="lineNum">      81 </span>            :      */</a>
<a name="82"><span class="lineNum">      82 </span>            :     typedef Geometry&lt;TPointType&gt; BaseType;</a>
<a name="83"><span class="lineNum">      83 </span>            : </a>
<a name="84"><span class="lineNum">      84 </span>            :     /**</a>
<a name="85"><span class="lineNum">      85 </span>            :      * Type of edge geometry</a>
<a name="86"><span class="lineNum">      86 </span>            :      */</a>
<a name="87"><span class="lineNum">      87 </span>            :     typedef Line2D2&lt;TPointType&gt; EdgeType;</a>
<a name="88"><span class="lineNum">      88 </span>            : </a>
<a name="89"><span class="lineNum">      89 </span>            :     /**</a>
<a name="90"><span class="lineNum">      90 </span>            :      * Pointer definition of Triangle2D3</a>
<a name="91"><span class="lineNum">      91 </span>            :      */</a>
<a name="92"><span class="lineNum">      92 </span>            :     KRATOS_CLASS_POINTER_DEFINITION( Triangle2D3 );</a>
<a name="93"><span class="lineNum">      93 </span>            : </a>
<a name="94"><span class="lineNum">      94 </span>            :     /**</a>
<a name="95"><span class="lineNum">      95 </span>            :      * Integration methods implemented in geometry.</a>
<a name="96"><span class="lineNum">      96 </span>            :      */</a>
<a name="97"><span class="lineNum">      97 </span>            :     typedef GeometryData::IntegrationMethod IntegrationMethod;</a>
<a name="98"><span class="lineNum">      98 </span>            : </a>
<a name="99"><span class="lineNum">      99 </span>            :     /**</a>
<a name="100"><span class="lineNum">     100 </span>            :      * A Vector of counted pointers to Geometries.</a>
<a name="101"><span class="lineNum">     101 </span>            :      * Used for returning edges of the geometry.</a>
<a name="102"><span class="lineNum">     102 </span>            :      */</a>
<a name="103"><span class="lineNum">     103 </span>            :     typedef typename BaseType::GeometriesArrayType GeometriesArrayType;</a>
<a name="104"><span class="lineNum">     104 </span>            : </a>
<a name="105"><span class="lineNum">     105 </span>            :     /**</a>
<a name="106"><span class="lineNum">     106 </span>            :      * Redefinition of template parameter TPointType.</a>
<a name="107"><span class="lineNum">     107 </span>            :      */</a>
<a name="108"><span class="lineNum">     108 </span>            :     typedef TPointType PointType;</a>
<a name="109"><span class="lineNum">     109 </span>            : </a>
<a name="110"><span class="lineNum">     110 </span>            :     /**</a>
<a name="111"><span class="lineNum">     111 </span>            :      * Type used for indexing in geometry class.</a>
<a name="112"><span class="lineNum">     112 </span>            :      * std::size_t used for indexing</a>
<a name="113"><span class="lineNum">     113 </span>            :      * point or integration point access methods and also all other</a>
<a name="114"><span class="lineNum">     114 </span>            :      * methods which need point or integration point index.</a>
<a name="115"><span class="lineNum">     115 </span>            :      */</a>
<a name="116"><span class="lineNum">     116 </span>            :     typedef typename BaseType::IndexType IndexType;</a>
<a name="117"><span class="lineNum">     117 </span>            : </a>
<a name="118"><span class="lineNum">     118 </span>            :     /**</a>
<a name="119"><span class="lineNum">     119 </span>            :      * This type is used to return size or dimension in</a>
<a name="120"><span class="lineNum">     120 </span>            :      * geometry. Dimension, WorkingDimension, PointsNumber and</a>
<a name="121"><span class="lineNum">     121 </span>            :      * ... return this type as their results.</a>
<a name="122"><span class="lineNum">     122 </span>            :      */</a>
<a name="123"><span class="lineNum">     123 </span>            :     typedef typename BaseType::SizeType SizeType;</a>
<a name="124"><span class="lineNum">     124 </span>            : </a>
<a name="125"><span class="lineNum">     125 </span>            :     /**</a>
<a name="126"><span class="lineNum">     126 </span>            :      * Array of counted pointers to point.</a>
<a name="127"><span class="lineNum">     127 </span>            :      * This type used to hold geometry's points.</a>
<a name="128"><span class="lineNum">     128 </span>            :      */</a>
<a name="129"><span class="lineNum">     129 </span>            :     typedef  typename BaseType::PointsArrayType PointsArrayType;</a>
<a name="130"><span class="lineNum">     130 </span>            : </a>
<a name="131"><span class="lineNum">     131 </span>            :     /**</a>
<a name="132"><span class="lineNum">     132 </span>            :      * Array of coordinates. Can be Nodes, Points or IntegrationPoints</a>
<a name="133"><span class="lineNum">     133 </span>            :      */</a>
<a name="134"><span class="lineNum">     134 </span>            :     typedef typename BaseType::CoordinatesArrayType CoordinatesArrayType;</a>
<a name="135"><span class="lineNum">     135 </span>            : </a>
<a name="136"><span class="lineNum">     136 </span>            :     /**</a>
<a name="137"><span class="lineNum">     137 </span>            :      * This type used for representing an integration point in geometry.</a>
<a name="138"><span class="lineNum">     138 </span>            :      * This integration point is a point with an additional weight component.</a>
<a name="139"><span class="lineNum">     139 </span>            :      */</a>
<a name="140"><span class="lineNum">     140 </span>            :     typedef typename BaseType::IntegrationPointType IntegrationPointType;</a>
<a name="141"><span class="lineNum">     141 </span>            : </a>
<a name="142"><span class="lineNum">     142 </span>            :     /**</a>
<a name="143"><span class="lineNum">     143 </span>            :      * A Vector of IntegrationPointType which used to hold</a>
<a name="144"><span class="lineNum">     144 </span>            :      * integration points related to an integration</a>
<a name="145"><span class="lineNum">     145 </span>            :      * method.</a>
<a name="146"><span class="lineNum">     146 </span>            :      * IntegrationPoints functions used this type to return</a>
<a name="147"><span class="lineNum">     147 </span>            :      * their results.</a>
<a name="148"><span class="lineNum">     148 </span>            :      */</a>
<a name="149"><span class="lineNum">     149 </span>            :     typedef typename BaseType::IntegrationPointsArrayType IntegrationPointsArrayType;</a>
<a name="150"><span class="lineNum">     150 </span>            : </a>
<a name="151"><span class="lineNum">     151 </span>            :     /**</a>
<a name="152"><span class="lineNum">     152 </span>            :      * A Vector of IntegrationPointsArrayType which used to hold</a>
<a name="153"><span class="lineNum">     153 </span>            :      * integration points related to different integration method</a>
<a name="154"><span class="lineNum">     154 </span>            :      * implemented in geometry.</a>
<a name="155"><span class="lineNum">     155 </span>            :      */</a>
<a name="156"><span class="lineNum">     156 </span>            :     typedef typename BaseType::IntegrationPointsContainerType IntegrationPointsContainerType;</a>
<a name="157"><span class="lineNum">     157 </span>            : </a>
<a name="158"><span class="lineNum">     158 </span>            :     /**</a>
<a name="159"><span class="lineNum">     159 </span>            :      * A third order tensor used as shape functions' values</a>
<a name="160"><span class="lineNum">     160 </span>            :      * container.</a>
<a name="161"><span class="lineNum">     161 </span>            :      */</a>
<a name="162"><span class="lineNum">     162 </span>            :     typedef typename BaseType::ShapeFunctionsValuesContainerType ShapeFunctionsValuesContainerType;</a>
<a name="163"><span class="lineNum">     163 </span>            : </a>
<a name="164"><span class="lineNum">     164 </span>            :     /**</a>
<a name="165"><span class="lineNum">     165 </span>            :      * A fourth order tensor used as shape functions' local</a>
<a name="166"><span class="lineNum">     166 </span>            :      * gradients container in geometry.</a>
<a name="167"><span class="lineNum">     167 </span>            :      */</a>
<a name="168"><span class="lineNum">     168 </span>            :     typedef typename BaseType::ShapeFunctionsLocalGradientsContainerType ShapeFunctionsLocalGradientsContainerType;</a>
<a name="169"><span class="lineNum">     169 </span>            : </a>
<a name="170"><span class="lineNum">     170 </span>            :     /**</a>
<a name="171"><span class="lineNum">     171 </span>            :      * A third order tensor to hold jacobian matrices evaluated at</a>
<a name="172"><span class="lineNum">     172 </span>            :      * integration points. Jacobian and InverseOfJacobian functions</a>
<a name="173"><span class="lineNum">     173 </span>            :      * return this type as their result.</a>
<a name="174"><span class="lineNum">     174 </span>            :      */</a>
<a name="175"><span class="lineNum">     175 </span>            :     typedef typename BaseType::JacobiansType JacobiansType;</a>
<a name="176"><span class="lineNum">     176 </span>            : </a>
<a name="177"><span class="lineNum">     177 </span>            :     /**</a>
<a name="178"><span class="lineNum">     178 </span>            :      * A third order tensor to hold shape functions' local</a>
<a name="179"><span class="lineNum">     179 </span>            :      * gradients. ShapefunctionsLocalGradients function return this</a>
<a name="180"><span class="lineNum">     180 </span>            :      * type as its result.</a>
<a name="181"><span class="lineNum">     181 </span>            :      */</a>
<a name="182"><span class="lineNum">     182 </span>            :     typedef typename BaseType::ShapeFunctionsGradientsType ShapeFunctionsGradientsType;</a>
<a name="183"><span class="lineNum">     183 </span>            : </a>
<a name="184"><span class="lineNum">     184 </span>            :     /**</a>
<a name="185"><span class="lineNum">     185 </span>            :      * A third order tensor to hold shape functions' local second derivatives.</a>
<a name="186"><span class="lineNum">     186 </span>            :      * ShapefunctionsLocalGradients function return this</a>
<a name="187"><span class="lineNum">     187 </span>            :      * type as its result.</a>
<a name="188"><span class="lineNum">     188 </span>            :      */</a>
<a name="189"><span class="lineNum">     189 </span>            :     typedef typename BaseType::ShapeFunctionsSecondDerivativesType</a>
<a name="190"><span class="lineNum">     190 </span>            :     ShapeFunctionsSecondDerivativesType;</a>
<a name="191"><span class="lineNum">     191 </span>            : </a>
<a name="192"><span class="lineNum">     192 </span>            :     /**</a>
<a name="193"><span class="lineNum">     193 </span>            :     * A third order tensor to hold shape functions' local third derivatives.</a>
<a name="194"><span class="lineNum">     194 </span>            :     * ShapefunctionsLocalGradients function return this</a>
<a name="195"><span class="lineNum">     195 </span>            :     * type as its result.</a>
<a name="196"><span class="lineNum">     196 </span>            :     */</a>
<a name="197"><span class="lineNum">     197 </span>            :     typedef typename BaseType::ShapeFunctionsThirdDerivativesType</a>
<a name="198"><span class="lineNum">     198 </span>            :     ShapeFunctionsThirdDerivativesType;</a>
<a name="199"><span class="lineNum">     199 </span>            : </a>
<a name="200"><span class="lineNum">     200 </span>            :     /**</a>
<a name="201"><span class="lineNum">     201 </span>            :      * Type of the normal vector used for normal to edges in geometry.</a>
<a name="202"><span class="lineNum">     202 </span>            :      */</a>
<a name="203"><span class="lineNum">     203 </span>            :     typedef typename BaseType::NormalType NormalType;</a>
<a name="204"><span class="lineNum">     204 </span>            : </a>
<a name="205"><span class="lineNum">     205 </span>            :     ///@}</a>
<a name="206"><span class="lineNum">     206 </span>            :     ///@name Life Cycle</a>
<a name="207"><span class="lineNum">     207 </span>            :     ///@{</a>
<a name="208"><span class="lineNum">     208 </span>            : </a>
<a name="209"><span class="lineNum">     209 </span>            : //     Triangle2D3( const PointType&amp; FirstPoint,</a>
<a name="210"><span class="lineNum">     210 </span>            : //                  const PointType&amp; SecondPoint,</a>
<a name="211"><span class="lineNum">     211 </span>            : //                  const PointType&amp; ThirdPoint )</a>
<a name="212"><span class="lineNum">     212 </span>            : //         : BaseType( PointsArrayType(), &amp;msGeometryData )</a>
<a name="213"><span class="lineNum">     213 </span>            : //     {</a>
<a name="214"><span class="lineNum">     214 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( FirstPoint ) ) );</a>
<a name="215"><span class="lineNum">     215 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( SecondPoint ) ) );</a>
<a name="216"><span class="lineNum">     216 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( ThirdPoint ) ) );</a>
<a name="217"><span class="lineNum">     217 </span>            : //     }</a>
<a name="218"><span class="lineNum">     218 </span>            : </a>
<a name="219"><span class="lineNum">     219 </span><span class="lineNoCov">          0 :     Triangle2D3( typename PointType::Pointer pFirstPoint,</span></a>
<a name="220"><span class="lineNum">     220 </span>            :                  typename PointType::Pointer pSecondPoint,</a>
<a name="221"><span class="lineNum">     221 </span>            :                  typename PointType::Pointer pThirdPoint )</a>
<a name="222"><span class="lineNum">     222 </span><span class="lineNoCov">          0 :         : BaseType( PointsArrayType(), &amp;msGeometryData )</span></a>
<a name="223"><span class="lineNum">     223 </span>            :     {</a>
<a name="224"><span class="lineNum">     224 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pFirstPoint );</span></a>
<a name="225"><span class="lineNum">     225 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pSecondPoint );</span></a>
<a name="226"><span class="lineNum">     226 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pThirdPoint );</span></a>
<a name="227"><span class="lineNum">     227 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="228"><span class="lineNum">     228 </span>            : </a>
<a name="229"><span class="lineNum">     229 </span><span class="lineCov">          5 :     explicit Triangle2D3( const PointsArrayType&amp; ThisPoints )</span></a>
<a name="230"><span class="lineNum">     230 </span><span class="lineCov">          5 :         : BaseType( ThisPoints, &amp;msGeometryData )</span></a>
<a name="231"><span class="lineNum">     231 </span>            :     {</a>
<a name="232"><span class="lineNum">     232 </span><span class="lineCov">          5 :         if ( this-&gt;PointsNumber() != 3 )</span></a>
<a name="233"><span class="lineNum">     233 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Invalid points number. Expected 3, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="234"><span class="lineNum">     234 </span><span class="lineCov">          5 :     }</span></a>
<a name="235"><span class="lineNum">     235 </span>            : </a>
<a name="236"><span class="lineNum">     236 </span>            :     /// Constructor with Geometry Id</a>
<a name="237"><span class="lineNum">     237 </span><span class="lineNoCov">          0 :     explicit Triangle2D3(</span></a>
<a name="238"><span class="lineNum">     238 </span>            :         const IndexType GeometryId,</a>
<a name="239"><span class="lineNum">     239 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="240"><span class="lineNum">     240 </span><span class="lineNoCov">          0 :         ) : BaseType(GeometryId, rThisPoints, &amp;msGeometryData)</span></a>
<a name="241"><span class="lineNum">     241 </span>            :     {</a>
<a name="242"><span class="lineNum">     242 </span><span class="lineNoCov">          0 :         KRATOS_ERROR_IF( this-&gt;PointsNumber() != 3 ) &lt;&lt; &quot;Invalid points number. Expected 3, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="243"><span class="lineNum">     243 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="244"><span class="lineNum">     244 </span>            : </a>
<a name="245"><span class="lineNum">     245 </span>            :     /// Constructor with Geometry Name</a>
<a name="246"><span class="lineNum">     246 </span>            :     explicit Triangle2D3(</a>
<a name="247"><span class="lineNum">     247 </span>            :         const std::string&amp; rGeometryName,</a>
<a name="248"><span class="lineNum">     248 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="249"><span class="lineNum">     249 </span>            :         ) : BaseType(rGeometryName, rThisPoints, &amp;msGeometryData)</a>
<a name="250"><span class="lineNum">     250 </span>            :     {</a>
<a name="251"><span class="lineNum">     251 </span>            :         KRATOS_ERROR_IF(this-&gt;PointsNumber() != 3) &lt;&lt; &quot;Invalid points number. Expected 3, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</a>
<a name="252"><span class="lineNum">     252 </span>            :     }</a>
<a name="253"><span class="lineNum">     253 </span>            : </a>
<a name="254"><span class="lineNum">     254 </span>            :     /**</a>
<a name="255"><span class="lineNum">     255 </span>            :      * Copy constructor.</a>
<a name="256"><span class="lineNum">     256 </span>            :      * Construct this geometry as a copy of given geometry.</a>
<a name="257"><span class="lineNum">     257 </span>            :      *</a>
<a name="258"><span class="lineNum">     258 </span>            :      * @note This copy constructor does not copy the points and new</a>
<a name="259"><span class="lineNum">     259 </span>            :      * geometry shares points with given source geometry. It is</a>
<a name="260"><span class="lineNum">     260 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="261"><span class="lineNum">     261 </span>            :      * source geometry's points too.</a>
<a name="262"><span class="lineNum">     262 </span>            :      */</a>
<a name="263"><span class="lineNum">     263 </span>            :     Triangle2D3( Triangle2D3 const&amp; rOther )</a>
<a name="264"><span class="lineNum">     264 </span>            :         : BaseType( rOther )</a>
<a name="265"><span class="lineNum">     265 </span>            :     {</a>
<a name="266"><span class="lineNum">     266 </span>            :     }</a>
<a name="267"><span class="lineNum">     267 </span>            : </a>
<a name="268"><span class="lineNum">     268 </span>            :     /**</a>
<a name="269"><span class="lineNum">     269 </span>            :      * Copy constructor from a geometry with other point type.</a>
<a name="270"><span class="lineNum">     270 </span>            :      * Construct this geometry as a copy of given geometry which</a>
<a name="271"><span class="lineNum">     271 </span>            :      * has different type of points. The given goemetry's</a>
<a name="272"><span class="lineNum">     272 </span>            :      * TOtherPointType* must be implicity convertible to this</a>
<a name="273"><span class="lineNum">     273 </span>            :      * geometry PointType.</a>
<a name="274"><span class="lineNum">     274 </span>            :      *</a>
<a name="275"><span class="lineNum">     275 </span>            :      * @note This copy constructor does not copy the points and new</a>
<a name="276"><span class="lineNum">     276 </span>            :      * geometry shares points with given source geometry. It is</a>
<a name="277"><span class="lineNum">     277 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="278"><span class="lineNum">     278 </span>            :      * source geometry's points too.</a>
<a name="279"><span class="lineNum">     279 </span>            :      */</a>
<a name="280"><span class="lineNum">     280 </span>            :     template&lt;class TOtherPointType&gt; explicit Triangle2D3( Triangle2D3&lt;TOtherPointType&gt; const&amp; rOther )</a>
<a name="281"><span class="lineNum">     281 </span>            :         : BaseType( rOther )</a>
<a name="282"><span class="lineNum">     282 </span>            :     {</a>
<a name="283"><span class="lineNum">     283 </span>            :     }</a>
<a name="284"><span class="lineNum">     284 </span>            : </a>
<a name="285"><span class="lineNum">     285 </span>            :     /**</a>
<a name="286"><span class="lineNum">     286 </span>            :      * Destructor. Does nothing!!!</a>
<a name="287"><span class="lineNum">     287 </span>            :      */</a>
<a name="288"><span class="lineNum">     288 </span><span class="lineCov">          9 :     ~Triangle2D3() override {}</span></a>
<a name="289"><span class="lineNum">     289 </span>            : </a>
<a name="290"><span class="lineNum">     290 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryFamily GetGeometryFamily() const override</span></a>
<a name="291"><span class="lineNum">     291 </span>            :     {</a>
<a name="292"><span class="lineNum">     292 </span><span class="lineNoCov">          0 :         return GeometryData::Kratos_Triangle;</span></a>
<a name="293"><span class="lineNum">     293 </span>            :     }</a>
<a name="294"><span class="lineNum">     294 </span>            : </a>
<a name="295"><span class="lineNum">     295 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryType GetGeometryType() const override</span></a>
<a name="296"><span class="lineNum">     296 </span>            :     {</a>
<a name="297"><span class="lineNum">     297 </span><span class="lineNoCov">          0 :         return GeometryData::Kratos_Triangle2D3;</span></a>
<a name="298"><span class="lineNum">     298 </span>            :     }</a>
<a name="299"><span class="lineNum">     299 </span>            : </a>
<a name="300"><span class="lineNum">     300 </span>            :     ///@}</a>
<a name="301"><span class="lineNum">     301 </span>            :     ///@name Operators</a>
<a name="302"><span class="lineNum">     302 </span>            :     ///@{</a>
<a name="303"><span class="lineNum">     303 </span>            : </a>
<a name="304"><span class="lineNum">     304 </span>            :     /**</a>
<a name="305"><span class="lineNum">     305 </span>            :      * Assignment operator.</a>
<a name="306"><span class="lineNum">     306 </span>            :      *</a>
<a name="307"><span class="lineNum">     307 </span>            :      * @note This operator don't copy the points and this</a>
<a name="308"><span class="lineNum">     308 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="309"><span class="lineNum">     309 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="310"><span class="lineNum">     310 </span>            :      * source geometry's points too.</a>
<a name="311"><span class="lineNum">     311 </span>            :      *</a>
<a name="312"><span class="lineNum">     312 </span>            :      * @see Clone</a>
<a name="313"><span class="lineNum">     313 </span>            :      * @see ClonePoints</a>
<a name="314"><span class="lineNum">     314 </span>            :      */</a>
<a name="315"><span class="lineNum">     315 </span>            :     Triangle2D3&amp; operator=( const Triangle2D3&amp; rOther )</a>
<a name="316"><span class="lineNum">     316 </span>            :     {</a>
<a name="317"><span class="lineNum">     317 </span>            :         BaseType::operator=( rOther );</a>
<a name="318"><span class="lineNum">     318 </span>            :         return *this;</a>
<a name="319"><span class="lineNum">     319 </span>            :     }</a>
<a name="320"><span class="lineNum">     320 </span>            : </a>
<a name="321"><span class="lineNum">     321 </span>            :     /**</a>
<a name="322"><span class="lineNum">     322 </span>            :      * Assignment operator for geometries with different point type.</a>
<a name="323"><span class="lineNum">     323 </span>            :      *</a>
<a name="324"><span class="lineNum">     324 </span>            :      * @note This operator don't copy the points and this</a>
<a name="325"><span class="lineNum">     325 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="326"><span class="lineNum">     326 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="327"><span class="lineNum">     327 </span>            :      * source geometry's points too.</a>
<a name="328"><span class="lineNum">     328 </span>            :      *</a>
<a name="329"><span class="lineNum">     329 </span>            :      * @see Clone</a>
<a name="330"><span class="lineNum">     330 </span>            :      * @see ClonePoints</a>
<a name="331"><span class="lineNum">     331 </span>            :      */</a>
<a name="332"><span class="lineNum">     332 </span>            :     template&lt;class TOtherPointType&gt;</a>
<a name="333"><span class="lineNum">     333 </span>            :     Triangle2D3&amp; operator=( Triangle2D3&lt;TOtherPointType&gt; const &amp; rOther )</a>
<a name="334"><span class="lineNum">     334 </span>            :     {</a>
<a name="335"><span class="lineNum">     335 </span>            :         BaseType::operator=( rOther );</a>
<a name="336"><span class="lineNum">     336 </span>            :         return *this;</a>
<a name="337"><span class="lineNum">     337 </span>            :     }</a>
<a name="338"><span class="lineNum">     338 </span>            : </a>
<a name="339"><span class="lineNum">     339 </span>            :     ///@}</a>
<a name="340"><span class="lineNum">     340 </span>            :     ///@name Operations</a>
<a name="341"><span class="lineNum">     341 </span>            :     ///@{</a>
<a name="342"><span class="lineNum">     342 </span>            : </a>
<a name="343"><span class="lineNum">     343 </span>            :     /**</a>
<a name="344"><span class="lineNum">     344 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="345"><span class="lineNum">     345 </span>            :      * @param rThisPoints the nodes of the new geometry</a>
<a name="346"><span class="lineNum">     346 </span>            :      * @return Pointer to the new geometry</a>
<a name="347"><span class="lineNum">     347 </span>            :      */</a>
<a name="348"><span class="lineNum">     348 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="349"><span class="lineNum">     349 </span>            :         PointsArrayType const&amp; rThisPoints</a>
<a name="350"><span class="lineNum">     350 </span>            :         ) const override</a>
<a name="351"><span class="lineNum">     351 </span>            :     {</a>
<a name="352"><span class="lineNum">     352 </span><span class="lineNoCov">          0 :         return typename BaseType::Pointer( new Triangle2D3( rThisPoints ) );</span></a>
<a name="353"><span class="lineNum">     353 </span>            :     }</a>
<a name="354"><span class="lineNum">     354 </span>            : </a>
<a name="355"><span class="lineNum">     355 </span>            :     /**</a>
<a name="356"><span class="lineNum">     356 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="357"><span class="lineNum">     357 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="358"><span class="lineNum">     358 </span>            :      * @param rThisPoints the nodes of the new geometry</a>
<a name="359"><span class="lineNum">     359 </span>            :      * @return Pointer to the new geometry</a>
<a name="360"><span class="lineNum">     360 </span>            :      */</a>
<a name="361"><span class="lineNum">     361 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="362"><span class="lineNum">     362 </span>            :         const IndexType NewGeometryId,</a>
<a name="363"><span class="lineNum">     363 </span>            :         PointsArrayType const&amp; rThisPoints</a>
<a name="364"><span class="lineNum">     364 </span>            :         ) const override</a>
<a name="365"><span class="lineNum">     365 </span>            :     {</a>
<a name="366"><span class="lineNum">     366 </span><span class="lineNoCov">          0 :         return typename BaseType::Pointer( new Triangle2D3( NewGeometryId, rThisPoints ) );</span></a>
<a name="367"><span class="lineNum">     367 </span>            :     }</a>
<a name="368"><span class="lineNum">     368 </span>            : </a>
<a name="369"><span class="lineNum">     369 </span>            :     /**</a>
<a name="370"><span class="lineNum">     370 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="371"><span class="lineNum">     371 </span>            :      * @param rGeometry reference to an existing geometry</a>
<a name="372"><span class="lineNum">     372 </span>            :      * @return Pointer to the new geometry</a>
<a name="373"><span class="lineNum">     373 </span>            :      */</a>
<a name="374"><span class="lineNum">     374 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="375"><span class="lineNum">     375 </span>            :         const BaseType&amp; rGeometry</a>
<a name="376"><span class="lineNum">     376 </span>            :         ) const override</a>
<a name="377"><span class="lineNum">     377 </span>            :     {</a>
<a name="378"><span class="lineNum">     378 </span><span class="lineNoCov">          0 :         auto p_geometry = typename BaseType::Pointer( new Triangle2D3( rGeometry.Points() ) );</span></a>
<a name="379"><span class="lineNum">     379 </span>            :         p_geometry-&gt;SetData(rGeometry.GetData());</a>
<a name="380"><span class="lineNum">     380 </span><span class="lineNoCov">          0 :         return p_geometry;</span></a>
<a name="381"><span class="lineNum">     381 </span>            :     }</a>
<a name="382"><span class="lineNum">     382 </span>            : </a>
<a name="383"><span class="lineNum">     383 </span>            :     /**</a>
<a name="384"><span class="lineNum">     384 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="385"><span class="lineNum">     385 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="386"><span class="lineNum">     386 </span>            :      * @param rGeometry reference to an existing geometry</a>
<a name="387"><span class="lineNum">     387 </span>            :      * @return Pointer to the new geometry</a>
<a name="388"><span class="lineNum">     388 </span>            :      */</a>
<a name="389"><span class="lineNum">     389 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="390"><span class="lineNum">     390 </span>            :         const IndexType NewGeometryId,</a>
<a name="391"><span class="lineNum">     391 </span>            :         const BaseType&amp; rGeometry</a>
<a name="392"><span class="lineNum">     392 </span>            :         ) const override</a>
<a name="393"><span class="lineNum">     393 </span>            :     {</a>
<a name="394"><span class="lineNum">     394 </span><span class="lineNoCov">          0 :         auto p_geometry = typename BaseType::Pointer( new Triangle2D3( NewGeometryId, rGeometry.Points() ) );</span></a>
<a name="395"><span class="lineNum">     395 </span>            :         p_geometry-&gt;SetData(rGeometry.GetData());</a>
<a name="396"><span class="lineNum">     396 </span><span class="lineNoCov">          0 :         return p_geometry;</span></a>
<a name="397"><span class="lineNum">     397 </span>            :     }</a>
<a name="398"><span class="lineNum">     398 </span>            : </a>
<a name="399"><span class="lineNum">     399 </span>            :     /**</a>
<a name="400"><span class="lineNum">     400 </span>            :      * returns the local coordinates of all nodes of the current geometry</a>
<a name="401"><span class="lineNum">     401 </span>            :      * @param rResult a Matrix object that will be overwritten by the result</a>
<a name="402"><span class="lineNum">     402 </span>            :      * @return the local coordinates of all nodes</a>
<a name="403"><span class="lineNum">     403 </span>            :      */</a>
<a name="404"><span class="lineNum">     404 </span><span class="lineNoCov">          0 :     Matrix&amp; PointsLocalCoordinates( Matrix&amp; rResult ) const override</span></a>
<a name="405"><span class="lineNum">     405 </span>            :     {</a>
<a name="406"><span class="lineNum">     406 </span><span class="lineNoCov">          0 :         rResult = ZeroMatrix( 3, 2 );</span></a>
<a name="407"><span class="lineNum">     407 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) =  0.0;</span></a>
<a name="408"><span class="lineNum">     408 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) =  0.0;</span></a>
<a name="409"><span class="lineNum">     409 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  1.0;</span></a>
<a name="410"><span class="lineNum">     410 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0.0;</span></a>
<a name="411"><span class="lineNum">     411 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0.0;</span></a>
<a name="412"><span class="lineNum">     412 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  1.0;</span></a>
<a name="413"><span class="lineNum">     413 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="414"><span class="lineNum">     414 </span>            :     }</a>
<a name="415"><span class="lineNum">     415 </span>            : </a>
<a name="416"><span class="lineNum">     416 </span>            :     /**</a>
<a name="417"><span class="lineNum">     417 </span>            :      * @brief Lumping factors for the calculation of the lumped mass matrix</a>
<a name="418"><span class="lineNum">     418 </span>            :      * @param rResult Vector containing the lumping factors</a>
<a name="419"><span class="lineNum">     419 </span>            :      * @param LumpingMethod The lumping method considered. The three methods available are:</a>
<a name="420"><span class="lineNum">     420 </span>            :      *      - The row sum method</a>
<a name="421"><span class="lineNum">     421 </span>            :      *      - Diagonal scaling</a>
<a name="422"><span class="lineNum">     422 </span>            :      *      - Evaluation of M using a quadrature involving only the nodal points and thus automatically yielding a diagonal matrix for standard element shape function</a>
<a name="423"><span class="lineNum">     423 </span>            :      */</a>
<a name="424"><span class="lineNum">     424 </span><span class="lineNoCov">          0 :     Vector&amp; LumpingFactors(</span></a>
<a name="425"><span class="lineNum">     425 </span>            :         Vector&amp; rResult,</a>
<a name="426"><span class="lineNum">     426 </span>            :         const typename BaseType::LumpingMethods LumpingMethod = BaseType::LumpingMethods::ROW_SUM</a>
<a name="427"><span class="lineNum">     427 </span>            :         )  const override</a>
<a name="428"><span class="lineNum">     428 </span>            :     {</a>
<a name="429"><span class="lineNum">     429 </span><span class="lineNoCov">          0 :         if(rResult.size() != 3)</span></a>
<a name="430"><span class="lineNum">     430 </span><span class="lineNoCov">          0 :             rResult.resize( 3, false );</span></a>
<a name="431"><span class="lineNum">     431 </span>            :         std::fill( rResult.begin(), rResult.end(), 1.00 / 3.00 );</a>
<a name="432"><span class="lineNum">     432 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="433"><span class="lineNum">     433 </span>            :     }</a>
<a name="434"><span class="lineNum">     434 </span>            : </a>
<a name="435"><span class="lineNum">     435 </span>            :     ///@}</a>
<a name="436"><span class="lineNum">     436 </span>            :     ///@name Information</a>
<a name="437"><span class="lineNum">     437 </span>            :     ///@{</a>
<a name="438"><span class="lineNum">     438 </span>            : </a>
<a name="439"><span class="lineNum">     439 </span>            :     /**</a>
<a name="440"><span class="lineNum">     440 </span>            :      * This method calculates and returns Length or charactereistic</a>
<a name="441"><span class="lineNum">     441 </span>            :      * length of this geometry depending on it's dimension.</a>
<a name="442"><span class="lineNum">     442 </span>            :      * For one dimensional geometry for example Line it returns</a>
<a name="443"><span class="lineNum">     443 </span>            :      * length of it and for the other geometries it gives Characteristic</a>
<a name="444"><span class="lineNum">     444 </span>            :      * length otherwise.</a>
<a name="445"><span class="lineNum">     445 </span>            :      * In the current geometry this function returns the determinant of</a>
<a name="446"><span class="lineNum">     446 </span>            :      * jacobian</a>
<a name="447"><span class="lineNum">     447 </span>            :      *</a>
<a name="448"><span class="lineNum">     448 </span>            :      * @return double value contains length or Characteristic</a>
<a name="449"><span class="lineNum">     449 </span>            :      * length</a>
<a name="450"><span class="lineNum">     450 </span>            :      * @see Area()</a>
<a name="451"><span class="lineNum">     451 </span>            :      * @see Volume()</a>
<a name="452"><span class="lineNum">     452 </span>            :      * @see DomainSize()</a>
<a name="453"><span class="lineNum">     453 </span>            :      */</a>
<a name="454"><span class="lineNum">     454 </span>            :     /**</a>
<a name="455"><span class="lineNum">     455 </span>            :      * :TODO: could be replaced by something more suitable</a>
<a name="456"><span class="lineNum">     456 </span>            :      * (comment by janosch)</a>
<a name="457"><span class="lineNum">     457 </span>            :      */</a>
<a name="458"><span class="lineNum">     458 </span><span class="lineNoCov">          0 :     double Length() const override</span></a>
<a name="459"><span class="lineNum">     459 </span>            :     {</a>
<a name="460"><span class="lineNum">     460 </span>            :         //return sqrt(fabs( DeterminantOfJacobian(PointType()))*0.5);</a>
<a name="461"><span class="lineNum">     461 </span>            :         double length = 0.000;</a>
<a name="462"><span class="lineNum">     462 </span><span class="lineNoCov">          0 :         length = 1.1283791670955 * sqrt( fabs( Area() ) );  // (4xA/Pi)^(1/2)</span></a>
<a name="463"><span class="lineNum">     463 </span><span class="lineNoCov">          0 :         return length;</span></a>
<a name="464"><span class="lineNum">     464 </span>            :     }</a>
<a name="465"><span class="lineNum">     465 </span>            : </a>
<a name="466"><span class="lineNum">     466 </span>            : </a>
<a name="467"><span class="lineNum">     467 </span>            :     /** This method calculates and returns area or surface area of</a>
<a name="468"><span class="lineNum">     468 </span>            :      * this geometry depending to it's dimension. For one dimensional</a>
<a name="469"><span class="lineNum">     469 </span>            :      * geometry it returns zero, for two dimensional it gives area</a>
<a name="470"><span class="lineNum">     470 </span>            :      * and for three dimensional geometries it gives surface area.</a>
<a name="471"><span class="lineNum">     471 </span>            :      *</a>
<a name="472"><span class="lineNum">     472 </span>            :      * @return double value contains area or surface</a>
<a name="473"><span class="lineNum">     473 </span>            :      * area.</a>
<a name="474"><span class="lineNum">     474 </span>            :      * @see Length()</a>
<a name="475"><span class="lineNum">     475 </span>            :      * @see Volume()</a>
<a name="476"><span class="lineNum">     476 </span>            :      * @see DomainSize()</a>
<a name="477"><span class="lineNum">     477 </span>            :      */</a>
<a name="478"><span class="lineNum">     478 </span>            :     /**</a>
<a name="479"><span class="lineNum">     479 </span>            :      * :TODO: could be replaced by something more suitable</a>
<a name="480"><span class="lineNum">     480 </span>            :      * (comment by janosch)</a>
<a name="481"><span class="lineNum">     481 </span>            :      */</a>
<a name="482"><span class="lineNum">     482 </span><span class="lineNoCov">          0 :     double Area() const override {</span></a>
<a name="483"><span class="lineNum">     483 </span>            :         const PointType&amp; p0 = this-&gt;operator [](0);</a>
<a name="484"><span class="lineNum">     484 </span>            :         const PointType&amp; p1 = this-&gt;operator [](1);</a>
<a name="485"><span class="lineNum">     485 </span>            :         const PointType&amp; p2 = this-&gt;operator [](2);</a>
<a name="486"><span class="lineNum">     486 </span>            : </a>
<a name="487"><span class="lineNum">     487 </span><span class="lineNoCov">          0 :         double x10 = p1.X() - p0.X();</span></a>
<a name="488"><span class="lineNum">     488 </span><span class="lineNoCov">          0 :         double y10 = p1.Y() - p0.Y();</span></a>
<a name="489"><span class="lineNum">     489 </span>            : </a>
<a name="490"><span class="lineNum">     490 </span><span class="lineNoCov">          0 :         double x20 = p2.X() - p0.X();</span></a>
<a name="491"><span class="lineNum">     491 </span><span class="lineNoCov">          0 :         double y20 = p2.Y() - p0.Y();</span></a>
<a name="492"><span class="lineNum">     492 </span>            : </a>
<a name="493"><span class="lineNum">     493 </span><span class="lineNoCov">          0 :         double detJ = x10 * y20-y10 * x20;</span></a>
<a name="494"><span class="lineNum">     494 </span><span class="lineNoCov">          0 :         return 0.5*detJ;</span></a>
<a name="495"><span class="lineNum">     495 </span>            :     }</a>
<a name="496"><span class="lineNum">     496 </span>            : </a>
<a name="497"><span class="lineNum">     497 </span>            :     /// detect if two triangle are intersected</a>
<a name="498"><span class="lineNum">     498 </span><span class="lineNoCov">          0 :     bool HasIntersection( const BaseType&amp; rThisGeometry ) override {</span></a>
<a name="499"><span class="lineNum">     499 </span>            :         const BaseType&amp; geom_1 = *this;</a>
<a name="500"><span class="lineNum">     500 </span>            :         const BaseType&amp; geom_2 = rThisGeometry;</a>
<a name="501"><span class="lineNum">     501 </span><span class="lineNoCov">          0 :         return  NoDivTriTriIsect(geom_1[0], geom_1[1], geom_1[2], geom_2[0], geom_2[1], geom_2[2]);</span></a>
<a name="502"><span class="lineNum">     502 </span>            :     }</a>
<a name="503"><span class="lineNum">     503 </span>            : </a>
<a name="504"><span class="lineNum">     504 </span>            :     /**</a>
<a name="505"><span class="lineNum">     505 </span>            :      * Check if an axis-aliged bounding box (AABB) intersects a triangle</a>
<a name="506"><span class="lineNum">     506 </span>            :      *</a>
<a name="507"><span class="lineNum">     507 </span>            :      * Based on code develop by Moller: http://fileadmin.cs.lth.se/cs/personal/tomas_akenine-moller/code/tribox3.txt</a>
<a name="508"><span class="lineNum">     508 </span>            :      * and the article &quot;A Fast Triangle-Triangle Intersection Test&quot;, SIGGRAPH '05 ACM, Art.8, 2005:</a>
<a name="509"><span class="lineNum">     509 </span>            :      * http://fileadmin.cs.lth.se/cs/personal/tomas_akenine-moller/code/tribox_tam.pdf</a>
<a name="510"><span class="lineNum">     510 </span>            :      *</a>
<a name="511"><span class="lineNum">     511 </span>            :      * @return bool if the triangle overlaps a box</a>
<a name="512"><span class="lineNum">     512 </span>            :      * @param rLowPoint first corner of the box</a>
<a name="513"><span class="lineNum">     513 </span>            :      * @param rHighPoint second corner of the box</a>
<a name="514"><span class="lineNum">     514 </span>            :      */</a>
<a name="515"><span class="lineNum">     515 </span><span class="lineNoCov">          0 :     bool HasIntersection( const Point&amp; rLowPoint, const Point&amp; rHighPoint ) override</span></a>
<a name="516"><span class="lineNum">     516 </span>            :     {</a>
<a name="517"><span class="lineNum">     517 </span>            :         Point box_center;</a>
<a name="518"><span class="lineNum">     518 </span>            :         Point box_half_size;</a>
<a name="519"><span class="lineNum">     519 </span>            : </a>
<a name="520"><span class="lineNum">     520 </span><span class="lineNoCov">          0 :         box_center[0] = 0.50 * (rLowPoint[0] + rHighPoint[0]);</span></a>
<a name="521"><span class="lineNum">     521 </span><span class="lineNoCov">          0 :         box_center[1] = 0.50 * (rLowPoint[1] + rHighPoint[1]);</span></a>
<a name="522"><span class="lineNum">     522 </span><span class="lineNoCov">          0 :         box_center[2] = 0.00;</span></a>
<a name="523"><span class="lineNum">     523 </span>            : </a>
<a name="524"><span class="lineNum">     524 </span><span class="lineNoCov">          0 :         box_half_size[0] = 0.50 * std::abs(rHighPoint[0] - rLowPoint[0]);</span></a>
<a name="525"><span class="lineNum">     525 </span><span class="lineNoCov">          0 :         box_half_size[1] = 0.50 * std::abs(rHighPoint[1] - rLowPoint[1]);</span></a>
<a name="526"><span class="lineNum">     526 </span><span class="lineNoCov">          0 :         box_half_size[2] = 0.00;</span></a>
<a name="527"><span class="lineNum">     527 </span>            : </a>
<a name="528"><span class="lineNum">     528 </span><span class="lineNoCov">          0 :         return TriBoxOverlap(box_center, box_half_size);</span></a>
<a name="529"><span class="lineNum">     529 </span>            :     }</a>
<a name="530"><span class="lineNum">     530 </span>            : </a>
<a name="531"><span class="lineNum">     531 </span>            :     /** This method calculates and returns length, area or volume of</a>
<a name="532"><span class="lineNum">     532 </span>            :      * this geometry depending to it's dimension. For one dimensional</a>
<a name="533"><span class="lineNum">     533 </span>            :      * geometry it returns its length, for two dimensional it gives area</a>
<a name="534"><span class="lineNum">     534 </span>            :      * and for three dimensional geometries it gives its volume.</a>
<a name="535"><span class="lineNum">     535 </span>            :      *</a>
<a name="536"><span class="lineNum">     536 </span>            :      * @return double value contains length, area or volume.</a>
<a name="537"><span class="lineNum">     537 </span>            :      * @see Length()</a>
<a name="538"><span class="lineNum">     538 </span>            :      * @see Area()</a>
<a name="539"><span class="lineNum">     539 </span>            :      * @see Volume()</a>
<a name="540"><span class="lineNum">     540 </span>            :      */</a>
<a name="541"><span class="lineNum">     541 </span>            :     /**</a>
<a name="542"><span class="lineNum">     542 </span>            :      * :TODO: could be replaced by something more suitable</a>
<a name="543"><span class="lineNum">     543 </span>            :      * (comment by janosch)</a>
<a name="544"><span class="lineNum">     544 </span>            :      */</a>
<a name="545"><span class="lineNum">     545 </span><span class="lineNoCov">          0 :     double DomainSize() const override {</span></a>
<a name="546"><span class="lineNum">     546 </span><span class="lineNoCov">          0 :       return this-&gt;Area();</span></a>
<a name="547"><span class="lineNum">     547 </span>            :     }</a>
<a name="548"><span class="lineNum">     548 </span>            :     /// Class Interface</a>
<a name="549"><span class="lineNum">     549 </span>            : </a>
<a name="550"><span class="lineNum">     550 </span>            :     /** This method calculates and returns the semiperimeter of the geonetry.</a>
<a name="551"><span class="lineNum">     551 </span>            :      *</a>
<a name="552"><span class="lineNum">     552 </span>            :      * @return double value with the minimum edge length</a>
<a name="553"><span class="lineNum">     553 </span>            :      */</a>
<a name="554"><span class="lineNum">     554 </span><span class="lineNoCov">          0 :     virtual double Semiperimeter() const {</span></a>
<a name="555"><span class="lineNum">     555 </span><span class="lineNoCov">          0 :       return CalculateSemiperimeter(</span></a>
<a name="556"><span class="lineNum">     556 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(0)-this-&gt;GetPoint(1)),</a>
<a name="557"><span class="lineNum">     557 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(1)-this-&gt;GetPoint(2)),</a>
<a name="558"><span class="lineNum">     558 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(2)-this-&gt;GetPoint(0))</a>
<a name="559"><span class="lineNum">     559 </span><span class="lineNoCov">          0 :       );</span></a>
<a name="560"><span class="lineNum">     560 </span>            :     }</a>
<a name="561"><span class="lineNum">     561 </span>            : </a>
<a name="562"><span class="lineNum">     562 </span>            :     /** This method calculates and returns the minimum edge</a>
<a name="563"><span class="lineNum">     563 </span>            :      * length of the geometry</a>
<a name="564"><span class="lineNum">     564 </span>            :      *</a>
<a name="565"><span class="lineNum">     565 </span>            :      * @return double value with the minimum edge length</a>
<a name="566"><span class="lineNum">     566 </span>            :      *</a>
<a name="567"><span class="lineNum">     567 </span>            :      * @see MaxEdgeLength()</a>
<a name="568"><span class="lineNum">     568 </span>            :      * @see AverageEdgeLength()</a>
<a name="569"><span class="lineNum">     569 </span>            :      */</a>
<a name="570"><span class="lineNum">     570 </span><span class="lineNoCov">          0 :     double MinEdgeLength() const override {</span></a>
<a name="571"><span class="lineNum">     571 </span><span class="lineNoCov">          0 :       auto a = this-&gt;GetPoint(0) - this-&gt;GetPoint(1);</span></a>
<a name="572"><span class="lineNum">     572 </span><span class="lineNoCov">          0 :       auto b = this-&gt;GetPoint(1) - this-&gt;GetPoint(2);</span></a>
<a name="573"><span class="lineNum">     573 </span>            :       auto c = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</a>
<a name="574"><span class="lineNum">     574 </span>            : </a>
<a name="575"><span class="lineNum">     575 </span><span class="lineNoCov">          0 :       auto sa = (a[0]*a[0])+(a[1]*a[1])+(a[2]*a[2]);</span></a>
<a name="576"><span class="lineNum">     576 </span><span class="lineNoCov">          0 :       auto sb = (b[0]*b[0])+(b[1]*b[1])+(b[2]*b[2]);</span></a>
<a name="577"><span class="lineNum">     577 </span><span class="lineNoCov">          0 :       auto sc = (c[0]*c[0])+(c[1]*c[1])+(c[2]*c[2]);</span></a>
<a name="578"><span class="lineNum">     578 </span>            : </a>
<a name="579"><span class="lineNum">     579 </span><span class="lineNoCov">          0 :       return CalculateMinEdgeLength(sa, sb, sc);</span></a>
<a name="580"><span class="lineNum">     580 </span>            :     }</a>
<a name="581"><span class="lineNum">     581 </span>            : </a>
<a name="582"><span class="lineNum">     582 </span>            :     /** This method calculates and returns the maximum edge</a>
<a name="583"><span class="lineNum">     583 </span>            :      * length of the geometry</a>
<a name="584"><span class="lineNum">     584 </span>            :      *</a>
<a name="585"><span class="lineNum">     585 </span>            :      * @return double value with the maximum edge length</a>
<a name="586"><span class="lineNum">     586 </span>            :      *</a>
<a name="587"><span class="lineNum">     587 </span>            :      * @see MinEdgeLength()</a>
<a name="588"><span class="lineNum">     588 </span>            :      * @see AverageEdgeLength()</a>
<a name="589"><span class="lineNum">     589 </span>            :      */</a>
<a name="590"><span class="lineNum">     590 </span><span class="lineNoCov">          0 :     double MaxEdgeLength() const override {</span></a>
<a name="591"><span class="lineNum">     591 </span><span class="lineNoCov">          0 :       auto a = this-&gt;GetPoint(0) - this-&gt;GetPoint(1);</span></a>
<a name="592"><span class="lineNum">     592 </span><span class="lineNoCov">          0 :       auto b = this-&gt;GetPoint(1) - this-&gt;GetPoint(2);</span></a>
<a name="593"><span class="lineNum">     593 </span>            :       auto c = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</a>
<a name="594"><span class="lineNum">     594 </span>            : </a>
<a name="595"><span class="lineNum">     595 </span><span class="lineNoCov">          0 :       auto sa = (a[0]*a[0])+(a[1]*a[1])+(a[2]*a[2]);</span></a>
<a name="596"><span class="lineNum">     596 </span><span class="lineNoCov">          0 :       auto sb = (b[0]*b[0])+(b[1]*b[1])+(b[2]*b[2]);</span></a>
<a name="597"><span class="lineNum">     597 </span><span class="lineNoCov">          0 :       auto sc = (c[0]*c[0])+(c[1]*c[1])+(c[2]*c[2]);</span></a>
<a name="598"><span class="lineNum">     598 </span>            : </a>
<a name="599"><span class="lineNum">     599 </span><span class="lineNoCov">          0 :       return CalculateMaxEdgeLength(sa, sb, sc);</span></a>
<a name="600"><span class="lineNum">     600 </span>            :     }</a>
<a name="601"><span class="lineNum">     601 </span>            : </a>
<a name="602"><span class="lineNum">     602 </span>            :     /** This method calculates and returns the average edge</a>
<a name="603"><span class="lineNum">     603 </span>            :      * length of the geometry</a>
<a name="604"><span class="lineNum">     604 </span>            :      *</a>
<a name="605"><span class="lineNum">     605 </span>            :      * @return double value with the average edge length</a>
<a name="606"><span class="lineNum">     606 </span>            :      *</a>
<a name="607"><span class="lineNum">     607 </span>            :      * @see MinEdgeLength()</a>
<a name="608"><span class="lineNum">     608 </span>            :      * @see MaxEdgeLength()</a>
<a name="609"><span class="lineNum">     609 </span>            :      */</a>
<a name="610"><span class="lineNum">     610 </span><span class="lineNoCov">          0 :     double AverageEdgeLength() const override {</span></a>
<a name="611"><span class="lineNum">     611 </span><span class="lineNoCov">          0 :       return CalculateAvgEdgeLength(</span></a>
<a name="612"><span class="lineNum">     612 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(0)-this-&gt;GetPoint(1)),</a>
<a name="613"><span class="lineNum">     613 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(1)-this-&gt;GetPoint(2)),</a>
<a name="614"><span class="lineNum">     614 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(2)-this-&gt;GetPoint(0))</a>
<a name="615"><span class="lineNum">     615 </span><span class="lineNoCov">          0 :       );</span></a>
<a name="616"><span class="lineNum">     616 </span>            :     }</a>
<a name="617"><span class="lineNum">     617 </span>            : </a>
<a name="618"><span class="lineNum">     618 </span>            :     /** Calculates the circumradius of the geometry.</a>
<a name="619"><span class="lineNum">     619 </span>            :      * Calculates the circumradius of the geometry.</a>
<a name="620"><span class="lineNum">     620 </span>            :      *</a>
<a name="621"><span class="lineNum">     621 </span>            :      * @return Circumradius of the geometry.</a>
<a name="622"><span class="lineNum">     622 </span>            :      *</a>
<a name="623"><span class="lineNum">     623 </span>            :      * @see Inradius()</a>
<a name="624"><span class="lineNum">     624 </span>            :      */</a>
<a name="625"><span class="lineNum">     625 </span><span class="lineNoCov">          0 :     double Circumradius() const override {</span></a>
<a name="626"><span class="lineNum">     626 </span><span class="lineNoCov">          0 :       return CalculateCircumradius(</span></a>
<a name="627"><span class="lineNum">     627 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(0)-this-&gt;GetPoint(1)),</a>
<a name="628"><span class="lineNum">     628 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(1)-this-&gt;GetPoint(2)),</a>
<a name="629"><span class="lineNum">     629 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(2)-this-&gt;GetPoint(0))</a>
<a name="630"><span class="lineNum">     630 </span><span class="lineNoCov">          0 :       );</span></a>
<a name="631"><span class="lineNum">     631 </span>            :     }</a>
<a name="632"><span class="lineNum">     632 </span>            : </a>
<a name="633"><span class="lineNum">     633 </span>            :     /** Calculates the inradius of the geometry.</a>
<a name="634"><span class="lineNum">     634 </span>            :      * Calculates the inradius of the geometry.</a>
<a name="635"><span class="lineNum">     635 </span>            :      *</a>
<a name="636"><span class="lineNum">     636 </span>            :      * @return Inradius of the geometry.</a>
<a name="637"><span class="lineNum">     637 </span>            :      *</a>
<a name="638"><span class="lineNum">     638 </span>            :      * @see Circumradius()</a>
<a name="639"><span class="lineNum">     639 </span>            :      */</a>
<a name="640"><span class="lineNum">     640 </span><span class="lineNoCov">          0 :     double Inradius() const override {</span></a>
<a name="641"><span class="lineNum">     641 </span><span class="lineNoCov">          0 :       return CalculateInradius(</span></a>
<a name="642"><span class="lineNum">     642 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(0)-this-&gt;GetPoint(1)),</a>
<a name="643"><span class="lineNum">     643 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(1)-this-&gt;GetPoint(2)),</a>
<a name="644"><span class="lineNum">     644 </span>            :         MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(2)-this-&gt;GetPoint(0))</a>
<a name="645"><span class="lineNum">     645 </span><span class="lineNoCov">          0 :       );</span></a>
<a name="646"><span class="lineNum">     646 </span>            :     }</a>
<a name="647"><span class="lineNum">     647 </span>            : </a>
<a name="648"><span class="lineNum">     648 </span>            :     /// Quality functions</a>
<a name="649"><span class="lineNum">     649 </span>            : </a>
<a name="650"><span class="lineNum">     650 </span>            :     /** Calculates the inradius to circumradius quality metric.</a>
<a name="651"><span class="lineNum">     651 </span>            :      * Calculates the inradius to circumradius quality metric.</a>
<a name="652"><span class="lineNum">     652 </span>            :      * This metric is bounded by the interval (0,1) being:</a>
<a name="653"><span class="lineNum">     653 </span>            :      *  1 -&gt; Optimal value</a>
<a name="654"><span class="lineNum">     654 </span>            :      *  0 -&gt; Worst value</a>
<a name="655"><span class="lineNum">     655 </span>            :      *</a>
<a name="656"><span class="lineNum">     656 </span>            :      * @formulae $$ \frac{r_K}{\rho_K} $$</a>
<a name="657"><span class="lineNum">     657 </span>            :      *</a>
<a name="658"><span class="lineNum">     658 </span>            :      * @return The inradius to circumradius quality metric.</a>
<a name="659"><span class="lineNum">     659 </span>            :      */</a>
<a name="660"><span class="lineNum">     660 </span><span class="lineNoCov">          0 :     double InradiusToCircumradiusQuality() const override {</span></a>
<a name="661"><span class="lineNum">     661 </span>            :       constexpr double normFactor = 1.0;</a>
<a name="662"><span class="lineNum">     662 </span>            : </a>
<a name="663"><span class="lineNum">     663 </span><span class="lineNoCov">          0 :       double a = MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(0)-this-&gt;GetPoint(1));</span></a>
<a name="664"><span class="lineNum">     664 </span><span class="lineNoCov">          0 :       double b = MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(1)-this-&gt;GetPoint(2));</span></a>
<a name="665"><span class="lineNum">     665 </span><span class="lineNoCov">          0 :       double c = MathUtils&lt;double&gt;::Norm3(this-&gt;GetPoint(2)-this-&gt;GetPoint(0));</span></a>
<a name="666"><span class="lineNum">     666 </span>            : </a>
<a name="667"><span class="lineNum">     667 </span><span class="lineNoCov">          0 :       return normFactor * CalculateInradius(a,b,c) / CalculateCircumradius(a,b,c);</span></a>
<a name="668"><span class="lineNum">     668 </span>            :     };</a>
<a name="669"><span class="lineNum">     669 </span>            : </a>
<a name="670"><span class="lineNum">     670 </span>            :     /** Calculates the inradius to longest edge quality metric.</a>
<a name="671"><span class="lineNum">     671 </span>            :      * Calculates the inradius to longest edge quality metric.</a>
<a name="672"><span class="lineNum">     672 </span>            :      * This metric is bounded by the interval (0,1) being:</a>
<a name="673"><span class="lineNum">     673 </span>            :      *  1 -&gt; Optimal value</a>
<a name="674"><span class="lineNum">     674 </span>            :      *  0 -&gt; Worst value</a>
<a name="675"><span class="lineNum">     675 </span>            :      *</a>
<a name="676"><span class="lineNum">     676 </span>            :      * @formulae $$ \frac{r_K}{h_{max}} $$</a>
<a name="677"><span class="lineNum">     677 </span>            :      *</a>
<a name="678"><span class="lineNum">     678 </span>            :      * @return The inradius to longest edge quality metric.</a>
<a name="679"><span class="lineNum">     679 </span>            :      */</a>
<a name="680"><span class="lineNum">     680 </span><span class="lineNoCov">          0 :     double InradiusToLongestEdgeQuality() const override {</span></a>
<a name="681"><span class="lineNum">     681 </span>            :       constexpr double normFactor = 1.0; // TODO: This normalization coeficient is not correct.</a>
<a name="682"><span class="lineNum">     682 </span>            : </a>
<a name="683"><span class="lineNum">     683 </span><span class="lineNoCov">          0 :       auto a = this-&gt;GetPoint(0) - this-&gt;GetPoint(1);</span></a>
<a name="684"><span class="lineNum">     684 </span><span class="lineNoCov">          0 :       auto b = this-&gt;GetPoint(1) - this-&gt;GetPoint(2);</span></a>
<a name="685"><span class="lineNum">     685 </span>            :       auto c = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</a>
<a name="686"><span class="lineNum">     686 </span>            : </a>
<a name="687"><span class="lineNum">     687 </span><span class="lineNoCov">          0 :       double sa = (a[0]*a[0])+(a[1]*a[1])+(a[2]*a[2]);</span></a>
<a name="688"><span class="lineNum">     688 </span><span class="lineNoCov">          0 :       double sb = (b[0]*b[0])+(b[1]*b[1])+(b[2]*b[2]);</span></a>
<a name="689"><span class="lineNum">     689 </span><span class="lineNoCov">          0 :       double sc = (c[0]*c[0])+(c[1]*c[1])+(c[2]*c[2]);</span></a>
<a name="690"><span class="lineNum">     690 </span>            : </a>
<a name="691"><span class="lineNum">     691 </span><span class="lineNoCov">          0 :       return normFactor * CalculateInradius(std::sqrt(sa),std::sqrt(sb),std::sqrt(sc)) / CalculateMaxEdgeLength(sa,sb,sc);</span></a>
<a name="692"><span class="lineNum">     692 </span>            :     }</a>
<a name="693"><span class="lineNum">     693 </span>            : </a>
<a name="694"><span class="lineNum">     694 </span>            :     /** Calculates the minimum to maximum edge length quality metric.</a>
<a name="695"><span class="lineNum">     695 </span>            :      * Calculates the minimum to maximum edge length quality metric.</a>
<a name="696"><span class="lineNum">     696 </span>            :      * This metric is bounded by the interval (0,1) being:</a>
<a name="697"><span class="lineNum">     697 </span>            :      *  1 -&gt; Optimal value</a>
<a name="698"><span class="lineNum">     698 </span>            :      *  0 -&gt; Worst value</a>
<a name="699"><span class="lineNum">     699 </span>            :      *</a>
<a name="700"><span class="lineNum">     700 </span>            :      * @formulae $$ \frac{h_{min}}{h_{max}} $$</a>
<a name="701"><span class="lineNum">     701 </span>            :      *</a>
<a name="702"><span class="lineNum">     702 </span>            :      * @return The Inradius to Circumradius Quality metric.</a>
<a name="703"><span class="lineNum">     703 </span>            :      */</a>
<a name="704"><span class="lineNum">     704 </span><span class="lineNoCov">          0 :     double AreaToEdgeLengthRatio() const override {</span></a>
<a name="705"><span class="lineNum">     705 </span>            :       constexpr double normFactor = 1.0;</a>
<a name="706"><span class="lineNum">     706 </span>            : </a>
<a name="707"><span class="lineNum">     707 </span><span class="lineNoCov">          0 :       auto a = this-&gt;GetPoint(0) - this-&gt;GetPoint(1);</span></a>
<a name="708"><span class="lineNum">     708 </span><span class="lineNoCov">          0 :       auto b = this-&gt;GetPoint(1) - this-&gt;GetPoint(2);</span></a>
<a name="709"><span class="lineNum">     709 </span>            :       auto c = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</a>
<a name="710"><span class="lineNum">     710 </span>            : </a>
<a name="711"><span class="lineNum">     711 </span><span class="lineNoCov">          0 :       double sa = (a[0]*a[0])+(a[1]*a[1])+(a[2]*a[2]);</span></a>
<a name="712"><span class="lineNum">     712 </span><span class="lineNoCov">          0 :       double sb = (b[0]*b[0])+(b[1]*b[1])+(b[2]*b[2]);</span></a>
<a name="713"><span class="lineNum">     713 </span><span class="lineNoCov">          0 :       double sc = (c[0]*c[0])+(c[1]*c[1])+(c[2]*c[2]);</span></a>
<a name="714"><span class="lineNum">     714 </span>            : </a>
<a name="715"><span class="lineNum">     715 </span><span class="lineNoCov">          0 :       return normFactor * Area() / (sa+sb+sc);</span></a>
<a name="716"><span class="lineNum">     716 </span>            :     }</a>
<a name="717"><span class="lineNum">     717 </span>            : </a>
<a name="718"><span class="lineNum">     718 </span>            :     /** Calculates the shortest altitude to edge length quality metric.</a>
<a name="719"><span class="lineNum">     719 </span>            :      * Calculates the shortest altitude to edge length quality metric.</a>
<a name="720"><span class="lineNum">     720 </span>            :      * This metric is bounded by the interval (0,1) being:</a>
<a name="721"><span class="lineNum">     721 </span>            :      *  1 -&gt; Optimal value</a>
<a name="722"><span class="lineNum">     722 </span>            :      *  0 -&gt; Worst value</a>
<a name="723"><span class="lineNum">     723 </span>            :      * -1 -&gt; Optimal value with inverted volume.</a>
<a name="724"><span class="lineNum">     724 </span>            :      *</a>
<a name="725"><span class="lineNum">     725 </span>            :      * @formulae $$ \frac{h_{min}}{h_{max}} $$</a>
<a name="726"><span class="lineNum">     726 </span>            :      *</a>
<a name="727"><span class="lineNum">     727 </span>            :      * @return The shortest altitude to edge length quality metric.</a>
<a name="728"><span class="lineNum">     728 </span>            :      */</a>
<a name="729"><span class="lineNum">     729 </span><span class="lineNoCov">          0 :     double ShortestAltitudeToEdgeLengthRatio() const override {</span></a>
<a name="730"><span class="lineNum">     730 </span>            :       constexpr double normFactor = 1.0;</a>
<a name="731"><span class="lineNum">     731 </span>            : </a>
<a name="732"><span class="lineNum">     732 </span><span class="lineNoCov">          0 :       auto a = this-&gt;GetPoint(0) - this-&gt;GetPoint(1);</span></a>
<a name="733"><span class="lineNum">     733 </span><span class="lineNoCov">          0 :       auto b = this-&gt;GetPoint(1) - this-&gt;GetPoint(2);</span></a>
<a name="734"><span class="lineNum">     734 </span>            :       auto c = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</a>
<a name="735"><span class="lineNum">     735 </span>            : </a>
<a name="736"><span class="lineNum">     736 </span><span class="lineNoCov">          0 :       double sa = (a[0]*a[0])+(a[1]*a[1])+(a[2]*a[2]);</span></a>
<a name="737"><span class="lineNum">     737 </span><span class="lineNoCov">          0 :       double sb = (b[0]*b[0])+(b[1]*b[1])+(b[2]*b[2]);</span></a>
<a name="738"><span class="lineNum">     738 </span><span class="lineNoCov">          0 :       double sc = (c[0]*c[0])+(c[1]*c[1])+(c[2]*c[2]);</span></a>
<a name="739"><span class="lineNum">     739 </span>            : </a>
<a name="740"><span class="lineNum">     740 </span>            :       // Shortest altitude is the one intersecting the largest base.</a>
<a name="741"><span class="lineNum">     741 </span><span class="lineNoCov">          0 :       double base = CalculateMaxEdgeLength(sa,sb,sc);</span></a>
<a name="742"><span class="lineNum">     742 </span>            : </a>
<a name="743"><span class="lineNum">     743 </span><span class="lineNoCov">          0 :       return normFactor * (Area() * 2 / base ) / std::sqrt(sa+sb+sc);</span></a>
<a name="744"><span class="lineNum">     744 </span>            :     }</a>
<a name="745"><span class="lineNum">     745 </span>            : </a>
<a name="746"><span class="lineNum">     746 </span>            :     /**</a>
<a name="747"><span class="lineNum">     747 </span>            :      * @brief It returns a vector that is normal to its corresponding geometry in the given local point</a>
<a name="748"><span class="lineNum">     748 </span>            :      * @param rPointLocalCoordinates Reference to the local coordinates of the point in where the normal is to be computed</a>
<a name="749"><span class="lineNum">     749 </span>            :      * @return The normal in the given point</a>
<a name="750"><span class="lineNum">     750 </span>            :      */</a>
<a name="751"><span class="lineNum">     751 </span><span class="lineNoCov">          0 :     array_1d&lt;double, 3&gt; Normal(const CoordinatesArrayType&amp; rPointLocalCoordinates) const override</span></a>
<a name="752"><span class="lineNum">     752 </span>            :     {</a>
<a name="753"><span class="lineNum">     753 </span><span class="lineNoCov">          0 :         const array_1d&lt;double, 3&gt; tangent_xi  = this-&gt;GetPoint(1) - this-&gt;GetPoint(0);</span></a>
<a name="754"><span class="lineNum">     754 </span><span class="lineNoCov">          0 :         const array_1d&lt;double, 3&gt; tangent_eta = this-&gt;GetPoint(2) - this-&gt;GetPoint(0);</span></a>
<a name="755"><span class="lineNum">     755 </span>            : </a>
<a name="756"><span class="lineNum">     756 </span>            :         array_1d&lt;double, 3&gt; normal;</a>
<a name="757"><span class="lineNum">     757 </span>            :         MathUtils&lt;double&gt;::CrossProduct(normal, tangent_xi, tangent_eta);</a>
<a name="758"><span class="lineNum">     758 </span>            : </a>
<a name="759"><span class="lineNum">     759 </span><span class="lineNoCov">          0 :         return 0.5 * normal;</span></a>
<a name="760"><span class="lineNum">     760 </span>            :     }</a>
<a name="761"><span class="lineNum">     761 </span>            : </a>
<a name="762"><span class="lineNum">     762 </span>            :     /**</a>
<a name="763"><span class="lineNum">     763 </span>            :      * Returns whether given arbitrary point is inside the Geometry and the respective</a>
<a name="764"><span class="lineNum">     764 </span>            :      * local point for the given global point</a>
<a name="765"><span class="lineNum">     765 </span>            :      * @param rPoint The point to be checked if is inside o note in global coordinates</a>
<a name="766"><span class="lineNum">     766 </span>            :      * @param rResult The local coordinates of the point</a>
<a name="767"><span class="lineNum">     767 </span>            :      * @param Tolerance The  tolerance that will be considered to check if the point is inside or not</a>
<a name="768"><span class="lineNum">     768 </span>            :      * @return True if the point is inside, false otherwise</a>
<a name="769"><span class="lineNum">     769 </span>            :      */</a>
<a name="770"><span class="lineNum">     770 </span><span class="lineNoCov">          0 :     bool IsInside(</span></a>
<a name="771"><span class="lineNum">     771 </span>            :         const CoordinatesArrayType&amp; rPoint,</a>
<a name="772"><span class="lineNum">     772 </span>            :         CoordinatesArrayType&amp; rResult,</a>
<a name="773"><span class="lineNum">     773 </span>            :         const double Tolerance = std::numeric_limits&lt;double&gt;::epsilon()</a>
<a name="774"><span class="lineNum">     774 </span>            :         ) const override</a>
<a name="775"><span class="lineNum">     775 </span>            :     {</a>
<a name="776"><span class="lineNum">     776 </span><span class="lineNoCov">          0 :         this-&gt;PointLocalCoordinates( rResult, rPoint );</span></a>
<a name="777"><span class="lineNum">     777 </span>            : </a>
<a name="778"><span class="lineNum">     778 </span><span class="lineNoCov">          0 :         if ( (rResult[0] &gt;= (0.0-Tolerance)) &amp;&amp; (rResult[0] &lt;= (1.0+Tolerance)) )</span></a>
<a name="779"><span class="lineNum">     779 </span>            :         {</a>
<a name="780"><span class="lineNum">     780 </span><span class="lineNoCov">          0 :             if ( (rResult[1] &gt;= (0.0-Tolerance)) &amp;&amp; (rResult[1] &lt;= (1.0+Tolerance)) )</span></a>
<a name="781"><span class="lineNum">     781 </span>            :             {</a>
<a name="782"><span class="lineNum">     782 </span><span class="lineNoCov">          0 :                 if ( (rResult[0] + rResult[1]) &lt;= (1.0+Tolerance) )</span></a>
<a name="783"><span class="lineNum">     783 </span>            :                 {</a>
<a name="784"><span class="lineNum">     784 </span><span class="lineNoCov">          0 :                     return true;</span></a>
<a name="785"><span class="lineNum">     785 </span>            :                 }</a>
<a name="786"><span class="lineNum">     786 </span>            :             }</a>
<a name="787"><span class="lineNum">     787 </span>            :         }</a>
<a name="788"><span class="lineNum">     788 </span>            : </a>
<a name="789"><span class="lineNum">     789 </span>            :         return false;</a>
<a name="790"><span class="lineNum">     790 </span>            :     }</a>
<a name="791"><span class="lineNum">     791 </span>            : </a>
<a name="792"><span class="lineNum">     792 </span>            :     /**</a>
<a name="793"><span class="lineNum">     793 </span>            :      * Returns the local coordinates of a given arbitrary point</a>
<a name="794"><span class="lineNum">     794 </span>            :      * The local coordinates are computed solving for xi and eta the system</a>
<a name="795"><span class="lineNum">     795 </span>            :      * given by the linear transformation:</a>
<a name="796"><span class="lineNum">     796 </span>            :      * x = (1-xi-eta)*x1 + xi*x2 + eta*x3</a>
<a name="797"><span class="lineNum">     797 </span>            :      * y = (1-xi-eta)*y1 + xi*y2 + eta*y3</a>
<a name="798"><span class="lineNum">     798 </span>            :      * @param rResult The vector containing the local coordinates of the point</a>
<a name="799"><span class="lineNum">     799 </span>            :      * @param rPoint The point in global coordinates</a>
<a name="800"><span class="lineNum">     800 </span>            :      * @return The vector containing the local coordinates of the point</a>
<a name="801"><span class="lineNum">     801 </span>            :      */</a>
<a name="802"><span class="lineNum">     802 </span><span class="lineNoCov">          0 :     CoordinatesArrayType&amp; PointLocalCoordinates(</span></a>
<a name="803"><span class="lineNum">     803 </span>            :         CoordinatesArrayType&amp; rResult,</a>
<a name="804"><span class="lineNum">     804 </span>            :         const CoordinatesArrayType&amp; rPoint</a>
<a name="805"><span class="lineNum">     805 </span>            :         ) const override {</a>
<a name="806"><span class="lineNum">     806 </span>            : </a>
<a name="807"><span class="lineNum">     807 </span>            :         rResult = ZeroVector(3);</a>
<a name="808"><span class="lineNum">     808 </span>            : </a>
<a name="809"><span class="lineNum">     809 </span>            :         const TPointType&amp; point_0 = this-&gt;GetPoint(0);</a>
<a name="810"><span class="lineNum">     810 </span>            : </a>
<a name="811"><span class="lineNum">     811 </span>            :         // Compute the Jacobian matrix and its determinant</a>
<a name="812"><span class="lineNum">     812 </span>            :         BoundedMatrix&lt;double, 2, 2&gt; J;</a>
<a name="813"><span class="lineNum">     813 </span><span class="lineNoCov">          0 :         J(0,0) = this-&gt;GetPoint(1).X() - this-&gt;GetPoint(0).X();</span></a>
<a name="814"><span class="lineNum">     814 </span><span class="lineNoCov">          0 :         J(0,1) = this-&gt;GetPoint(2).X() - this-&gt;GetPoint(0).X();</span></a>
<a name="815"><span class="lineNum">     815 </span><span class="lineNoCov">          0 :         J(1,0) = this-&gt;GetPoint(1).Y() - this-&gt;GetPoint(0).Y();</span></a>
<a name="816"><span class="lineNum">     816 </span><span class="lineNoCov">          0 :         J(1,1) = this-&gt;GetPoint(2).Y() - this-&gt;GetPoint(0).Y();</span></a>
<a name="817"><span class="lineNum">     817 </span><span class="lineNoCov">          0 :         const double det_J = J(0,0)*J(1,1) - J(0,1)*J(1,0);</span></a>
<a name="818"><span class="lineNum">     818 </span>            : </a>
<a name="819"><span class="lineNum">     819 </span>            :         // Compute eta and xi</a>
<a name="820"><span class="lineNum">     820 </span><span class="lineNoCov">          0 :         const double eta = (J(1,0)*(point_0.X() - rPoint(0)) +</span></a>
<a name="821"><span class="lineNum">     821 </span><span class="lineNoCov">          0 :                             J(0,0)*(rPoint(1) - point_0.Y())) / det_J;</span></a>
<a name="822"><span class="lineNum">     822 </span><span class="lineNoCov">          0 :         const double xi  = (J(1,1)*(rPoint(0) - point_0.X()) +</span></a>
<a name="823"><span class="lineNum">     823 </span><span class="lineNoCov">          0 :                             J(0,1)*(point_0.Y() - rPoint(1))) / det_J;</span></a>
<a name="824"><span class="lineNum">     824 </span>            : </a>
<a name="825"><span class="lineNum">     825 </span><span class="lineNoCov">          0 :         rResult(0) = xi;</span></a>
<a name="826"><span class="lineNum">     826 </span><span class="lineNoCov">          0 :         rResult(1) = eta;</span></a>
<a name="827"><span class="lineNum">     827 </span><span class="lineNoCov">          0 :         rResult(2) = 0.0;</span></a>
<a name="828"><span class="lineNum">     828 </span>            : </a>
<a name="829"><span class="lineNum">     829 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="830"><span class="lineNum">     830 </span>            :     }</a>
<a name="831"><span class="lineNum">     831 </span>            : </a>
<a name="832"><span class="lineNum">     832 </span>            :     ///@}</a>
<a name="833"><span class="lineNum">     833 </span>            :     ///@name Edge</a>
<a name="834"><span class="lineNum">     834 </span>            :     ///@{</a>
<a name="835"><span class="lineNum">     835 </span>            : </a>
<a name="836"><span class="lineNum">     836 </span>            :     /**</a>
<a name="837"><span class="lineNum">     837 </span>            :      * @brief This method gives you number of all edges of this geometry.</a>
<a name="838"><span class="lineNum">     838 </span>            :      * @details For example, for a hexahedron, this would be 12</a>
<a name="839"><span class="lineNum">     839 </span>            :      * @return SizeType containes number of this geometry edges.</a>
<a name="840"><span class="lineNum">     840 </span>            :      * @see EdgesNumber()</a>
<a name="841"><span class="lineNum">     841 </span>            :      * @see Edges()</a>
<a name="842"><span class="lineNum">     842 </span>            :      * @see GenerateEdges()</a>
<a name="843"><span class="lineNum">     843 </span>            :      * @see FacesNumber()</a>
<a name="844"><span class="lineNum">     844 </span>            :      * @see Faces()</a>
<a name="845"><span class="lineNum">     845 </span>            :      * @see GenerateFaces()</a>
<a name="846"><span class="lineNum">     846 </span>            :      */</a>
<a name="847"><span class="lineNum">     847 </span><span class="lineNoCov">          0 :     SizeType EdgesNumber() const override</span></a>
<a name="848"><span class="lineNum">     848 </span>            :     {</a>
<a name="849"><span class="lineNum">     849 </span><span class="lineNoCov">          0 :         return 3;</span></a>
<a name="850"><span class="lineNum">     850 </span>            :     }</a>
<a name="851"><span class="lineNum">     851 </span>            : </a>
<a name="852"><span class="lineNum">     852 </span>            :     /**</a>
<a name="853"><span class="lineNum">     853 </span>            :      * @brief This method gives you all edges of this geometry.</a>
<a name="854"><span class="lineNum">     854 </span>            :      * @details This method will gives you all the edges with one dimension less than this geometry.</a>
<a name="855"><span class="lineNum">     855 </span>            :      * For example a triangle would return three lines as its edges or a tetrahedral would return four triangle as its edges but won't return its six edge lines by this method.</a>
<a name="856"><span class="lineNum">     856 </span>            :      * @return GeometriesArrayType containes this geometry edges.</a>
<a name="857"><span class="lineNum">     857 </span>            :      * @see EdgesNumber()</a>
<a name="858"><span class="lineNum">     858 </span>            :      * @see Edge()</a>
<a name="859"><span class="lineNum">     859 </span>            :      */</a>
<a name="860"><span class="lineNum">     860 </span><span class="lineNoCov">          0 :     GeometriesArrayType GenerateEdges() const override</span></a>
<a name="861"><span class="lineNum">     861 </span>            :     {</a>
<a name="862"><span class="lineNum">     862 </span>            :         GeometriesArrayType edges = GeometriesArrayType();</a>
<a name="863"><span class="lineNum">     863 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 1 ), this-&gt;pGetPoint( 2 ) ) );</span></a>
<a name="864"><span class="lineNum">     864 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 2 ), this-&gt;pGetPoint( 0 ) ) );</span></a>
<a name="865"><span class="lineNum">     865 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 0 ), this-&gt;pGetPoint( 1 ) ) );</span></a>
<a name="866"><span class="lineNum">     866 </span><span class="lineNoCov">          0 :         return edges;</span></a>
<a name="867"><span class="lineNum">     867 </span>            :     }</a>
<a name="868"><span class="lineNum">     868 </span>            : </a>
<a name="869"><span class="lineNum">     869 </span><span class="lineNoCov">          0 :     SizeType FacesNumber() const override</span></a>
<a name="870"><span class="lineNum">     870 </span>            :     {</a>
<a name="871"><span class="lineNum">     871 </span><span class="lineNoCov">          0 :         return 3;</span></a>
<a name="872"><span class="lineNum">     872 </span>            :     }</a>
<a name="873"><span class="lineNum">     873 </span>            : </a>
<a name="874"><span class="lineNum">     874 </span>            :     //Connectivities of faces required</a>
<a name="875"><span class="lineNum">     875 </span><span class="lineNoCov">          0 :     void NumberNodesInFaces (DenseVector&lt;unsigned int&gt;&amp; NumberNodesInFaces) const override</span></a>
<a name="876"><span class="lineNum">     876 </span>            :     {</a>
<a name="877"><span class="lineNum">     877 </span><span class="lineNoCov">          0 :         if(NumberNodesInFaces.size() != 3 )</span></a>
<a name="878"><span class="lineNum">     878 </span><span class="lineNoCov">          0 :             NumberNodesInFaces.resize(3,false);</span></a>
<a name="879"><span class="lineNum">     879 </span>            :         // Linear Triangles have elements of 2 nodes as faces</a>
<a name="880"><span class="lineNum">     880 </span><span class="lineNoCov">          0 :         NumberNodesInFaces[0]=2;</span></a>
<a name="881"><span class="lineNum">     881 </span><span class="lineNoCov">          0 :         NumberNodesInFaces[1]=2;</span></a>
<a name="882"><span class="lineNum">     882 </span><span class="lineNoCov">          0 :         NumberNodesInFaces[2]=2;</span></a>
<a name="883"><span class="lineNum">     883 </span>            : </a>
<a name="884"><span class="lineNum">     884 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="885"><span class="lineNum">     885 </span>            : </a>
<a name="886"><span class="lineNum">     886 </span><span class="lineNoCov">          0 :     void NodesInFaces (DenseMatrix&lt;unsigned int&gt;&amp; NodesInFaces) const override</span></a>
<a name="887"><span class="lineNum">     887 </span>            :     {</a>
<a name="888"><span class="lineNum">     888 </span>            :         // faces in columns</a>
<a name="889"><span class="lineNum">     889 </span><span class="lineNoCov">          0 :         if(NodesInFaces.size1() != 3 || NodesInFaces.size2() != 3)</span></a>
<a name="890"><span class="lineNum">     890 </span><span class="lineNoCov">          0 :             NodesInFaces.resize(3,3,false);</span></a>
<a name="891"><span class="lineNum">     891 </span>            : </a>
<a name="892"><span class="lineNum">     892 </span>            :         //face 1</a>
<a name="893"><span class="lineNum">     893 </span><span class="lineNoCov">          0 :         NodesInFaces(0,0)=0;//contrary node to the face</span></a>
<a name="894"><span class="lineNum">     894 </span><span class="lineNoCov">          0 :         NodesInFaces(1,0)=1;</span></a>
<a name="895"><span class="lineNum">     895 </span><span class="lineNoCov">          0 :         NodesInFaces(2,0)=2;</span></a>
<a name="896"><span class="lineNum">     896 </span>            :         //face 2</a>
<a name="897"><span class="lineNum">     897 </span><span class="lineNoCov">          0 :         NodesInFaces(0,1)=1;//contrary node to the face</span></a>
<a name="898"><span class="lineNum">     898 </span><span class="lineNoCov">          0 :         NodesInFaces(1,1)=2;</span></a>
<a name="899"><span class="lineNum">     899 </span><span class="lineNoCov">          0 :         NodesInFaces(2,1)=0;</span></a>
<a name="900"><span class="lineNum">     900 </span>            :         //face 3</a>
<a name="901"><span class="lineNum">     901 </span><span class="lineNoCov">          0 :         NodesInFaces(0,2)=2;//contrary node to the face</span></a>
<a name="902"><span class="lineNum">     902 </span><span class="lineNoCov">          0 :         NodesInFaces(1,2)=0;</span></a>
<a name="903"><span class="lineNum">     903 </span><span class="lineNoCov">          0 :         NodesInFaces(2,2)=1;</span></a>
<a name="904"><span class="lineNum">     904 </span>            : </a>
<a name="905"><span class="lineNum">     905 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="906"><span class="lineNum">     906 </span>            : </a>
<a name="907"><span class="lineNum">     907 </span>            : </a>
<a name="908"><span class="lineNum">     908 </span>            : </a>
<a name="909"><span class="lineNum">     909 </span>            :     ///@}</a>
<a name="910"><span class="lineNum">     910 </span>            :     ///@name Shape Function</a>
<a name="911"><span class="lineNum">     911 </span>            :     ///@{</a>
<a name="912"><span class="lineNum">     912 </span>            : </a>
<a name="913"><span class="lineNum">     913 </span>            :     /**</a>
<a name="914"><span class="lineNum">     914 </span>            :      * Calculates the value of a given shape function at a given point.</a>
<a name="915"><span class="lineNum">     915 </span>            :      *</a>
<a name="916"><span class="lineNum">     916 </span>            :      * @param ShapeFunctionIndex The number of the desired shape function</a>
<a name="917"><span class="lineNum">     917 </span>            :      * @param rPoint the given point in local coordinates at which the value of the shape</a>
<a name="918"><span class="lineNum">     918 </span>            :      * function is calculated</a>
<a name="919"><span class="lineNum">     919 </span>            :      *</a>
<a name="920"><span class="lineNum">     920 </span>            :      * @return the value of the shape function at the given point</a>
<a name="921"><span class="lineNum">     921 </span>            :      */</a>
<a name="922"><span class="lineNum">     922 </span><span class="lineNoCov">          0 :     double ShapeFunctionValue( IndexType ShapeFunctionIndex,</span></a>
<a name="923"><span class="lineNum">     923 </span>            :                                        const CoordinatesArrayType&amp; rPoint ) const override</a>
<a name="924"><span class="lineNum">     924 </span>            :     {</a>
<a name="925"><span class="lineNum">     925 </span><span class="lineNoCov">          0 :         switch ( ShapeFunctionIndex )</span></a>
<a name="926"><span class="lineNum">     926 </span>            :         {</a>
<a name="927"><span class="lineNum">     927 </span>            :         case 0:</a>
<a name="928"><span class="lineNum">     928 </span><span class="lineNoCov">          0 :             return( 1.0 -rPoint[0] - rPoint[1] );</span></a>
<a name="929"><span class="lineNum">     929 </span>            :         case 1:</a>
<a name="930"><span class="lineNum">     930 </span><span class="lineNoCov">          0 :             return( rPoint[0] );</span></a>
<a name="931"><span class="lineNum">     931 </span>            :         case 2:</a>
<a name="932"><span class="lineNum">     932 </span><span class="lineNoCov">          0 :             return( rPoint[1] );</span></a>
<a name="933"><span class="lineNum">     933 </span><span class="lineNoCov">          0 :         default:</span></a>
<a name="934"><span class="lineNum">     934 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Wrong index of shape function!&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="935"><span class="lineNum">     935 </span>            :         }</a>
<a name="936"><span class="lineNum">     936 </span>            : </a>
<a name="937"><span class="lineNum">     937 </span>            :         return 0;</a>
<a name="938"><span class="lineNum">     938 </span>            :     }</a>
<a name="939"><span class="lineNum">     939 </span>            : </a>
<a name="940"><span class="lineNum">     940 </span>            :         /** This method gives all non-zero shape functions values</a>
<a name="941"><span class="lineNum">     941 </span>            :     evaluated at the rCoordinates provided</a>
<a name="942"><span class="lineNum">     942 </span>            : </a>
<a name="943"><span class="lineNum">     943 </span>            :     \note There is no control if the return vector is empty or not!</a>
<a name="944"><span class="lineNum">     944 </span>            : </a>
<a name="945"><span class="lineNum">     945 </span>            :     @return Vector of values of shape functions \f$ F_{i} \f$</a>
<a name="946"><span class="lineNum">     946 </span>            :     where i is the shape function index (for NURBS it is the index</a>
<a name="947"><span class="lineNum">     947 </span>            :     of the local enumeration in the element).</a>
<a name="948"><span class="lineNum">     948 </span>            : </a>
<a name="949"><span class="lineNum">     949 </span>            :     @see ShapeFunctionValue</a>
<a name="950"><span class="lineNum">     950 </span>            :     @see ShapeFunctionsLocalGradients</a>
<a name="951"><span class="lineNum">     951 </span>            :     @see ShapeFunctionLocalGradient</a>
<a name="952"><span class="lineNum">     952 </span>            :     */</a>
<a name="953"><span class="lineNum">     953 </span>            : </a>
<a name="954"><span class="lineNum">     954 </span><span class="lineNoCov">          0 :     Vector&amp; ShapeFunctionsValues (Vector &amp;rResult, const CoordinatesArrayType&amp; rCoordinates) const override</span></a>
<a name="955"><span class="lineNum">     955 </span>            :     {</a>
<a name="956"><span class="lineNum">     956 </span><span class="lineNoCov">          0 :       if(rResult.size() != 3) rResult.resize(3,false);</span></a>
<a name="957"><span class="lineNum">     957 </span><span class="lineNoCov">          0 :       rResult[0] =  1.0 -rCoordinates[0] - rCoordinates[1];</span></a>
<a name="958"><span class="lineNum">     958 </span><span class="lineNoCov">          0 :       rResult[1] =  rCoordinates[0] ;</span></a>
<a name="959"><span class="lineNum">     959 </span><span class="lineNoCov">          0 :       rResult[2] =  rCoordinates[1] ;</span></a>
<a name="960"><span class="lineNum">     960 </span>            : </a>
<a name="961"><span class="lineNum">     961 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="962"><span class="lineNum">     962 </span>            :     }</a>
<a name="963"><span class="lineNum">     963 </span>            : </a>
<a name="964"><span class="lineNum">     964 </span>            : </a>
<a name="965"><span class="lineNum">     965 </span>            :     /**</a>
<a name="966"><span class="lineNum">     966 </span>            :      * Calculates the Gradients of the shape functions.</a>
<a name="967"><span class="lineNum">     967 </span>            :      * Calculates the gradients of the shape functions with regard to</a>
<a name="968"><span class="lineNum">     968 </span>            :      * the global coordinates in all</a>
<a name="969"><span class="lineNum">     969 </span>            :      * integration points (\f$ \frac{\partial N^i}{\partial X_j} \f$)</a>
<a name="970"><span class="lineNum">     970 </span>            :      *</a>
<a name="971"><span class="lineNum">     971 </span>            :      * @param rResult a container which takes the calculated gradients</a>
<a name="972"><span class="lineNum">     972 </span>            :      * @param ThisMethod the given IntegrationMethod</a>
<a name="973"><span class="lineNum">     973 </span>            :      *</a>
<a name="974"><span class="lineNum">     974 </span>            :      * @return the gradients of all shape functions with regard to the global coordinates</a>
<a name="975"><span class="lineNum">     975 </span>            : </a>
<a name="976"><span class="lineNum">     976 </span>            :     */</a>
<a name="977"><span class="lineNum">     977 </span><span class="lineNoCov">          0 :     ShapeFunctionsGradientsType&amp; ShapeFunctionsIntegrationPointsGradients(</span></a>
<a name="978"><span class="lineNum">     978 </span>            :         ShapeFunctionsGradientsType&amp; rResult,</a>
<a name="979"><span class="lineNum">     979 </span>            :         IntegrationMethod ThisMethod ) const override</a>
<a name="980"><span class="lineNum">     980 </span>            :     {</a>
<a name="981"><span class="lineNum">     981 </span><span class="lineNoCov">          0 :         const unsigned int integration_points_number =</span></a>
<a name="982"><span class="lineNum">     982 </span>            :             msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="983"><span class="lineNum">     983 </span>            : </a>
<a name="984"><span class="lineNum">     984 </span>            :         BoundedMatrix&lt;double,3,2&gt; DN_DX;</a>
<a name="985"><span class="lineNum">     985 </span><span class="lineNoCov">          0 :         double x10 = this-&gt;Points()[1].X() - this-&gt;Points()[0].X();</span></a>
<a name="986"><span class="lineNum">     986 </span><span class="lineNoCov">          0 :         double y10 = this-&gt;Points()[1].Y() - this-&gt;Points()[0].Y();</span></a>
<a name="987"><span class="lineNum">     987 </span>            : </a>
<a name="988"><span class="lineNum">     988 </span><span class="lineNoCov">          0 :         double x20 = this-&gt;Points()[2].X() - this-&gt;Points()[0].X();</span></a>
<a name="989"><span class="lineNum">     989 </span><span class="lineNoCov">          0 :         double y20 = this-&gt;Points()[2].Y() - this-&gt;Points()[0].Y();</span></a>
<a name="990"><span class="lineNum">     990 </span>            : </a>
<a name="991"><span class="lineNum">     991 </span>            :         //Jacobian is calculated:</a>
<a name="992"><span class="lineNum">     992 </span>            :         //  |dx/dxi  dx/deta|   |x1-x0   x2-x0|</a>
<a name="993"><span class="lineNum">     993 </span>            :         //J=|                           |=      |                         |</a>
<a name="994"><span class="lineNum">     994 </span>            :         //  |dy/dxi  dy/deta|   |y1-y0   y2-y0|</a>
<a name="995"><span class="lineNum">     995 </span>            : </a>
<a name="996"><span class="lineNum">     996 </span>            : </a>
<a name="997"><span class="lineNum">     997 </span><span class="lineNoCov">          0 :         double detJ = x10 * y20-y10 * x20;</span></a>
<a name="998"><span class="lineNum">     998 </span>            : </a>
<a name="999"><span class="lineNum">     999 </span><span class="lineNoCov">          0 :         DN_DX(0,0) = -y20 + y10;</span></a>
<a name="1000"><span class="lineNum">    1000 </span><span class="lineNoCov">          0 :         DN_DX(0,1) =  x20 - x10;</span></a>
<a name="1001"><span class="lineNum">    1001 </span><span class="lineNoCov">          0 :         DN_DX(1,0) =  y20;</span></a>
<a name="1002"><span class="lineNum">    1002 </span><span class="lineNoCov">          0 :         DN_DX(1,1) = -x20;</span></a>
<a name="1003"><span class="lineNum">    1003 </span><span class="lineNoCov">          0 :         DN_DX(2,0) = -y10;</span></a>
<a name="1004"><span class="lineNum">    1004 </span><span class="lineNoCov">          0 :         DN_DX(2,1) =  x10;</span></a>
<a name="1005"><span class="lineNum">    1005 </span>            : </a>
<a name="1006"><span class="lineNum">    1006 </span>            :         DN_DX /= detJ;</a>
<a name="1007"><span class="lineNum">    1007 </span>            : </a>
<a name="1008"><span class="lineNum">    1008 </span>            :         //workaround by riccardo</a>
<a name="1009"><span class="lineNum">    1009 </span><span class="lineNoCov">          0 :         if(rResult.size() != integration_points_number)</span></a>
<a name="1010"><span class="lineNum">    1010 </span>            :         {</a>
<a name="1011"><span class="lineNum">    1011 </span><span class="lineNoCov">          0 :             rResult.resize(integration_points_number,false);</span></a>
<a name="1012"><span class="lineNum">    1012 </span>            :         }</a>
<a name="1013"><span class="lineNum">    1013 </span><span class="lineNoCov">          0 :         for(unsigned int i=0; i&lt;integration_points_number; i++)</span></a>
<a name="1014"><span class="lineNum">    1014 </span><span class="lineNoCov">          0 :             rResult[i] = DN_DX;</span></a>
<a name="1015"><span class="lineNum">    1015 </span>            : </a>
<a name="1016"><span class="lineNum">    1016 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1017"><span class="lineNum">    1017 </span>            :     }</a>
<a name="1018"><span class="lineNum">    1018 </span>            : </a>
<a name="1019"><span class="lineNum">    1019 </span><span class="lineNoCov">          0 :     ShapeFunctionsGradientsType&amp; ShapeFunctionsIntegrationPointsGradients(</span></a>
<a name="1020"><span class="lineNum">    1020 </span>            :         ShapeFunctionsGradientsType&amp; rResult,</a>
<a name="1021"><span class="lineNum">    1021 </span>            :         Vector&amp; determinants_of_jacobian,</a>
<a name="1022"><span class="lineNum">    1022 </span>            :         IntegrationMethod ThisMethod ) const override</a>
<a name="1023"><span class="lineNum">    1023 </span>            :     {</a>
<a name="1024"><span class="lineNum">    1024 </span><span class="lineNoCov">          0 :         const unsigned int integration_points_number =</span></a>
<a name="1025"><span class="lineNum">    1025 </span>            :             msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1026"><span class="lineNum">    1026 </span>            : </a>
<a name="1027"><span class="lineNum">    1027 </span>            :         BoundedMatrix&lt;double,3,2&gt; DN_DX;</a>
<a name="1028"><span class="lineNum">    1028 </span><span class="lineNoCov">          0 :         double x10 = this-&gt;Points()[1].X() - this-&gt;Points()[0].X();</span></a>
<a name="1029"><span class="lineNum">    1029 </span><span class="lineNoCov">          0 :         double y10 = this-&gt;Points()[1].Y() - this-&gt;Points()[0].Y();</span></a>
<a name="1030"><span class="lineNum">    1030 </span>            : </a>
<a name="1031"><span class="lineNum">    1031 </span><span class="lineNoCov">          0 :         double x20 = this-&gt;Points()[2].X() - this-&gt;Points()[0].X();</span></a>
<a name="1032"><span class="lineNum">    1032 </span><span class="lineNoCov">          0 :         double y20 = this-&gt;Points()[2].Y() - this-&gt;Points()[0].Y();</span></a>
<a name="1033"><span class="lineNum">    1033 </span>            : </a>
<a name="1034"><span class="lineNum">    1034 </span>            :         //Jacobian is calculated:</a>
<a name="1035"><span class="lineNum">    1035 </span>            :         //  |dx/dxi  dx/deta|   |x1-x0   x2-x0|</a>
<a name="1036"><span class="lineNum">    1036 </span>            :         //J=|                           |=      |                         |</a>
<a name="1037"><span class="lineNum">    1037 </span>            :         //  |dy/dxi  dy/deta|   |y1-y0   y2-y0|</a>
<a name="1038"><span class="lineNum">    1038 </span>            : </a>
<a name="1039"><span class="lineNum">    1039 </span>            : </a>
<a name="1040"><span class="lineNum">    1040 </span><span class="lineNoCov">          0 :         double detJ = x10 * y20-y10 * x20;</span></a>
<a name="1041"><span class="lineNum">    1041 </span>            : </a>
<a name="1042"><span class="lineNum">    1042 </span><span class="lineNoCov">          0 :         DN_DX(0,0) = -y20 + y10;</span></a>
<a name="1043"><span class="lineNum">    1043 </span><span class="lineNoCov">          0 :         DN_DX(0,1) =  x20 - x10;</span></a>
<a name="1044"><span class="lineNum">    1044 </span><span class="lineNoCov">          0 :         DN_DX(1,0) =  y20;</span></a>
<a name="1045"><span class="lineNum">    1045 </span><span class="lineNoCov">          0 :         DN_DX(1,1) = -x20;</span></a>
<a name="1046"><span class="lineNum">    1046 </span><span class="lineNoCov">          0 :         DN_DX(2,0) = -y10;</span></a>
<a name="1047"><span class="lineNum">    1047 </span><span class="lineNoCov">          0 :         DN_DX(2,1) =  x10;</span></a>
<a name="1048"><span class="lineNum">    1048 </span>            : </a>
<a name="1049"><span class="lineNum">    1049 </span>            :         DN_DX /= detJ;</a>
<a name="1050"><span class="lineNum">    1050 </span>            : </a>
<a name="1051"><span class="lineNum">    1051 </span>            :         //workaround by riccardo</a>
<a name="1052"><span class="lineNum">    1052 </span><span class="lineNoCov">          0 :         if(rResult.size() != integration_points_number)</span></a>
<a name="1053"><span class="lineNum">    1053 </span>            :         {</a>
<a name="1054"><span class="lineNum">    1054 </span><span class="lineNoCov">          0 :             rResult.resize(integration_points_number,false);</span></a>
<a name="1055"><span class="lineNum">    1055 </span>            :         }</a>
<a name="1056"><span class="lineNum">    1056 </span><span class="lineNoCov">          0 :         for(unsigned int i=0; i&lt;integration_points_number; i++)</span></a>
<a name="1057"><span class="lineNum">    1057 </span><span class="lineNoCov">          0 :             rResult[i] = DN_DX;</span></a>
<a name="1058"><span class="lineNum">    1058 </span>            : </a>
<a name="1059"><span class="lineNum">    1059 </span><span class="lineNoCov">          0 :         if(determinants_of_jacobian.size() != integration_points_number )</span></a>
<a name="1060"><span class="lineNum">    1060 </span><span class="lineNoCov">          0 :             determinants_of_jacobian.resize(integration_points_number,false);</span></a>
<a name="1061"><span class="lineNum">    1061 </span>            : </a>
<a name="1062"><span class="lineNum">    1062 </span><span class="lineNoCov">          0 :         for(unsigned int i=0; i&lt;integration_points_number; i++)</span></a>
<a name="1063"><span class="lineNum">    1063 </span><span class="lineNoCov">          0 :             determinants_of_jacobian[i] = detJ;</span></a>
<a name="1064"><span class="lineNum">    1064 </span>            : </a>
<a name="1065"><span class="lineNum">    1065 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1066"><span class="lineNum">    1066 </span>            :     }</a>
<a name="1067"><span class="lineNum">    1067 </span>            : </a>
<a name="1068"><span class="lineNum">    1068 </span>            :     /**</a>
<a name="1069"><span class="lineNum">    1069 </span>            :      * Determinant of jacobians for given integration method.</a>
<a name="1070"><span class="lineNum">    1070 </span>            :      * This method calculates determinant of jacobian in all</a>
<a name="1071"><span class="lineNum">    1071 </span>            :      * integrations points of given integration method.</a>
<a name="1072"><span class="lineNum">    1072 </span>            :      *</a>
<a name="1073"><span class="lineNum">    1073 </span>            :      * @return Vector of double which is vector of determinants of</a>
<a name="1074"><span class="lineNum">    1074 </span>            :      * jacobians \f$ |J|_i \f$ where \f$ i=1,2,...,n \f$ is the</a>
<a name="1075"><span class="lineNum">    1075 </span>            :      * integration point index of given integration method.</a>
<a name="1076"><span class="lineNum">    1076 </span>            :      *</a>
<a name="1077"><span class="lineNum">    1077 </span>            :      * @see Jacobian</a>
<a name="1078"><span class="lineNum">    1078 </span>            :      * @see InverseOfJacobian</a>
<a name="1079"><span class="lineNum">    1079 </span>            :      */</a>
<a name="1080"><span class="lineNum">    1080 </span><span class="lineNoCov">          0 :     Vector&amp; DeterminantOfJacobian( Vector&amp; rResult,</span></a>
<a name="1081"><span class="lineNum">    1081 </span>            :                                            IntegrationMethod ThisMethod ) const override</a>
<a name="1082"><span class="lineNum">    1082 </span>            :     {</a>
<a name="1083"><span class="lineNum">    1083 </span><span class="lineNoCov">          0 :         const unsigned int integration_points_number = msGeometryData.IntegrationPointsNumber( ThisMethod );</span></a>
<a name="1084"><span class="lineNum">    1084 </span><span class="lineNoCov">          0 :         if(rResult.size() != integration_points_number)</span></a>
<a name="1085"><span class="lineNum">    1085 </span>            :         {</a>
<a name="1086"><span class="lineNum">    1086 </span><span class="lineNoCov">          0 :             rResult.resize(integration_points_number,false);</span></a>
<a name="1087"><span class="lineNum">    1087 </span>            :         }</a>
<a name="1088"><span class="lineNum">    1088 </span>            : </a>
<a name="1089"><span class="lineNum">    1089 </span><span class="lineNoCov">          0 :         const double detJ = 2.0*(this-&gt;Area());</span></a>
<a name="1090"><span class="lineNum">    1090 </span>            : </a>
<a name="1091"><span class="lineNum">    1091 </span><span class="lineNoCov">          0 :         for ( unsigned int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1092"><span class="lineNum">    1092 </span>            :         {</a>
<a name="1093"><span class="lineNum">    1093 </span><span class="lineNoCov">          0 :             rResult[pnt] = detJ;</span></a>
<a name="1094"><span class="lineNum">    1094 </span>            :         }</a>
<a name="1095"><span class="lineNum">    1095 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1096"><span class="lineNum">    1096 </span>            :     }</a>
<a name="1097"><span class="lineNum">    1097 </span>            : </a>
<a name="1098"><span class="lineNum">    1098 </span>            :     /**</a>
<a name="1099"><span class="lineNum">    1099 </span>            :      * Determinant of jacobian in specific integration point of</a>
<a name="1100"><span class="lineNum">    1100 </span>            :      * given integration method. This method calculate determinant</a>
<a name="1101"><span class="lineNum">    1101 </span>            :      * of jacobian in given integration point of given integration</a>
<a name="1102"><span class="lineNum">    1102 </span>            :      * method.</a>
<a name="1103"><span class="lineNum">    1103 </span>            :      *</a>
<a name="1104"><span class="lineNum">    1104 </span>            :      * @param IntegrationPointIndex index of integration point which jacobians has to</a>
<a name="1105"><span class="lineNum">    1105 </span>            :      * be calculated in it.</a>
<a name="1106"><span class="lineNum">    1106 </span>            :      *</a>
<a name="1107"><span class="lineNum">    1107 </span>            :      * @param IntegrationPointIndex index of integration point</a>
<a name="1108"><span class="lineNum">    1108 </span>            :      * which determinant of jacobians has to be calculated in it.</a>
<a name="1109"><span class="lineNum">    1109 </span>            :      *</a>
<a name="1110"><span class="lineNum">    1110 </span>            :      * @return Determinamt of jacobian matrix \f$ |J|_i \f$ where \f$</a>
<a name="1111"><span class="lineNum">    1111 </span>            :      * i \f$ is the given integration point index of given</a>
<a name="1112"><span class="lineNum">    1112 </span>            :      * integration method.</a>
<a name="1113"><span class="lineNum">    1113 </span>            :      *</a>
<a name="1114"><span class="lineNum">    1114 </span>            :      * @see Jacobian</a>
<a name="1115"><span class="lineNum">    1115 </span>            :      * @see InverseOfJacobian</a>
<a name="1116"><span class="lineNum">    1116 </span>            :      */</a>
<a name="1117"><span class="lineNum">    1117 </span><span class="lineNoCov">          0 :     double DeterminantOfJacobian( IndexType IntegrationPointIndex,</span></a>
<a name="1118"><span class="lineNum">    1118 </span>            :                                           IntegrationMethod ThisMethod ) const override</a>
<a name="1119"><span class="lineNum">    1119 </span>            :     {</a>
<a name="1120"><span class="lineNum">    1120 </span><span class="lineNoCov">          0 :         return 2.0*(this-&gt;Area());</span></a>
<a name="1121"><span class="lineNum">    1121 </span>            :     }</a>
<a name="1122"><span class="lineNum">    1122 </span>            : </a>
<a name="1123"><span class="lineNum">    1123 </span>            :     /**</a>
<a name="1124"><span class="lineNum">    1124 </span>            :      * Determinant of jacobian in given point.</a>
<a name="1125"><span class="lineNum">    1125 </span>            :      * This method calculate determinant of jacobian</a>
<a name="1126"><span class="lineNum">    1126 </span>            :      * matrix in given point.</a>
<a name="1127"><span class="lineNum">    1127 </span>            :      * @param rPoint point which determinant of jacobians has to</a>
<a name="1128"><span class="lineNum">    1128 </span>            :      * be calculated in it.</a>
<a name="1129"><span class="lineNum">    1129 </span>            :      *</a>
<a name="1130"><span class="lineNum">    1130 </span>            :      * @return Determinamt of jacobian matrix \f$ |J| \f$ in given</a>
<a name="1131"><span class="lineNum">    1131 </span>            :      * point.</a>
<a name="1132"><span class="lineNum">    1132 </span>            :      *</a>
<a name="1133"><span class="lineNum">    1133 </span>            :      * @see DeterminantOfJacobian</a>
<a name="1134"><span class="lineNum">    1134 </span>            :      * @see InverseOfJacobian</a>
<a name="1135"><span class="lineNum">    1135 </span>            :      *</a>
<a name="1136"><span class="lineNum">    1136 </span>            :      */</a>
<a name="1137"><span class="lineNum">    1137 </span><span class="lineNoCov">          0 :     double DeterminantOfJacobian( const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="1138"><span class="lineNum">    1138 </span>            :     {</a>
<a name="1139"><span class="lineNum">    1139 </span><span class="lineNoCov">          0 :         return 2.0*(this-&gt;Area());</span></a>
<a name="1140"><span class="lineNum">    1140 </span>            :     }</a>
<a name="1141"><span class="lineNum">    1141 </span>            : </a>
<a name="1142"><span class="lineNum">    1142 </span>            : </a>
<a name="1143"><span class="lineNum">    1143 </span>            :     ///@}</a>
<a name="1144"><span class="lineNum">    1144 </span>            :     ///@name Input and output</a>
<a name="1145"><span class="lineNum">    1145 </span>            :     ///@{</a>
<a name="1146"><span class="lineNum">    1146 </span>            : </a>
<a name="1147"><span class="lineNum">    1147 </span>            :     /**</a>
<a name="1148"><span class="lineNum">    1148 </span>            :      * Turn back information as a string.</a>
<a name="1149"><span class="lineNum">    1149 </span>            :      *</a>
<a name="1150"><span class="lineNum">    1150 </span>            :      * @return String contains information about this geometry.</a>
<a name="1151"><span class="lineNum">    1151 </span>            :      * @see PrintData()</a>
<a name="1152"><span class="lineNum">    1152 </span>            :      * @see PrintInfo()</a>
<a name="1153"><span class="lineNum">    1153 </span>            :      */</a>
<a name="1154"><span class="lineNum">    1154 </span><span class="lineNoCov">          0 :     std::string Info() const override</span></a>
<a name="1155"><span class="lineNum">    1155 </span>            :     {</a>
<a name="1156"><span class="lineNum">    1156 </span><span class="lineNoCov">          0 :         return &quot;2 dimensional triangle with three nodes in 2D space&quot;;</span></a>
<a name="1157"><span class="lineNum">    1157 </span>            :     }</a>
<a name="1158"><span class="lineNum">    1158 </span>            : </a>
<a name="1159"><span class="lineNum">    1159 </span>            :     /**</a>
<a name="1160"><span class="lineNum">    1160 </span>            :      * Print information about this object.</a>
<a name="1161"><span class="lineNum">    1161 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="1162"><span class="lineNum">    1162 </span>            :      * @see PrintData()</a>
<a name="1163"><span class="lineNum">    1163 </span>            :      * @see Info()</a>
<a name="1164"><span class="lineNum">    1164 </span>            :      */</a>
<a name="1165"><span class="lineNum">    1165 </span><span class="lineNoCov">          0 :     void PrintInfo( std::ostream&amp; rOStream ) const override</span></a>
<a name="1166"><span class="lineNum">    1166 </span>            :     {</a>
<a name="1167"><span class="lineNum">    1167 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;2 dimensional triangle with three nodes in 2D space&quot;;</span></a>
<a name="1168"><span class="lineNum">    1168 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1169"><span class="lineNum">    1169 </span>            : </a>
<a name="1170"><span class="lineNum">    1170 </span>            :     /**</a>
<a name="1171"><span class="lineNum">    1171 </span>            :      * Print geometry's data into given stream.</a>
<a name="1172"><span class="lineNum">    1172 </span>            :      * Prints it's points</a>
<a name="1173"><span class="lineNum">    1173 </span>            :      * by the order they stored in the geometry and then center</a>
<a name="1174"><span class="lineNum">    1174 </span>            :      * point of geometry.</a>
<a name="1175"><span class="lineNum">    1175 </span>            :      *</a>
<a name="1176"><span class="lineNum">    1176 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="1177"><span class="lineNum">    1177 </span>            :      * @see PrintInfo()</a>
<a name="1178"><span class="lineNum">    1178 </span>            :      * @see Info()</a>
<a name="1179"><span class="lineNum">    1179 </span>            :      */</a>
<a name="1180"><span class="lineNum">    1180 </span>            :     /**</a>
<a name="1181"><span class="lineNum">    1181 </span>            :      * :TODO: needs to be reviewed because it is not properly implemented yet</a>
<a name="1182"><span class="lineNum">    1182 </span>            :      * (comment by janosch)</a>
<a name="1183"><span class="lineNum">    1183 </span>            :      */</a>
<a name="1184"><span class="lineNum">    1184 </span><span class="lineNoCov">          0 :     void PrintData( std::ostream&amp; rOStream ) const override</span></a>
<a name="1185"><span class="lineNum">    1185 </span>            :     {</a>
<a name="1186"><span class="lineNum">    1186 </span><span class="lineNoCov">          0 :         PrintInfo( rOStream );</span></a>
<a name="1187"><span class="lineNum">    1187 </span><span class="lineNoCov">          0 :         BaseType::PrintData( rOStream );</span></a>
<a name="1188"><span class="lineNum">    1188 </span>            :         std::cout &lt;&lt; std::endl;</a>
<a name="1189"><span class="lineNum">    1189 </span>            :         Matrix jacobian;</a>
<a name="1190"><span class="lineNum">    1190 </span><span class="lineNoCov">          0 :         this-&gt;Jacobian( jacobian, PointType() );</span></a>
<a name="1191"><span class="lineNum">    1191 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;    Jacobian in the origin\t : &quot; &lt;&lt; jacobian;</span></a>
<a name="1192"><span class="lineNum">    1192 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1193"><span class="lineNum">    1193 </span>            : </a>
<a name="1194"><span class="lineNum">    1194 </span>            :     /**</a>
<a name="1195"><span class="lineNum">    1195 </span>            :      * Calculates the local gradients for all integration points for</a>
<a name="1196"><span class="lineNum">    1196 </span>            :      * given integration method</a>
<a name="1197"><span class="lineNum">    1197 </span>            :      */</a>
<a name="1198"><span class="lineNum">    1198 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients(</span></a>
<a name="1199"><span class="lineNum">    1199 </span>            :         IntegrationMethod ThisMethod )</a>
<a name="1200"><span class="lineNum">    1200 </span>            :     {</a>
<a name="1201"><span class="lineNum">    1201 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="1202"><span class="lineNum">    1202 </span>            :             = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="1203"><span class="lineNum">    1203 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="1204"><span class="lineNum">    1204 </span>            :             = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1205"><span class="lineNum">    1205 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="1206"><span class="lineNum">    1206 </span>            : </a>
<a name="1207"><span class="lineNum">    1207 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1208"><span class="lineNum">    1208 </span>            :         {</a>
<a name="1209"><span class="lineNum">    1209 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="1210"><span class="lineNum">    1210 </span>            :         }</a>
<a name="1211"><span class="lineNum">    1211 </span>            : </a>
<a name="1212"><span class="lineNum">    1212 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="1213"><span class="lineNum">    1213 </span>            :     }</a>
<a name="1214"><span class="lineNum">    1214 </span>            : </a>
<a name="1215"><span class="lineNum">    1215 </span>            :     /**</a>
<a name="1216"><span class="lineNum">    1216 </span>            :      * Calculates the local gradients for all integration points for the</a>
<a name="1217"><span class="lineNum">    1217 </span>            :      * default integration method</a>
<a name="1218"><span class="lineNum">    1218 </span>            :      */</a>
<a name="1219"><span class="lineNum">    1219 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients()</span></a>
<a name="1220"><span class="lineNum">    1220 </span>            :     {</a>
<a name="1221"><span class="lineNum">    1221 </span>            :         IntegrationMethod ThisMethod = msGeometryData.DefaultIntegrationMethod();</a>
<a name="1222"><span class="lineNum">    1222 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="1223"><span class="lineNum">    1223 </span>            :             = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="1224"><span class="lineNum">    1224 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="1225"><span class="lineNum">    1225 </span>            :             = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="1226"><span class="lineNum">    1226 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="1227"><span class="lineNum">    1227 </span>            : </a>
<a name="1228"><span class="lineNum">    1228 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1229"><span class="lineNum">    1229 </span>            :         {</a>
<a name="1230"><span class="lineNum">    1230 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="1231"><span class="lineNum">    1231 </span>            :         }</a>
<a name="1232"><span class="lineNum">    1232 </span>            : </a>
<a name="1233"><span class="lineNum">    1233 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="1234"><span class="lineNum">    1234 </span>            :     }</a>
<a name="1235"><span class="lineNum">    1235 </span>            : </a>
<a name="1236"><span class="lineNum">    1236 </span>            :     /**</a>
<a name="1237"><span class="lineNum">    1237 </span>            :      * Calculates the gradients in terms of local coordinates</a>
<a name="1238"><span class="lineNum">    1238 </span>            :      * of all shape functions in a given point.</a>
<a name="1239"><span class="lineNum">    1239 </span>            :      *</a>
<a name="1240"><span class="lineNum">    1240 </span>            :      * @param rPoint the current point at which the gradients are calculated in local</a>
<a name="1241"><span class="lineNum">    1241 </span>            :      * coordinates</a>
<a name="1242"><span class="lineNum">    1242 </span>            :      * @return the gradients of all shape functions</a>
<a name="1243"><span class="lineNum">    1243 </span>            :      * \f$ \frac{\partial N^i}{\partial \xi_j} \f$</a>
<a name="1244"><span class="lineNum">    1244 </span>            :      */</a>
<a name="1245"><span class="lineNum">    1245 </span><span class="lineNoCov">          0 :     Matrix&amp; ShapeFunctionsLocalGradients( Matrix&amp; rResult,</span></a>
<a name="1246"><span class="lineNum">    1246 </span>            :             const CoordinatesArrayType&amp; rPoint ) const override</a>
<a name="1247"><span class="lineNum">    1247 </span>            :     {</a>
<a name="1248"><span class="lineNum">    1248 </span><span class="lineNoCov">          0 :         rResult = ZeroMatrix( 3, 2 );</span></a>
<a name="1249"><span class="lineNum">    1249 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = -1.0;</span></a>
<a name="1250"><span class="lineNum">    1250 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = -1.0;</span></a>
<a name="1251"><span class="lineNum">    1251 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  1.0;</span></a>
<a name="1252"><span class="lineNum">    1252 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0.0;</span></a>
<a name="1253"><span class="lineNum">    1253 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0.0;</span></a>
<a name="1254"><span class="lineNum">    1254 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  1.0;</span></a>
<a name="1255"><span class="lineNum">    1255 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1256"><span class="lineNum">    1256 </span>            :     }</a>
<a name="1257"><span class="lineNum">    1257 </span>            : </a>
<a name="1258"><span class="lineNum">    1258 </span>            : </a>
<a name="1259"><span class="lineNum">    1259 </span>            : </a>
<a name="1260"><span class="lineNum">    1260 </span>            :     /**</a>
<a name="1261"><span class="lineNum">    1261 </span>            :      * returns the shape function gradients in an arbitrary point,</a>
<a name="1262"><span class="lineNum">    1262 </span>            :      * given in local coordinates</a>
<a name="1263"><span class="lineNum">    1263 </span>            :      *</a>
<a name="1264"><span class="lineNum">    1264 </span>            :      * @param rResult the matrix of gradients,</a>
<a name="1265"><span class="lineNum">    1265 </span>            :      * will be overwritten with the gradients for all</a>
<a name="1266"><span class="lineNum">    1266 </span>            :      * shape functions in given point</a>
<a name="1267"><span class="lineNum">    1267 </span>            :      * @param rPoint the given point the gradients are calculated in</a>
<a name="1268"><span class="lineNum">    1268 </span>            :      */</a>
<a name="1269"><span class="lineNum">    1269 </span><span class="lineNoCov">          0 :     virtual Matrix&amp; ShapeFunctionsGradients( Matrix&amp; rResult, PointType&amp; rPoint )</span></a>
<a name="1270"><span class="lineNum">    1270 </span>            :     {</a>
<a name="1271"><span class="lineNum">    1271 </span><span class="lineNoCov">          0 :         rResult = ZeroMatrix( 3, 2 );</span></a>
<a name="1272"><span class="lineNum">    1272 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = -1.0;</span></a>
<a name="1273"><span class="lineNum">    1273 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = -1.0;</span></a>
<a name="1274"><span class="lineNum">    1274 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  1.0;</span></a>
<a name="1275"><span class="lineNum">    1275 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0.0;</span></a>
<a name="1276"><span class="lineNum">    1276 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0.0;</span></a>
<a name="1277"><span class="lineNum">    1277 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  1.0;</span></a>
<a name="1278"><span class="lineNum">    1278 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1279"><span class="lineNum">    1279 </span>            :     }</a>
<a name="1280"><span class="lineNum">    1280 </span>            : </a>
<a name="1281"><span class="lineNum">    1281 </span>            :     /**</a>
<a name="1282"><span class="lineNum">    1282 </span>            :      * returns the second order derivatives of all shape functions</a>
<a name="1283"><span class="lineNum">    1283 </span>            :      * in given arbitrary pointers</a>
<a name="1284"><span class="lineNum">    1284 </span>            :      * @param rResult a third order tensor which contains the second derivatives</a>
<a name="1285"><span class="lineNum">    1285 </span>            :      * @param rPoint the given point the second order derivatives are calculated in</a>
<a name="1286"><span class="lineNum">    1286 </span>            :      */</a>
<a name="1287"><span class="lineNum">    1287 </span><span class="lineNoCov">          0 :     ShapeFunctionsSecondDerivativesType&amp; ShapeFunctionsSecondDerivatives( ShapeFunctionsSecondDerivativesType&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="1288"><span class="lineNum">    1288 </span>            :     {</a>
<a name="1289"><span class="lineNum">    1289 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="1290"><span class="lineNum">    1290 </span>            :         {</a>
<a name="1291"><span class="lineNum">    1291 </span>            :             // KLUDGE: While there is a bug in</a>
<a name="1292"><span class="lineNum">    1292 </span>            :             // ublas vector resize, I have to put this beside resizing!!</a>
<a name="1293"><span class="lineNum">    1293 </span>            :             ShapeFunctionsGradientsType temp( this-&gt;PointsNumber() );</a>
<a name="1294"><span class="lineNum">    1294 </span>            :             rResult.swap( temp );</a>
<a name="1295"><span class="lineNum">    1295 </span>            :         }</a>
<a name="1296"><span class="lineNum">    1296 </span>            : </a>
<a name="1297"><span class="lineNum">    1297 </span><span class="lineNoCov">          0 :         if(rResult[0].size1() != 2 || rResult[0].size2() != 2 )</span></a>
<a name="1298"><span class="lineNum">    1298 </span><span class="lineNoCov">          0 :             rResult[0].resize( 2, 2,false );</span></a>
<a name="1299"><span class="lineNum">    1299 </span>            : </a>
<a name="1300"><span class="lineNum">    1300 </span><span class="lineNoCov">          0 :         if(rResult[1].size1() != 2 || rResult[1].size2() != 2 )</span></a>
<a name="1301"><span class="lineNum">    1301 </span><span class="lineNoCov">          0 :             rResult[1].resize( 2, 2,false );</span></a>
<a name="1302"><span class="lineNum">    1302 </span>            : </a>
<a name="1303"><span class="lineNum">    1303 </span><span class="lineNoCov">          0 :         if(rResult[2].size1() != 2 || rResult[2].size2() != 2 )</span></a>
<a name="1304"><span class="lineNum">    1304 </span><span class="lineNoCov">          0 :             rResult[2].resize( 2, 2,false );</span></a>
<a name="1305"><span class="lineNum">    1305 </span>            : </a>
<a name="1306"><span class="lineNum">    1306 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 0 ) = 0.0;</span></a>
<a name="1307"><span class="lineNum">    1307 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 1 ) = 0.0;</span></a>
<a name="1308"><span class="lineNum">    1308 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 0 ) = 0.0;</span></a>
<a name="1309"><span class="lineNum">    1309 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 1 ) = 0.0;</span></a>
<a name="1310"><span class="lineNum">    1310 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 0 ) = 0.0;</span></a>
<a name="1311"><span class="lineNum">    1311 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 1 ) = 0.0;</span></a>
<a name="1312"><span class="lineNum">    1312 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 0 ) = 0.0;</span></a>
<a name="1313"><span class="lineNum">    1313 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 1 ) = 0.0;</span></a>
<a name="1314"><span class="lineNum">    1314 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 0 ) = 0.0;</span></a>
<a name="1315"><span class="lineNum">    1315 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 1 ) = 0.0;</span></a>
<a name="1316"><span class="lineNum">    1316 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 0 ) = 0.0;</span></a>
<a name="1317"><span class="lineNum">    1317 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 1 ) = 0.0;</span></a>
<a name="1318"><span class="lineNum">    1318 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1319"><span class="lineNum">    1319 </span>            :     }</a>
<a name="1320"><span class="lineNum">    1320 </span>            : </a>
<a name="1321"><span class="lineNum">    1321 </span>            :     /**</a>
<a name="1322"><span class="lineNum">    1322 </span>            :      * returns the third order derivatives of all shape functions</a>
<a name="1323"><span class="lineNum">    1323 </span>            :      * in given arbitrary pointers</a>
<a name="1324"><span class="lineNum">    1324 </span>            :      * @param rResult a fourth order tensor which contains the third derivatives</a>
<a name="1325"><span class="lineNum">    1325 </span>            :      * @param rPoint the given point the third order derivatives are calculated in</a>
<a name="1326"><span class="lineNum">    1326 </span>            :      */</a>
<a name="1327"><span class="lineNum">    1327 </span><span class="lineNoCov">          0 :     ShapeFunctionsThirdDerivativesType&amp; ShapeFunctionsThirdDerivatives( ShapeFunctionsThirdDerivativesType&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="1328"><span class="lineNum">    1328 </span>            :     {</a>
<a name="1329"><span class="lineNum">    1329 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="1330"><span class="lineNum">    1330 </span>            :         {</a>
<a name="1331"><span class="lineNum">    1331 </span>            :             // KLUDGE: While there is a bug in</a>
<a name="1332"><span class="lineNum">    1332 </span>            :             // ublas vector resize, I have to put this beside resizing!!</a>
<a name="1333"><span class="lineNum">    1333 </span>            : //                 ShapeFunctionsGradientsType</a>
<a name="1334"><span class="lineNum">    1334 </span>            :             ShapeFunctionsThirdDerivativesType temp( this-&gt;PointsNumber() );</a>
<a name="1335"><span class="lineNum">    1335 </span>            :             rResult.swap( temp );</a>
<a name="1336"><span class="lineNum">    1336 </span>            :         }</a>
<a name="1337"><span class="lineNum">    1337 </span>            : </a>
<a name="1338"><span class="lineNum">    1338 </span><span class="lineNoCov">          0 :         for ( IndexType i = 0; i &lt; rResult.size(); i++ )</span></a>
<a name="1339"><span class="lineNum">    1339 </span>            :         {</a>
<a name="1340"><span class="lineNum">    1340 </span>            :             DenseVector&lt;Matrix&gt; temp( this-&gt;PointsNumber() );</a>
<a name="1341"><span class="lineNum">    1341 </span>            :             rResult[i].swap( temp );</a>
<a name="1342"><span class="lineNum">    1342 </span>            :         }</a>
<a name="1343"><span class="lineNum">    1343 </span>            : </a>
<a name="1344"><span class="lineNum">    1344 </span><span class="lineNoCov">          0 :         rResult[0][0].resize( 2, 2,false );</span></a>
<a name="1345"><span class="lineNum">    1345 </span>            : </a>
<a name="1346"><span class="lineNum">    1346 </span><span class="lineNoCov">          0 :         rResult[0][1].resize( 2, 2,false );</span></a>
<a name="1347"><span class="lineNum">    1347 </span><span class="lineNoCov">          0 :         rResult[1][0].resize( 2, 2,false );</span></a>
<a name="1348"><span class="lineNum">    1348 </span><span class="lineNoCov">          0 :         rResult[1][1].resize( 2, 2,false );</span></a>
<a name="1349"><span class="lineNum">    1349 </span><span class="lineNoCov">          0 :         rResult[2][0].resize( 2, 2,false );</span></a>
<a name="1350"><span class="lineNum">    1350 </span><span class="lineNoCov">          0 :         rResult[2][1].resize( 2, 2,false );</span></a>
<a name="1351"><span class="lineNum">    1351 </span>            : </a>
<a name="1352"><span class="lineNum">    1352 </span><span class="lineNoCov">          0 :         for ( int i = 0; i &lt; 3; i++ )</span></a>
<a name="1353"><span class="lineNum">    1353 </span>            :         {</a>
<a name="1354"><span class="lineNum">    1354 </span>            : </a>
<a name="1355"><span class="lineNum">    1355 </span><span class="lineNoCov">          0 :             rResult[i][0]( 0, 0 ) = 0.0;</span></a>
<a name="1356"><span class="lineNum">    1356 </span><span class="lineNoCov">          0 :             rResult[i][0]( 0, 1 ) = 0.0;</span></a>
<a name="1357"><span class="lineNum">    1357 </span><span class="lineNoCov">          0 :             rResult[i][0]( 1, 0 ) = 0.0;</span></a>
<a name="1358"><span class="lineNum">    1358 </span><span class="lineNoCov">          0 :             rResult[i][0]( 1, 1 ) = 0.0;</span></a>
<a name="1359"><span class="lineNum">    1359 </span><span class="lineNoCov">          0 :             rResult[i][1]( 0, 0 ) = 0.0;</span></a>
<a name="1360"><span class="lineNum">    1360 </span><span class="lineNoCov">          0 :             rResult[i][1]( 0, 1 ) = 0.0;</span></a>
<a name="1361"><span class="lineNum">    1361 </span><span class="lineNoCov">          0 :             rResult[i][1]( 1, 0 ) = 0.0;</span></a>
<a name="1362"><span class="lineNum">    1362 </span><span class="lineNoCov">          0 :             rResult[i][1]( 1, 1 ) = 0.0;</span></a>
<a name="1363"><span class="lineNum">    1363 </span>            :         }</a>
<a name="1364"><span class="lineNum">    1364 </span>            : </a>
<a name="1365"><span class="lineNum">    1365 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="1366"><span class="lineNum">    1366 </span>            :     }</a>
<a name="1367"><span class="lineNum">    1367 </span>            : </a>
<a name="1368"><span class="lineNum">    1368 </span>            :     ///@}</a>
<a name="1369"><span class="lineNum">    1369 </span>            :     ///@name Friends</a>
<a name="1370"><span class="lineNum">    1370 </span>            :     ///@{</a>
<a name="1371"><span class="lineNum">    1371 </span>            : </a>
<a name="1372"><span class="lineNum">    1372 </span>            :     ///@}</a>
<a name="1373"><span class="lineNum">    1373 </span>            : </a>
<a name="1374"><span class="lineNum">    1374 </span>            : protected:</a>
<a name="1375"><span class="lineNum">    1375 </span>            :     /**</a>
<a name="1376"><span class="lineNum">    1376 </span>            :      * There are no protected members in class Triangle2D3</a>
<a name="1377"><span class="lineNum">    1377 </span>            :      */</a>
<a name="1378"><span class="lineNum">    1378 </span>            : </a>
<a name="1379"><span class="lineNum">    1379 </span>            : private:</a>
<a name="1380"><span class="lineNum">    1380 </span>            :     ///@name Static Member Variables</a>
<a name="1381"><span class="lineNum">    1381 </span>            :     ///@{</a>
<a name="1382"><span class="lineNum">    1382 </span>            : </a>
<a name="1383"><span class="lineNum">    1383 </span>            :     static const GeometryData msGeometryData;</a>
<a name="1384"><span class="lineNum">    1384 </span>            : </a>
<a name="1385"><span class="lineNum">    1385 </span>            :     static const GeometryDimension msGeometryDimension;</a>
<a name="1386"><span class="lineNum">    1386 </span>            : </a>
<a name="1387"><span class="lineNum">    1387 </span>            :     ///@}</a>
<a name="1388"><span class="lineNum">    1388 </span>            :     ///@name Serialization</a>
<a name="1389"><span class="lineNum">    1389 </span>            :     ///@{</a>
<a name="1390"><span class="lineNum">    1390 </span>            : </a>
<a name="1391"><span class="lineNum">    1391 </span>            :     friend class Serializer;</a>
<a name="1392"><span class="lineNum">    1392 </span>            : </a>
<a name="1393"><span class="lineNum">    1393 </span><span class="lineNoCov">          0 :     void save( Serializer&amp; rSerializer ) const override</span></a>
<a name="1394"><span class="lineNum">    1394 </span>            :     {</a>
<a name="1395"><span class="lineNum">    1395 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_SAVE_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="1396"><span class="lineNum">    1396 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1397"><span class="lineNum">    1397 </span>            : </a>
<a name="1398"><span class="lineNum">    1398 </span><span class="lineNoCov">          0 :     void load( Serializer&amp; rSerializer ) override</span></a>
<a name="1399"><span class="lineNum">    1399 </span>            :     {</a>
<a name="1400"><span class="lineNum">    1400 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_LOAD_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="1401"><span class="lineNum">    1401 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="1402"><span class="lineNum">    1402 </span>            : </a>
<a name="1403"><span class="lineNum">    1403 </span><span class="lineNoCov">          0 :     Triangle2D3():BaseType( PointsArrayType(), &amp;msGeometryData ) {}</span></a>
<a name="1404"><span class="lineNum">    1404 </span>            : </a>
<a name="1405"><span class="lineNum">    1405 </span>            :     ///@}</a>
<a name="1406"><span class="lineNum">    1406 </span>            :     ///@name Member Variables</a>
<a name="1407"><span class="lineNum">    1407 </span>            :     ///@{</a>
<a name="1408"><span class="lineNum">    1408 </span>            : </a>
<a name="1409"><span class="lineNum">    1409 </span>            : </a>
<a name="1410"><span class="lineNum">    1410 </span>            :     ///@}</a>
<a name="1411"><span class="lineNum">    1411 </span>            :     ///@name Private Operators</a>
<a name="1412"><span class="lineNum">    1412 </span>            :     ///@{</a>
<a name="1413"><span class="lineNum">    1413 </span>            : </a>
<a name="1414"><span class="lineNum">    1414 </span>            : </a>
<a name="1415"><span class="lineNum">    1415 </span>            :     ///@}</a>
<a name="1416"><span class="lineNum">    1416 </span>            :     ///@name Private Operations</a>
<a name="1417"><span class="lineNum">    1417 </span>            :     ///@{</a>
<a name="1418"><span class="lineNum">    1418 </span>            : </a>
<a name="1419"><span class="lineNum">    1419 </span>            :     /**</a>
<a name="1420"><span class="lineNum">    1420 </span>            :      * Calculates the values of all shape function in all integration points.</a>
<a name="1421"><span class="lineNum">    1421 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="1422"><span class="lineNum">    1422 </span>            :      * @param ThisMethod the current integration method</a>
<a name="1423"><span class="lineNum">    1423 </span>            :      * @return the matrix of values of every shape function in each integration point</a>
<a name="1424"><span class="lineNum">    1424 </span>            :      * :KLUDGE: number of points is hard-coded -&gt; be careful if you want to copy and paste!</a>
<a name="1425"><span class="lineNum">    1425 </span>            :      */</a>
<a name="1426"><span class="lineNum">    1426 </span><span class="lineCov">         40 :     static Matrix CalculateShapeFunctionsIntegrationPointsValues(</span></a>
<a name="1427"><span class="lineNum">    1427 </span>            :         typename BaseType::IntegrationMethod ThisMethod )</a>
<a name="1428"><span class="lineNum">    1428 </span>            :     {</a>
<a name="1429"><span class="lineNum">    1429 </span><span class="lineCov">         40 :         IntegrationPointsContainerType all_integration_points =</span></a>
<a name="1430"><span class="lineNum">    1430 </span>            :             AllIntegrationPoints();</a>
<a name="1431"><span class="lineNum">    1431 </span><span class="lineCov">         40 :         IntegrationPointsArrayType integration_points =</span></a>
<a name="1432"><span class="lineNum">    1432 </span><span class="lineCov">         40 :             all_integration_points[ThisMethod];</span></a>
<a name="1433"><span class="lineNum">    1433 </span>            :         //number of integration points</a>
<a name="1434"><span class="lineNum">    1434 </span><span class="lineCov">         40 :         const int integration_points_number = integration_points.size();</span></a>
<a name="1435"><span class="lineNum">    1435 </span>            :         //number of nodes in current geometry</a>
<a name="1436"><span class="lineNum">    1436 </span>            :         const int points_number = 3;</a>
<a name="1437"><span class="lineNum">    1437 </span>            :         //setting up return matrix</a>
<a name="1438"><span class="lineNum">    1438 </span><span class="lineCov">         40 :         Matrix shape_function_values( integration_points_number, points_number );</span></a>
<a name="1439"><span class="lineNum">    1439 </span>            :         //loop over all integration points</a>
<a name="1440"><span class="lineNum">    1440 </span>            : </a>
<a name="1441"><span class="lineNum">    1441 </span><span class="lineCov">        364 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1442"><span class="lineNum">    1442 </span>            :         {</a>
<a name="1443"><span class="lineNum">    1443 </span><span class="lineCov">        324 :             shape_function_values( pnt, 0 ) = 1.0</span></a>
<a name="1444"><span class="lineNum">    1444 </span><span class="lineCov">        324 :                                               - integration_points[pnt].X()</span></a>
<a name="1445"><span class="lineNum">    1445 </span><span class="lineCov">        324 :                                               - integration_points[pnt].Y();</span></a>
<a name="1446"><span class="lineNum">    1446 </span><span class="lineCov">        324 :             shape_function_values( pnt, 1 ) = integration_points[pnt].X();</span></a>
<a name="1447"><span class="lineNum">    1447 </span><span class="lineCov">        324 :             shape_function_values( pnt, 2 ) = integration_points[pnt].Y();</span></a>
<a name="1448"><span class="lineNum">    1448 </span>            :         }</a>
<a name="1449"><span class="lineNum">    1449 </span>            : </a>
<a name="1450"><span class="lineNum">    1450 </span><span class="lineCov">         40 :         return shape_function_values;</span></a>
<a name="1451"><span class="lineNum">    1451 </span><span class="lineCov">         40 :     }</span></a>
<a name="1452"><span class="lineNum">    1452 </span>            : </a>
<a name="1453"><span class="lineNum">    1453 </span>            :     /**</a>
<a name="1454"><span class="lineNum">    1454 </span>            :      * Calculates the local gradients of all shape functions</a>
<a name="1455"><span class="lineNum">    1455 </span>            :      * in all integration points.</a>
<a name="1456"><span class="lineNum">    1456 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="1457"><span class="lineNum">    1457 </span>            :      *</a>
<a name="1458"><span class="lineNum">    1458 </span>            :      * @param ThisMethod the current integration method</a>
<a name="1459"><span class="lineNum">    1459 </span>            :      * @return the vector of the gradients of all shape functions</a>
<a name="1460"><span class="lineNum">    1460 </span>            :      * in each integration point</a>
<a name="1461"><span class="lineNum">    1461 </span>            :      */</a>
<a name="1462"><span class="lineNum">    1462 </span>            :     static ShapeFunctionsGradientsType</a>
<a name="1463"><span class="lineNum">    1463 </span><span class="lineCov">         40 :     CalculateShapeFunctionsIntegrationPointsLocalGradients(</span></a>
<a name="1464"><span class="lineNum">    1464 </span>            :         typename BaseType::IntegrationMethod ThisMethod )</a>
<a name="1465"><span class="lineNum">    1465 </span>            :     {</a>
<a name="1466"><span class="lineNum">    1466 </span><span class="lineCov">         40 :         IntegrationPointsContainerType all_integration_points =</span></a>
<a name="1467"><span class="lineNum">    1467 </span>            :             AllIntegrationPoints();</a>
<a name="1468"><span class="lineNum">    1468 </span><span class="lineCov">         40 :         IntegrationPointsArrayType integration_points =</span></a>
<a name="1469"><span class="lineNum">    1469 </span><span class="lineCov">         40 :             all_integration_points[ThisMethod];</span></a>
<a name="1470"><span class="lineNum">    1470 </span>            :         //number of integration points</a>
<a name="1471"><span class="lineNum">    1471 </span><span class="lineCov">         40 :         const int integration_points_number = integration_points.size();</span></a>
<a name="1472"><span class="lineNum">    1472 </span><span class="lineCov">         40 :         ShapeFunctionsGradientsType d_shape_f_values( integration_points_number );</span></a>
<a name="1473"><span class="lineNum">    1473 </span>            :         //initialising container</a>
<a name="1474"><span class="lineNum">    1474 </span>            :         //std::fill(d_shape_f_values.begin(), d_shape_f_values.end(), Matrix(4,2));</a>
<a name="1475"><span class="lineNum">    1475 </span>            :         //loop over all integration points</a>
<a name="1476"><span class="lineNum">    1476 </span>            : </a>
<a name="1477"><span class="lineNum">    1477 </span><span class="lineCov">        364 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="1478"><span class="lineNum">    1478 </span>            :         {</a>
<a name="1479"><span class="lineNum">    1479 </span>            :             Matrix result( 3, 2 );</a>
<a name="1480"><span class="lineNum">    1480 </span><span class="lineCov">        324 :             result( 0, 0 ) = -1.0;</span></a>
<a name="1481"><span class="lineNum">    1481 </span><span class="lineCov">        324 :             result( 0, 1 ) = -1.0;</span></a>
<a name="1482"><span class="lineNum">    1482 </span><span class="lineCov">        324 :             result( 1, 0 ) =  1.0;</span></a>
<a name="1483"><span class="lineNum">    1483 </span><span class="lineCov">        324 :             result( 1, 1 ) =  0.0;</span></a>
<a name="1484"><span class="lineNum">    1484 </span><span class="lineCov">        324 :             result( 2, 0 ) =  0.0;</span></a>
<a name="1485"><span class="lineNum">    1485 </span><span class="lineCov">        324 :             result( 2, 1 ) =  1.0;</span></a>
<a name="1486"><span class="lineNum">    1486 </span><span class="lineCov">        324 :             d_shape_f_values[pnt] = result;</span></a>
<a name="1487"><span class="lineNum">    1487 </span>            :         }</a>
<a name="1488"><span class="lineNum">    1488 </span>            : </a>
<a name="1489"><span class="lineNum">    1489 </span><span class="lineCov">         40 :         return d_shape_f_values;</span></a>
<a name="1490"><span class="lineNum">    1490 </span><span class="lineCov">         40 :     }</span></a>
<a name="1491"><span class="lineNum">    1491 </span>            : </a>
<a name="1492"><span class="lineNum">    1492 </span>            :     /**</a>
<a name="1493"><span class="lineNum">    1493 </span>            :      * TODO: testing</a>
<a name="1494"><span class="lineNum">    1494 </span>            :      */</a>
<a name="1495"><span class="lineNum">    1495 </span><span class="lineCov">         84 :     static const IntegrationPointsContainerType AllIntegrationPoints()</span></a>
<a name="1496"><span class="lineNum">    1496 </span>            :     {</a>
<a name="1497"><span class="lineNum">    1497 </span><span class="lineCov">         84 :         IntegrationPointsContainerType integration_points =</span></a>
<a name="1498"><span class="lineNum">    1498 </span>            :         {</a>
<a name="1499"><span class="lineNum">    1499 </span>            :             {</a>
<a name="1500"><span class="lineNum">    1500 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints1, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1501"><span class="lineNum">    1501 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints2, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1502"><span class="lineNum">    1502 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints3, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1503"><span class="lineNum">    1503 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints4, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1504"><span class="lineNum">    1504 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints5, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1505"><span class="lineNum">    1505 </span>            :                 Quadrature&lt;TriangleCollocationIntegrationPoints1, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1506"><span class="lineNum">    1506 </span>            :                 Quadrature&lt;TriangleCollocationIntegrationPoints2, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1507"><span class="lineNum">    1507 </span>            :                 Quadrature&lt;TriangleCollocationIntegrationPoints3, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1508"><span class="lineNum">    1508 </span>            :                 Quadrature&lt;TriangleCollocationIntegrationPoints4, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1509"><span class="lineNum">    1509 </span>            :                 Quadrature&lt;TriangleCollocationIntegrationPoints5, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints()</a>
<a name="1510"><span class="lineNum">    1510 </span>            :             }</a>
<a name="1511"><span class="lineNum">    1511 </span>            :         };</a>
<a name="1512"><span class="lineNum">    1512 </span><span class="lineCov">         84 :         return integration_points;</span></a>
<a name="1513"><span class="lineNum">    1513 </span>            :     }</a>
<a name="1514"><span class="lineNum">    1514 </span>            : </a>
<a name="1515"><span class="lineNum">    1515 </span>            :     /**</a>
<a name="1516"><span class="lineNum">    1516 </span>            :      * TODO: testing</a>
<a name="1517"><span class="lineNum">    1517 </span>            :      */</a>
<a name="1518"><span class="lineNum">    1518 </span><span class="lineCov">          4 :     static const ShapeFunctionsValuesContainerType AllShapeFunctionsValues()</span></a>
<a name="1519"><span class="lineNum">    1519 </span>            :     {</a>
<a name="1520"><span class="lineNum">    1520 </span><span class="lineCov">          4 :         ShapeFunctionsValuesContainerType shape_functions_values =</span></a>
<a name="1521"><span class="lineNum">    1521 </span>            :         {</a>
<a name="1522"><span class="lineNum">    1522 </span>            :             {</a>
<a name="1523"><span class="lineNum">    1523 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1524"><span class="lineNum">    1524 </span>            :                     GeometryData::GI_GAUSS_1 ),</a>
<a name="1525"><span class="lineNum">    1525 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1526"><span class="lineNum">    1526 </span>            :                     GeometryData::GI_GAUSS_2 ),</a>
<a name="1527"><span class="lineNum">    1527 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1528"><span class="lineNum">    1528 </span>            :                     GeometryData::GI_GAUSS_3 ),</a>
<a name="1529"><span class="lineNum">    1529 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1530"><span class="lineNum">    1530 </span>            :                     GeometryData::GI_GAUSS_4 ),</a>
<a name="1531"><span class="lineNum">    1531 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1532"><span class="lineNum">    1532 </span>            :                     GeometryData::GI_GAUSS_5 ),</a>
<a name="1533"><span class="lineNum">    1533 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1534"><span class="lineNum">    1534 </span>            :                     GeometryData::GI_EXTENDED_GAUSS_1 ),</a>
<a name="1535"><span class="lineNum">    1535 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1536"><span class="lineNum">    1536 </span>            :                     GeometryData::GI_EXTENDED_GAUSS_2 ),</a>
<a name="1537"><span class="lineNum">    1537 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1538"><span class="lineNum">    1538 </span>            :                     GeometryData::GI_EXTENDED_GAUSS_3 ),</a>
<a name="1539"><span class="lineNum">    1539 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1540"><span class="lineNum">    1540 </span>            :                     GeometryData::GI_EXTENDED_GAUSS_4 ),</a>
<a name="1541"><span class="lineNum">    1541 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1542"><span class="lineNum">    1542 </span>            :                     GeometryData::GI_EXTENDED_GAUSS_5 ),</a>
<a name="1543"><span class="lineNum">    1543 </span>            :             }</a>
<a name="1544"><span class="lineNum">    1544 </span>            :         };</a>
<a name="1545"><span class="lineNum">    1545 </span><span class="lineCov">          4 :         return shape_functions_values;</span></a>
<a name="1546"><span class="lineNum">    1546 </span>            :     }</a>
<a name="1547"><span class="lineNum">    1547 </span>            : </a>
<a name="1548"><span class="lineNum">    1548 </span>            :     /**</a>
<a name="1549"><span class="lineNum">    1549 </span>            :      * TODO: testing</a>
<a name="1550"><span class="lineNum">    1550 </span>            :      */</a>
<a name="1551"><span class="lineNum">    1551 </span>            :     static const ShapeFunctionsLocalGradientsContainerType</a>
<a name="1552"><span class="lineNum">    1552 </span><span class="lineCov">          4 :     AllShapeFunctionsLocalGradients()</span></a>
<a name="1553"><span class="lineNum">    1553 </span>            :     {</a>
<a name="1554"><span class="lineNum">    1554 </span><span class="lineCov">          4 :         ShapeFunctionsLocalGradientsContainerType shape_functions_local_gradients =</span></a>
<a name="1555"><span class="lineNum">    1555 </span>            :         {</a>
<a name="1556"><span class="lineNum">    1556 </span>            :             {</a>
<a name="1557"><span class="lineNum">    1557 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_GAUSS_1 ),</a>
<a name="1558"><span class="lineNum">    1558 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_GAUSS_2 ),</a>
<a name="1559"><span class="lineNum">    1559 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_GAUSS_3 ),</a>
<a name="1560"><span class="lineNum">    1560 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_GAUSS_4 ),</a>
<a name="1561"><span class="lineNum">    1561 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_GAUSS_5 ),</a>
<a name="1562"><span class="lineNum">    1562 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_EXTENDED_GAUSS_1 ),</a>
<a name="1563"><span class="lineNum">    1563 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_EXTENDED_GAUSS_2 ),</a>
<a name="1564"><span class="lineNum">    1564 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_EXTENDED_GAUSS_3 ),</a>
<a name="1565"><span class="lineNum">    1565 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_EXTENDED_GAUSS_4 ),</a>
<a name="1566"><span class="lineNum">    1566 </span>            :                 Triangle2D3&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::GI_EXTENDED_GAUSS_5 ),</a>
<a name="1567"><span class="lineNum">    1567 </span>            :             }</a>
<a name="1568"><span class="lineNum">    1568 </span>            :         };</a>
<a name="1569"><span class="lineNum">    1569 </span><span class="lineCov">          4 :         return shape_functions_local_gradients;</span></a>
<a name="1570"><span class="lineNum">    1570 </span>            :     }</a>
<a name="1571"><span class="lineNum">    1571 </span>            : </a>
<a name="1572"><span class="lineNum">    1572 </span>            : </a>
<a name="1573"><span class="lineNum">    1573 </span>            : //*************************************************************************************</a>
<a name="1574"><span class="lineNum">    1574 </span>            : //*************************************************************************************</a>
<a name="1575"><span class="lineNum">    1575 </span>            : </a>
<a name="1576"><span class="lineNum">    1576 </span>            :     /* Triangle/triangle intersection test routine,</a>
<a name="1577"><span class="lineNum">    1577 </span>            :     * by Tomas Moller, 1997.</a>
<a name="1578"><span class="lineNum">    1578 </span>            :     * See article &quot;A Fast Triangle-Triangle Intersection Test&quot;,</a>
<a name="1579"><span class="lineNum">    1579 </span>            :     * Journal of Graphics Tools, 2(2), 1997</a>
<a name="1580"><span class="lineNum">    1580 </span>            :     *</a>
<a name="1581"><span class="lineNum">    1581 </span>            :     * Updated June 1999: removed the divisions -- a little faster now!</a>
<a name="1582"><span class="lineNum">    1582 </span>            :     * Updated October 1999: added {} to CROSS and SUB macros</a>
<a name="1583"><span class="lineNum">    1583 </span>            :     *</a>
<a name="1584"><span class="lineNum">    1584 </span>            :     * int NoDivTriTriIsect(float V0[3],float V1[3],float V2[3],</a>
<a name="1585"><span class="lineNum">    1585 </span>            :     *                      float U0[3],float U1[3],float U2[3])</a>
<a name="1586"><span class="lineNum">    1586 </span>            :     *</a>
<a name="1587"><span class="lineNum">    1587 </span>            :     * parameters: vertices of triangle 1: V0,V1,V2</a>
<a name="1588"><span class="lineNum">    1588 </span>            :     *             vertices of triangle 2: U0,U1,U2</a>
<a name="1589"><span class="lineNum">    1589 </span>            :     * result    : returns 1 if the triangles intersect, otherwise 0</a>
<a name="1590"><span class="lineNum">    1590 </span>            :     *</a>
<a name="1591"><span class="lineNum">    1591 </span>            :     */</a>
<a name="1592"><span class="lineNum">    1592 </span>            : </a>
<a name="1593"><span class="lineNum">    1593 </span><span class="lineNoCov">          0 :     bool NoDivTriTriIsect( const Point&amp; V0,</span></a>
<a name="1594"><span class="lineNum">    1594 </span>            :                            const Point&amp; V1,</a>
<a name="1595"><span class="lineNum">    1595 </span>            :                            const Point&amp; V2,</a>
<a name="1596"><span class="lineNum">    1596 </span>            :                            const Point&amp; U0,</a>
<a name="1597"><span class="lineNum">    1597 </span>            :                            const Point&amp; U1,</a>
<a name="1598"><span class="lineNum">    1598 </span>            :                            const Point&amp; U2)</a>
<a name="1599"><span class="lineNum">    1599 </span>            :     {</a>
<a name="1600"><span class="lineNum">    1600 </span>            :         short index;</a>
<a name="1601"><span class="lineNum">    1601 </span>            :         double d1,d2;</a>
<a name="1602"><span class="lineNum">    1602 </span>            :         double du0,du1,du2,dv0,dv1,dv2;</a>
<a name="1603"><span class="lineNum">    1603 </span>            :         double du0du1,du0du2,dv0dv1,dv0dv2;</a>
<a name="1604"><span class="lineNum">    1604 </span>            :         double vp0,vp1,vp2;</a>
<a name="1605"><span class="lineNum">    1605 </span>            :         double up0,up1,up2;</a>
<a name="1606"><span class="lineNum">    1606 </span>            :         double bb,cc,max;</a>
<a name="1607"><span class="lineNum">    1607 </span>            :         array_1d&lt;double,2&gt; isect1, isect2;</a>
<a name="1608"><span class="lineNum">    1608 </span>            :         array_1d&lt;double,3&gt; D;</a>
<a name="1609"><span class="lineNum">    1609 </span>            :         array_1d&lt;double,3&gt; E1,E2;</a>
<a name="1610"><span class="lineNum">    1610 </span>            :         array_1d&lt;double,3&gt; N1,N2;</a>
<a name="1611"><span class="lineNum">    1611 </span>            : </a>
<a name="1612"><span class="lineNum">    1612 </span>            : </a>
<a name="1613"><span class="lineNum">    1613 </span>            :         const double epsilon =  1E-6;</a>
<a name="1614"><span class="lineNum">    1614 </span>            : </a>
<a name="1615"><span class="lineNum">    1615 </span>            : // compute plane equation of triangle(V0,V1,V2) //</a>
<a name="1616"><span class="lineNum">    1616 </span><span class="lineNoCov">          0 :         noalias(E1) = V1-V0;</span></a>
<a name="1617"><span class="lineNum">    1617 </span><span class="lineNoCov">          0 :         noalias(E2) = V2-V0;</span></a>
<a name="1618"><span class="lineNum">    1618 </span>            :         MathUtils&lt;double&gt;::CrossProduct(N1, E1, E2);</a>
<a name="1619"><span class="lineNum">    1619 </span>            :         d1=-inner_prod(N1,V0);</a>
<a name="1620"><span class="lineNum">    1620 </span>            : // plane equation 1: N1.X+d1=0 //</a>
<a name="1621"><span class="lineNum">    1621 </span>            : </a>
<a name="1622"><span class="lineNum">    1622 </span>            : // put U0,U1,U2 into plane equation 1 to compute signed distances to the plane//</a>
<a name="1623"><span class="lineNum">    1623 </span><span class="lineNoCov">          0 :         du0=inner_prod(N1,U0)+d1;</span></a>
<a name="1624"><span class="lineNum">    1624 </span><span class="lineNoCov">          0 :         du1=inner_prod(N1,U1)+d1;</span></a>
<a name="1625"><span class="lineNum">    1625 </span><span class="lineNoCov">          0 :         du2=inner_prod(N1,U2)+d1;</span></a>
<a name="1626"><span class="lineNum">    1626 </span>            : </a>
<a name="1627"><span class="lineNum">    1627 </span>            : // coplanarity robustness check //</a>
<a name="1628"><span class="lineNum">    1628 </span><span class="lineNoCov">          0 :         if(fabs(du0)&lt;epsilon) du0=0.0;</span></a>
<a name="1629"><span class="lineNum">    1629 </span><span class="lineNoCov">          0 :         if(fabs(du1)&lt;epsilon) du1=0.0;</span></a>
<a name="1630"><span class="lineNum">    1630 </span><span class="lineNoCov">          0 :         if(fabs(du2)&lt;epsilon) du2=0.0;</span></a>
<a name="1631"><span class="lineNum">    1631 </span>            : </a>
<a name="1632"><span class="lineNum">    1632 </span><span class="lineNoCov">          0 :         du0du1=du0*du1;</span></a>
<a name="1633"><span class="lineNum">    1633 </span><span class="lineNoCov">          0 :         du0du2=du0*du2;</span></a>
<a name="1634"><span class="lineNum">    1634 </span>            : </a>
<a name="1635"><span class="lineNum">    1635 </span><span class="lineNoCov">          0 :         if(du0du1&gt;0.00 &amp;&amp; du0du2&gt;0.00)// same sign on all of them + not equal 0 ? //</span></a>
<a name="1636"><span class="lineNum">    1636 </span>            :             return false;                   // no intersection occurs //</a>
<a name="1637"><span class="lineNum">    1637 </span>            : </a>
<a name="1638"><span class="lineNum">    1638 </span>            : // compute plane of triangle (U0,U1,U2) //</a>
<a name="1639"><span class="lineNum">    1639 </span><span class="lineNoCov">          0 :         noalias(E1) = U1 - U0;</span></a>
<a name="1640"><span class="lineNum">    1640 </span><span class="lineNoCov">          0 :         noalias(E2) = U2 - U0;</span></a>
<a name="1641"><span class="lineNum">    1641 </span>            :         MathUtils&lt;double&gt;::CrossProduct(N2, E1, E2);</a>
<a name="1642"><span class="lineNum">    1642 </span>            :         d2=-inner_prod(N2,U0);</a>
<a name="1643"><span class="lineNum">    1643 </span>            : // plane equation 2: N2.X+d2=0 //</a>
<a name="1644"><span class="lineNum">    1644 </span>            : </a>
<a name="1645"><span class="lineNum">    1645 </span>            : // put V0,V1,V2 into plane equation 2 //</a>
<a name="1646"><span class="lineNum">    1646 </span><span class="lineNoCov">          0 :         dv0=inner_prod(N2,V0)+d2;</span></a>
<a name="1647"><span class="lineNum">    1647 </span><span class="lineNoCov">          0 :         dv1=inner_prod(N2,V1)+d2;</span></a>
<a name="1648"><span class="lineNum">    1648 </span><span class="lineNoCov">          0 :         dv2=inner_prod(N2,V2)+d2;</span></a>
<a name="1649"><span class="lineNum">    1649 </span>            : </a>
<a name="1650"><span class="lineNum">    1650 </span><span class="lineNoCov">          0 :         if(fabs(dv0)&lt;epsilon) dv0=0.0;</span></a>
<a name="1651"><span class="lineNum">    1651 </span><span class="lineNoCov">          0 :         if(fabs(dv1)&lt;epsilon) dv1=0.0;</span></a>
<a name="1652"><span class="lineNum">    1652 </span><span class="lineNoCov">          0 :         if(fabs(dv2)&lt;epsilon) dv2=0.0;</span></a>
<a name="1653"><span class="lineNum">    1653 </span>            : </a>
<a name="1654"><span class="lineNum">    1654 </span><span class="lineNoCov">          0 :         dv0dv1=dv0*dv1;</span></a>
<a name="1655"><span class="lineNum">    1655 </span><span class="lineNoCov">          0 :         dv0dv2=dv0*dv2;</span></a>
<a name="1656"><span class="lineNum">    1656 </span>            : </a>
<a name="1657"><span class="lineNum">    1657 </span><span class="lineNoCov">          0 :         if(dv0dv1&gt;0.00 &amp;&amp; dv0dv2&gt;0.00)// same sign on all of them + not equal 0 ? //</span></a>
<a name="1658"><span class="lineNum">    1658 </span>            :             return false;                   // no intersection occurs //</a>
<a name="1659"><span class="lineNum">    1659 </span>            : </a>
<a name="1660"><span class="lineNum">    1660 </span>            : // compute direction of intersection line //</a>
<a name="1661"><span class="lineNum">    1661 </span>            :         MathUtils&lt;double&gt;::CrossProduct(D, N1, N2);</a>
<a name="1662"><span class="lineNum">    1662 </span>            : </a>
<a name="1663"><span class="lineNum">    1663 </span>            : // compute and index to the largest component of D //</a>
<a name="1664"><span class="lineNum">    1664 </span><span class="lineNoCov">          0 :         max=(double)fabs(D[0]);</span></a>
<a name="1665"><span class="lineNum">    1665 </span>            :         index=0;</a>
<a name="1666"><span class="lineNum">    1666 </span><span class="lineNoCov">          0 :         bb=(double)fabs(D[1]);</span></a>
<a name="1667"><span class="lineNum">    1667 </span><span class="lineNoCov">          0 :         cc=(double)fabs(D[2]);</span></a>
<a name="1668"><span class="lineNum">    1668 </span><span class="lineNoCov">          0 :         if(bb&gt;max)</span></a>
<a name="1669"><span class="lineNum">    1669 </span>            :         {</a>
<a name="1670"><span class="lineNum">    1670 </span>            :             max=bb,index=1;</a>
<a name="1671"><span class="lineNum">    1671 </span>            :         }</a>
<a name="1672"><span class="lineNum">    1672 </span><span class="lineNoCov">          0 :         if(cc&gt;max)</span></a>
<a name="1673"><span class="lineNum">    1673 </span>            :         {</a>
<a name="1674"><span class="lineNum">    1674 </span>            :             max=cc,index=2;</a>
<a name="1675"><span class="lineNum">    1675 </span>            :         }</a>
<a name="1676"><span class="lineNum">    1676 </span>            : </a>
<a name="1677"><span class="lineNum">    1677 </span>            : // this is the simplified projection onto L//</a>
<a name="1678"><span class="lineNum">    1678 </span><span class="lineNoCov">          0 :         vp0=V0[index];</span></a>
<a name="1679"><span class="lineNum">    1679 </span><span class="lineNoCov">          0 :         vp1=V1[index];</span></a>
<a name="1680"><span class="lineNum">    1680 </span><span class="lineNoCov">          0 :         vp2=V2[index];</span></a>
<a name="1681"><span class="lineNum">    1681 </span>            : </a>
<a name="1682"><span class="lineNum">    1682 </span><span class="lineNoCov">          0 :         up0=U0[index];</span></a>
<a name="1683"><span class="lineNum">    1683 </span><span class="lineNoCov">          0 :         up1=U1[index];</span></a>
<a name="1684"><span class="lineNum">    1684 </span><span class="lineNoCov">          0 :         up2=U2[index];</span></a>
<a name="1685"><span class="lineNum">    1685 </span>            : </a>
<a name="1686"><span class="lineNum">    1686 </span>            : </a>
<a name="1687"><span class="lineNum">    1687 </span>            : // compute interval for triangle 1 //</a>
<a name="1688"><span class="lineNum">    1688 </span>            :         double a,b,c,x0,x1;</a>
<a name="1689"><span class="lineNum">    1689 </span><span class="lineNoCov">          0 :         if( New_Compute_Intervals(vp0,vp1,vp2,dv0, dv1,dv2,dv0dv1,dv0dv2, a,b,c,x0,x1)==true )</span></a>
<a name="1690"><span class="lineNum">    1690 </span>            :         {</a>
<a name="1691"><span class="lineNum">    1691 </span><span class="lineNoCov">          0 :             return coplanar_tri_tri(N1,V0,V1,V2,U0,U1,U2);</span></a>
<a name="1692"><span class="lineNum">    1692 </span>            :         }</a>
<a name="1693"><span class="lineNum">    1693 </span>            : </a>
<a name="1694"><span class="lineNum">    1694 </span>            : // compute interval for triangle 2 //</a>
<a name="1695"><span class="lineNum">    1695 </span>            :         double d,e,f,y0,y1;</a>
<a name="1696"><span class="lineNum">    1696 </span><span class="lineNoCov">          0 :         if( New_Compute_Intervals(up0, up1, up2, du0, du1, du2, du0du1, du0du2, d, e, f, y0, y1)==true )</span></a>
<a name="1697"><span class="lineNum">    1697 </span>            :         {</a>
<a name="1698"><span class="lineNum">    1698 </span><span class="lineNoCov">          0 :             return coplanar_tri_tri(N1,V0,V1,V2,U0,U1,U2);</span></a>
<a name="1699"><span class="lineNum">    1699 </span>            :         }</a>
<a name="1700"><span class="lineNum">    1700 </span>            : </a>
<a name="1701"><span class="lineNum">    1701 </span>            : </a>
<a name="1702"><span class="lineNum">    1702 </span>            :         double xx,yy,xxyy,tmp;</a>
<a name="1703"><span class="lineNum">    1703 </span><span class="lineNoCov">          0 :         xx=x0*x1;</span></a>
<a name="1704"><span class="lineNum">    1704 </span><span class="lineNoCov">          0 :         yy=y0*y1;</span></a>
<a name="1705"><span class="lineNum">    1705 </span><span class="lineNoCov">          0 :         xxyy=xx*yy;</span></a>
<a name="1706"><span class="lineNum">    1706 </span>            : </a>
<a name="1707"><span class="lineNum">    1707 </span><span class="lineNoCov">          0 :         tmp=a*xxyy;</span></a>
<a name="1708"><span class="lineNum">    1708 </span><span class="lineNoCov">          0 :         isect1[0]=tmp+b*x1*yy;</span></a>
<a name="1709"><span class="lineNum">    1709 </span><span class="lineNoCov">          0 :         isect1[1]=tmp+c*x0*yy;</span></a>
<a name="1710"><span class="lineNum">    1710 </span>            : </a>
<a name="1711"><span class="lineNum">    1711 </span><span class="lineNoCov">          0 :         tmp=d*xxyy;</span></a>
<a name="1712"><span class="lineNum">    1712 </span><span class="lineNoCov">          0 :         isect2[0]=tmp+e*xx*y1;</span></a>
<a name="1713"><span class="lineNum">    1713 </span><span class="lineNoCov">          0 :         isect2[1]=tmp+f*xx*y0;</span></a>
<a name="1714"><span class="lineNum">    1714 </span>            : </a>
<a name="1715"><span class="lineNum">    1715 </span>            : </a>
<a name="1716"><span class="lineNum">    1716 </span>            :         Sort(isect1[0],isect1[1]);</a>
<a name="1717"><span class="lineNum">    1717 </span>            :         Sort(isect2[0],isect2[1]);</a>
<a name="1718"><span class="lineNum">    1718 </span>            : </a>
<a name="1719"><span class="lineNum">    1719 </span><span class="lineNoCov">          0 :         if(isect1[1]&lt;isect2[0] || isect2[1]&lt;isect1[0]) return false;</span></a>
<a name="1720"><span class="lineNum">    1720 </span>            :         return true;</a>
<a name="1721"><span class="lineNum">    1721 </span>            :     }</a>
<a name="1722"><span class="lineNum">    1722 </span>            : </a>
<a name="1723"><span class="lineNum">    1723 </span>            : </a>
<a name="1724"><span class="lineNum">    1724 </span>            : //*************************************************************************************</a>
<a name="1725"><span class="lineNum">    1725 </span>            : //*************************************************************************************</a>
<a name="1726"><span class="lineNum">    1726 </span>            : </a>
<a name="1727"><span class="lineNum">    1727 </span>            : </a>
<a name="1728"><span class="lineNum">    1728 </span>            : // sort so that a&lt;=b //</a>
<a name="1729"><span class="lineNum">    1729 </span>            :     void Sort(double&amp; a, double&amp; b)</a>
<a name="1730"><span class="lineNum">    1730 </span>            :     {</a>
<a name="1731"><span class="lineNum">    1731 </span><span class="lineNoCov">          0 :         if(a&gt;b)</span></a>
<a name="1732"><span class="lineNum">    1732 </span>            :         {</a>
<a name="1733"><span class="lineNum">    1733 </span>            :             double c;</a>
<a name="1734"><span class="lineNum">    1734 </span>            :             c=a;</a>
<a name="1735"><span class="lineNum">    1735 </span>            :             a=b;</a>
<a name="1736"><span class="lineNum">    1736 </span>            :             b=c;</a>
<a name="1737"><span class="lineNum">    1737 </span>            :         }</a>
<a name="1738"><span class="lineNum">    1738 </span>            :     }</a>
<a name="1739"><span class="lineNum">    1739 </span>            : </a>
<a name="1740"><span class="lineNum">    1740 </span>            : //*************************************************************************************</a>
<a name="1741"><span class="lineNum">    1741 </span>            : //*************************************************************************************</a>
<a name="1742"><span class="lineNum">    1742 </span>            : </a>
<a name="1743"><span class="lineNum">    1743 </span><span class="lineNoCov">          0 :     bool New_Compute_Intervals( double&amp; VV0,</span></a>
<a name="1744"><span class="lineNum">    1744 </span>            :                                 double&amp; VV1,</a>
<a name="1745"><span class="lineNum">    1745 </span>            :                                 double&amp; VV2,</a>
<a name="1746"><span class="lineNum">    1746 </span>            :                                 double&amp; D0,</a>
<a name="1747"><span class="lineNum">    1747 </span>            :                                 double&amp; D1,</a>
<a name="1748"><span class="lineNum">    1748 </span>            :                                 double&amp; D2,</a>
<a name="1749"><span class="lineNum">    1749 </span>            :                                 double&amp; D0D1,</a>
<a name="1750"><span class="lineNum">    1750 </span>            :                                 double&amp; D0D2,</a>
<a name="1751"><span class="lineNum">    1751 </span>            :                                 double&amp; A,</a>
<a name="1752"><span class="lineNum">    1752 </span>            :                                 double&amp; B,</a>
<a name="1753"><span class="lineNum">    1753 </span>            :                                 double&amp; C,</a>
<a name="1754"><span class="lineNum">    1754 </span>            :                                 double&amp; X0,</a>
<a name="1755"><span class="lineNum">    1755 </span>            :                                 double&amp; X1</a>
<a name="1756"><span class="lineNum">    1756 </span>            :                               )</a>
<a name="1757"><span class="lineNum">    1757 </span>            :     {</a>
<a name="1758"><span class="lineNum">    1758 </span><span class="lineNoCov">          0 :         if(D0D1&gt;0.00)</span></a>
<a name="1759"><span class="lineNum">    1759 </span>            :         {</a>
<a name="1760"><span class="lineNum">    1760 </span>            :             // here we know that D0D2&lt;=0.0 //</a>
<a name="1761"><span class="lineNum">    1761 </span>            :             // that is D0, D1 are on the same side, D2 on the other or on the plane //</a>
<a name="1762"><span class="lineNum">    1762 </span><span class="lineNoCov">          0 :             A=VV2;</span></a>
<a name="1763"><span class="lineNum">    1763 </span><span class="lineNoCov">          0 :             B=(VV0-VV2)*D2;</span></a>
<a name="1764"><span class="lineNum">    1764 </span><span class="lineNoCov">          0 :             C=(VV1-VV2)*D2;</span></a>
<a name="1765"><span class="lineNum">    1765 </span><span class="lineNoCov">          0 :             X0=D2-D0;</span></a>
<a name="1766"><span class="lineNum">    1766 </span><span class="lineNoCov">          0 :             X1=D2-D1;</span></a>
<a name="1767"><span class="lineNum">    1767 </span>            :         }</a>
<a name="1768"><span class="lineNum">    1768 </span><span class="lineNoCov">          0 :         else if(D0D2&gt;0.00)</span></a>
<a name="1769"><span class="lineNum">    1769 </span>            :         {</a>
<a name="1770"><span class="lineNum">    1770 </span>            :             // here we know that d0d1&lt;=0.0 //</a>
<a name="1771"><span class="lineNum">    1771 </span><span class="lineNoCov">          0 :             A=VV1;</span></a>
<a name="1772"><span class="lineNum">    1772 </span><span class="lineNoCov">          0 :             B=(VV0-VV1)*D1;</span></a>
<a name="1773"><span class="lineNum">    1773 </span><span class="lineNoCov">          0 :             C=(VV2-VV1)*D1;</span></a>
<a name="1774"><span class="lineNum">    1774 </span><span class="lineNoCov">          0 :             X0=D1-D0;</span></a>
<a name="1775"><span class="lineNum">    1775 </span><span class="lineNoCov">          0 :             X1=D1-D2;</span></a>
<a name="1776"><span class="lineNum">    1776 </span>            :         }</a>
<a name="1777"><span class="lineNum">    1777 </span><span class="lineNoCov">          0 :         else if(D1*D2&gt;0.00 || D0!=0.00)</span></a>
<a name="1778"><span class="lineNum">    1778 </span>            :         {</a>
<a name="1779"><span class="lineNum">    1779 </span>            :             // here we know that d0d1&lt;=0.0 or that D0!=0.0 //</a>
<a name="1780"><span class="lineNum">    1780 </span><span class="lineNoCov">          0 :             A=VV0;</span></a>
<a name="1781"><span class="lineNum">    1781 </span><span class="lineNoCov">          0 :             B=(VV1-VV0)*D0;</span></a>
<a name="1782"><span class="lineNum">    1782 </span><span class="lineNoCov">          0 :             C=(VV2-VV0)*D0;</span></a>
<a name="1783"><span class="lineNum">    1783 </span><span class="lineNoCov">          0 :             X0=D0-D1;</span></a>
<a name="1784"><span class="lineNum">    1784 </span><span class="lineNoCov">          0 :             X1=D0-D2;</span></a>
<a name="1785"><span class="lineNum">    1785 </span>            :         }</a>
<a name="1786"><span class="lineNum">    1786 </span><span class="lineNoCov">          0 :         else if(D1!=0.00)</span></a>
<a name="1787"><span class="lineNum">    1787 </span>            :         {</a>
<a name="1788"><span class="lineNum">    1788 </span><span class="lineNoCov">          0 :             A=VV1;</span></a>
<a name="1789"><span class="lineNum">    1789 </span><span class="lineNoCov">          0 :             B=(VV0-VV1)*D1;</span></a>
<a name="1790"><span class="lineNum">    1790 </span><span class="lineNoCov">          0 :             C=(VV2-VV1)*D1;</span></a>
<a name="1791"><span class="lineNum">    1791 </span><span class="lineNoCov">          0 :             X0=D1-D0;</span></a>
<a name="1792"><span class="lineNum">    1792 </span><span class="lineNoCov">          0 :             X1=D1-D2;</span></a>
<a name="1793"><span class="lineNum">    1793 </span>            :         }</a>
<a name="1794"><span class="lineNum">    1794 </span><span class="lineNoCov">          0 :         else if(D2!=0.00)</span></a>
<a name="1795"><span class="lineNum">    1795 </span>            :         {</a>
<a name="1796"><span class="lineNum">    1796 </span><span class="lineNoCov">          0 :             A=VV2;</span></a>
<a name="1797"><span class="lineNum">    1797 </span><span class="lineNoCov">          0 :             B=(VV0-VV2)*D2;</span></a>
<a name="1798"><span class="lineNum">    1798 </span><span class="lineNoCov">          0 :             C=(VV1-VV2)*D2;</span></a>
<a name="1799"><span class="lineNum">    1799 </span><span class="lineNoCov">          0 :             X0=D2-D0;</span></a>
<a name="1800"><span class="lineNum">    1800 </span><span class="lineNoCov">          0 :             X1=D2-D1;</span></a>
<a name="1801"><span class="lineNum">    1801 </span>            :         }</a>
<a name="1802"><span class="lineNum">    1802 </span>            :         else</a>
<a name="1803"><span class="lineNum">    1803 </span>            :         {</a>
<a name="1804"><span class="lineNum">    1804 </span>            :             ///Triangles are coplanar</a>
<a name="1805"><span class="lineNum">    1805 </span>            :             return true;</a>
<a name="1806"><span class="lineNum">    1806 </span>            :         }</a>
<a name="1807"><span class="lineNum">    1807 </span>            : </a>
<a name="1808"><span class="lineNum">    1808 </span>            :         return false;</a>
<a name="1809"><span class="lineNum">    1809 </span>            : </a>
<a name="1810"><span class="lineNum">    1810 </span>            :     }</a>
<a name="1811"><span class="lineNum">    1811 </span>            : </a>
<a name="1812"><span class="lineNum">    1812 </span>            : //*************************************************************************************</a>
<a name="1813"><span class="lineNum">    1813 </span>            : //*************************************************************************************</a>
<a name="1814"><span class="lineNum">    1814 </span>            : </a>
<a name="1815"><span class="lineNum">    1815 </span><span class="lineNoCov">          0 :     bool coplanar_tri_tri( const array_1d&lt;double, 3&gt;&amp; N,</span></a>
<a name="1816"><span class="lineNum">    1816 </span>            :                            const Point&amp; V0,</a>
<a name="1817"><span class="lineNum">    1817 </span>            :                            const Point&amp; V1,</a>
<a name="1818"><span class="lineNum">    1818 </span>            :                            const Point&amp; V2,</a>
<a name="1819"><span class="lineNum">    1819 </span>            :                            const Point&amp; U0,</a>
<a name="1820"><span class="lineNum">    1820 </span>            :                            const Point&amp; U1,</a>
<a name="1821"><span class="lineNum">    1821 </span>            :                            const Point&amp; U2)</a>
<a name="1822"><span class="lineNum">    1822 </span>            :     {</a>
<a name="1823"><span class="lineNum">    1823 </span>            :         array_1d&lt;double, 3 &gt; A;</a>
<a name="1824"><span class="lineNum">    1824 </span>            :         short i0,i1;</a>
<a name="1825"><span class="lineNum">    1825 </span>            : </a>
<a name="1826"><span class="lineNum">    1826 </span>            :         // first project onto an axis-aligned plane, that maximizes the area //</a>
<a name="1827"><span class="lineNum">    1827 </span>            :         // of the triangles, compute indices: i0,i1. //</a>
<a name="1828"><span class="lineNum">    1828 </span><span class="lineNoCov">          0 :         A[0]=fabs(N[0]);</span></a>
<a name="1829"><span class="lineNum">    1829 </span><span class="lineNoCov">          0 :         A[1]=fabs(N[1]);</span></a>
<a name="1830"><span class="lineNum">    1830 </span><span class="lineNoCov">          0 :         A[2]=fabs(N[2]);</span></a>
<a name="1831"><span class="lineNum">    1831 </span><span class="lineNoCov">          0 :         if(A[0]&gt;A[1])</span></a>
<a name="1832"><span class="lineNum">    1832 </span>            :         {</a>
<a name="1833"><span class="lineNum">    1833 </span><span class="lineNoCov">          0 :             if(A[0]&gt;A[2])</span></a>
<a name="1834"><span class="lineNum">    1834 </span>            :             {</a>
<a name="1835"><span class="lineNum">    1835 </span><span class="lineNoCov">          0 :                 i0=1;      // A[0] is greatest //</span></a>
<a name="1836"><span class="lineNum">    1836 </span><span class="lineNoCov">          0 :                 i1=2;</span></a>
<a name="1837"><span class="lineNum">    1837 </span>            :             }</a>
<a name="1838"><span class="lineNum">    1838 </span>            :             else</a>
<a name="1839"><span class="lineNum">    1839 </span>            :             {</a>
<a name="1840"><span class="lineNum">    1840 </span><span class="lineNoCov">          0 :                 i0=0;      // A[2] is greatest //</span></a>
<a name="1841"><span class="lineNum">    1841 </span><span class="lineNoCov">          0 :                 i1=1;</span></a>
<a name="1842"><span class="lineNum">    1842 </span>            :             }</a>
<a name="1843"><span class="lineNum">    1843 </span>            :         }</a>
<a name="1844"><span class="lineNum">    1844 </span>            :         else   // A[0]&lt;=A[1] //</a>
<a name="1845"><span class="lineNum">    1845 </span>            :         {</a>
<a name="1846"><span class="lineNum">    1846 </span><span class="lineNoCov">          0 :             if(A[2]&gt;A[1])</span></a>
<a name="1847"><span class="lineNum">    1847 </span>            :             {</a>
<a name="1848"><span class="lineNum">    1848 </span><span class="lineNoCov">          0 :                 i0=0;      // A[2] is greatest //</span></a>
<a name="1849"><span class="lineNum">    1849 </span><span class="lineNoCov">          0 :                 i1=1;</span></a>
<a name="1850"><span class="lineNum">    1850 </span>            :             }</a>
<a name="1851"><span class="lineNum">    1851 </span>            :             else</a>
<a name="1852"><span class="lineNum">    1852 </span>            :             {</a>
<a name="1853"><span class="lineNum">    1853 </span><span class="lineNoCov">          0 :                 i0=0;      // A[1] is greatest //</span></a>
<a name="1854"><span class="lineNum">    1854 </span><span class="lineNoCov">          0 :                 i1=2;</span></a>
<a name="1855"><span class="lineNum">    1855 </span>            :             }</a>
<a name="1856"><span class="lineNum">    1856 </span>            :         }</a>
<a name="1857"><span class="lineNum">    1857 </span>            : </a>
<a name="1858"><span class="lineNum">    1858 </span>            :         // test all edges of triangle 1 against the edges of triangle 2 //</a>
<a name="1859"><span class="lineNum">    1859 </span>            :         //std::cout&lt;&lt; &quot;Proof One &quot; &lt;&lt; std::endl;</a>
<a name="1860"><span class="lineNum">    1860 </span><span class="lineNoCov">          0 :         if ( Edge_Against_Tri_Edges(i0, i1, V0,V1,U0,U1,U2)==true) return true;</span></a>
<a name="1861"><span class="lineNum">    1861 </span>            : </a>
<a name="1862"><span class="lineNum">    1862 </span>            :         //std::cout&lt;&lt; &quot;Proof Two &quot; &lt;&lt; std::endl;</a>
<a name="1863"><span class="lineNum">    1863 </span><span class="lineNoCov">          0 :         if ( Edge_Against_Tri_Edges(i0, i1, V1,V2,U0,U1,U2)==true) return true;</span></a>
<a name="1864"><span class="lineNum">    1864 </span>            : </a>
<a name="1865"><span class="lineNum">    1865 </span>            :         //std::cout&lt;&lt; &quot;Proof Three &quot; &lt;&lt; std::endl;</a>
<a name="1866"><span class="lineNum">    1866 </span><span class="lineNoCov">          0 :         if ( Edge_Against_Tri_Edges(i0, i1, V2,V0,U0,U1,U2)==true) return true;</span></a>
<a name="1867"><span class="lineNum">    1867 </span>            : </a>
<a name="1868"><span class="lineNum">    1868 </span>            :         // finally, test if tri1 is totally contained in tri2 or vice versa //</a>
<a name="1869"><span class="lineNum">    1869 </span><span class="lineNoCov">          0 :         if (Point_In_Tri( i0, i1, V0, U0, U1, U2)==true) return true;</span></a>
<a name="1870"><span class="lineNum">    1870 </span><span class="lineNoCov">          0 :         if (Point_In_Tri( i0, i1, U0, V0, V1, V2)==true) return true;</span></a>
<a name="1871"><span class="lineNum">    1871 </span>            : </a>
<a name="1872"><span class="lineNum">    1872 </span>            :         return false;</a>
<a name="1873"><span class="lineNum">    1873 </span>            :     }</a>
<a name="1874"><span class="lineNum">    1874 </span>            : </a>
<a name="1875"><span class="lineNum">    1875 </span>            : //*************************************************************************************</a>
<a name="1876"><span class="lineNum">    1876 </span>            : //*************************************************************************************</a>
<a name="1877"><span class="lineNum">    1877 </span>            : </a>
<a name="1878"><span class="lineNum">    1878 </span><span class="lineNoCov">          0 :     bool Edge_Against_Tri_Edges(const short&amp; i0,</span></a>
<a name="1879"><span class="lineNum">    1879 </span>            :                                 const short&amp; i1,</a>
<a name="1880"><span class="lineNum">    1880 </span>            :                                 const Point&amp; V0,</a>
<a name="1881"><span class="lineNum">    1881 </span>            :                                 const Point&amp; V1,</a>
<a name="1882"><span class="lineNum">    1882 </span>            :                                 const Point&amp;U0,</a>
<a name="1883"><span class="lineNum">    1883 </span>            :                                 const Point&amp;U1,</a>
<a name="1884"><span class="lineNum">    1884 </span>            :                                 const Point&amp;U2)</a>
<a name="1885"><span class="lineNum">    1885 </span>            :     {</a>
<a name="1886"><span class="lineNum">    1886 </span>            : </a>
<a name="1887"><span class="lineNum">    1887 </span>            :         double Ax,Ay,Bx,By,Cx,Cy,e,d,f;</a>
<a name="1888"><span class="lineNum">    1888 </span><span class="lineNoCov">          0 :         Ax=V1[i0]-V0[i0];</span></a>
<a name="1889"><span class="lineNum">    1889 </span><span class="lineNoCov">          0 :         Ay=V1[i1]-V0[i1];</span></a>
<a name="1890"><span class="lineNum">    1890 </span>            :         // test edge U0,U1 against V0,V1 //</a>
<a name="1891"><span class="lineNum">    1891 </span>            : </a>
<a name="1892"><span class="lineNum">    1892 </span>            :         //std::cout&lt;&lt; &quot;Proof One B &quot; &lt;&lt; std::endl;</a>
<a name="1893"><span class="lineNum">    1893 </span><span class="lineNoCov">          0 :         if(Edge_Edge_Test(Ax, Ay, Bx, By, Cx, Cy, e, d, f, i0, i1, V0, U0, U1)==true) return true;</span></a>
<a name="1894"><span class="lineNum">    1894 </span>            :         // test edge U1,U2 against V0,V1 //</a>
<a name="1895"><span class="lineNum">    1895 </span>            :         //std::cout&lt;&lt; &quot;Proof Two B &quot; &lt;&lt; std::endl;</a>
<a name="1896"><span class="lineNum">    1896 </span><span class="lineNoCov">          0 :         if(Edge_Edge_Test(Ax, Ay, Bx, By, Cx, Cy, e, d, f, i0, i1, V0, U1, U2)==true) return true;</span></a>
<a name="1897"><span class="lineNum">    1897 </span>            :         // test edge U2,U1 against V0,V1 //</a>
<a name="1898"><span class="lineNum">    1898 </span><span class="lineNoCov">          0 :         if(Edge_Edge_Test(Ax, Ay, Bx, By, Cx, Cy, e, d, f, i0, i1, V0, U2, U0)==true) return true;</span></a>
<a name="1899"><span class="lineNum">    1899 </span>            : </a>
<a name="1900"><span class="lineNum">    1900 </span>            :         return false;</a>
<a name="1901"><span class="lineNum">    1901 </span>            :     }</a>
<a name="1902"><span class="lineNum">    1902 </span>            : </a>
<a name="1903"><span class="lineNum">    1903 </span>            : </a>
<a name="1904"><span class="lineNum">    1904 </span>            : //*************************************************************************************</a>
<a name="1905"><span class="lineNum">    1905 </span>            : //*************************************************************************************</a>
<a name="1906"><span class="lineNum">    1906 </span>            : </a>
<a name="1907"><span class="lineNum">    1907 </span>            : //   this edge to edge test is based on Franlin Antonio's gem:</a>
<a name="1908"><span class="lineNum">    1908 </span>            : //   &quot;Faster Line Segment Intersection&quot;, in Graphics Gems III,</a>
<a name="1909"><span class="lineNum">    1909 </span>            : //   pp. 199-202</a>
<a name="1910"><span class="lineNum">    1910 </span><span class="lineNoCov">          0 :     bool Edge_Edge_Test(double&amp; Ax,</span></a>
<a name="1911"><span class="lineNum">    1911 </span>            :                         double&amp; Ay,</a>
<a name="1912"><span class="lineNum">    1912 </span>            :                         double&amp; Bx,</a>
<a name="1913"><span class="lineNum">    1913 </span>            :                         double&amp; By,</a>
<a name="1914"><span class="lineNum">    1914 </span>            :                         double&amp; Cx,</a>
<a name="1915"><span class="lineNum">    1915 </span>            :                         double&amp; Cy,</a>
<a name="1916"><span class="lineNum">    1916 </span>            :                         double&amp; e,</a>
<a name="1917"><span class="lineNum">    1917 </span>            :                         double&amp; d,</a>
<a name="1918"><span class="lineNum">    1918 </span>            :                         double&amp; f,</a>
<a name="1919"><span class="lineNum">    1919 </span>            :                         const short&amp; i0,</a>
<a name="1920"><span class="lineNum">    1920 </span>            :                         const short&amp; i1,</a>
<a name="1921"><span class="lineNum">    1921 </span>            :                         const Point&amp;V0,</a>
<a name="1922"><span class="lineNum">    1922 </span>            :                         const Point&amp;U0,</a>
<a name="1923"><span class="lineNum">    1923 </span>            :                         const Point&amp;U1)</a>
<a name="1924"><span class="lineNum">    1924 </span>            :     {</a>
<a name="1925"><span class="lineNum">    1925 </span><span class="lineNoCov">          0 :         Bx=U0[i0]-U1[i0];</span></a>
<a name="1926"><span class="lineNum">    1926 </span><span class="lineNoCov">          0 :         By=U0[i1]-U1[i1];</span></a>
<a name="1927"><span class="lineNum">    1927 </span><span class="lineNoCov">          0 :         Cx=V0[i0]-U0[i0];</span></a>
<a name="1928"><span class="lineNum">    1928 </span><span class="lineNoCov">          0 :         Cy=V0[i1]-U0[i1];</span></a>
<a name="1929"><span class="lineNum">    1929 </span><span class="lineNoCov">          0 :         f=Ay*Bx-Ax*By;</span></a>
<a name="1930"><span class="lineNum">    1930 </span><span class="lineNoCov">          0 :         d=By*Cx-Bx*Cy;</span></a>
<a name="1931"><span class="lineNum">    1931 </span>            : </a>
<a name="1932"><span class="lineNum">    1932 </span><span class="lineNoCov">          0 :         if(std::fabs(f)&lt;1E-10) f = 0.00;</span></a>
<a name="1933"><span class="lineNum">    1933 </span><span class="lineNoCov">          0 :         if(std::fabs(d)&lt;1E-10) d = 0.00;</span></a>
<a name="1934"><span class="lineNum">    1934 </span>            : </a>
<a name="1935"><span class="lineNum">    1935 </span>            : </a>
<a name="1936"><span class="lineNum">    1936 </span><span class="lineNoCov">          0 :         if((f&gt;0.00 &amp;&amp; d&gt;=0.00 &amp;&amp; d&lt;=f) || (f&lt;0.00 &amp;&amp; d&lt;=0.00 &amp;&amp; d&gt;=f))</span></a>
<a name="1937"><span class="lineNum">    1937 </span>            :         {</a>
<a name="1938"><span class="lineNum">    1938 </span><span class="lineNoCov">          0 :             e=Ax*Cy-Ay*Cx;</span></a>
<a name="1939"><span class="lineNum">    1939 </span>            :             //std::cout&lt;&lt; &quot;e =  &quot;&lt;&lt; e &lt;&lt; std::endl;</a>
<a name="1940"><span class="lineNum">    1940 </span><span class="lineNoCov">          0 :             if(f&gt;0.00)</span></a>
<a name="1941"><span class="lineNum">    1941 </span>            :             {</a>
<a name="1942"><span class="lineNum">    1942 </span><span class="lineNoCov">          0 :                 if(e&gt;=0.00 &amp;&amp; e&lt;=f) return true;</span></a>
<a name="1943"><span class="lineNum">    1943 </span>            :             }</a>
<a name="1944"><span class="lineNum">    1944 </span>            :             else</a>
<a name="1945"><span class="lineNum">    1945 </span>            :             {</a>
<a name="1946"><span class="lineNum">    1946 </span><span class="lineNoCov">          0 :                 if(e&lt;=0.00 &amp;&amp; e&gt;=f) return true;</span></a>
<a name="1947"><span class="lineNum">    1947 </span>            :             }</a>
<a name="1948"><span class="lineNum">    1948 </span>            :         }</a>
<a name="1949"><span class="lineNum">    1949 </span>            :         return false;</a>
<a name="1950"><span class="lineNum">    1950 </span>            :     }</a>
<a name="1951"><span class="lineNum">    1951 </span>            : </a>
<a name="1952"><span class="lineNum">    1952 </span>            : //*************************************************************************************</a>
<a name="1953"><span class="lineNum">    1953 </span>            : //*************************************************************************************</a>
<a name="1954"><span class="lineNum">    1954 </span>            : </a>
<a name="1955"><span class="lineNum">    1955 </span>            : </a>
<a name="1956"><span class="lineNum">    1956 </span><span class="lineNoCov">          0 :     bool Point_In_Tri(const short&amp; i0,</span></a>
<a name="1957"><span class="lineNum">    1957 </span>            :                       const short&amp; i1,</a>
<a name="1958"><span class="lineNum">    1958 </span>            :                       const Point&amp; V0,</a>
<a name="1959"><span class="lineNum">    1959 </span>            :                       const Point&amp; U0,</a>
<a name="1960"><span class="lineNum">    1960 </span>            :                       const Point&amp; U1,</a>
<a name="1961"><span class="lineNum">    1961 </span>            :                       const Point&amp; U2)</a>
<a name="1962"><span class="lineNum">    1962 </span>            :     {</a>
<a name="1963"><span class="lineNum">    1963 </span>            :         double a,b,c,d0,d1,d2;</a>
<a name="1964"><span class="lineNum">    1964 </span>            :         // is T1 completly inside T2? //</a>
<a name="1965"><span class="lineNum">    1965 </span>            :         // check if V0 is inside tri(U0,U1,U2) //</a>
<a name="1966"><span class="lineNum">    1966 </span><span class="lineNoCov">          0 :         a=U1[i1]-U0[i1];</span></a>
<a name="1967"><span class="lineNum">    1967 </span><span class="lineNoCov">          0 :         b=-(U1[i0]-U0[i0]);</span></a>
<a name="1968"><span class="lineNum">    1968 </span><span class="lineNoCov">          0 :         c=-a*U0[i0]-b*U0[i1];</span></a>
<a name="1969"><span class="lineNum">    1969 </span><span class="lineNoCov">          0 :         d0=a*V0[i0]+b*V0[i1]+c;</span></a>
<a name="1970"><span class="lineNum">    1970 </span>            : </a>
<a name="1971"><span class="lineNum">    1971 </span><span class="lineNoCov">          0 :         a=U2[i1]-U1[i1];</span></a>
<a name="1972"><span class="lineNum">    1972 </span><span class="lineNoCov">          0 :         b=-(U2[i0]-U1[i0]);</span></a>
<a name="1973"><span class="lineNum">    1973 </span><span class="lineNoCov">          0 :         c=-a*U1[i0]-b*U1[i1];</span></a>
<a name="1974"><span class="lineNum">    1974 </span><span class="lineNoCov">          0 :         d1=a*V0[i0]+b*V0[i1]+c;</span></a>
<a name="1975"><span class="lineNum">    1975 </span>            : </a>
<a name="1976"><span class="lineNum">    1976 </span><span class="lineNoCov">          0 :         a=U0[i1]-U2[i1];</span></a>
<a name="1977"><span class="lineNum">    1977 </span><span class="lineNoCov">          0 :         b=-(U0[i0]-U2[i0]);</span></a>
<a name="1978"><span class="lineNum">    1978 </span><span class="lineNoCov">          0 :         c=-a*U2[i0]-b*U2[i1];</span></a>
<a name="1979"><span class="lineNum">    1979 </span><span class="lineNoCov">          0 :         d2=a*V0[i0]+b*V0[i1]+c;</span></a>
<a name="1980"><span class="lineNum">    1980 </span><span class="lineNoCov">          0 :         if(d0*d1&gt;0.0)</span></a>
<a name="1981"><span class="lineNum">    1981 </span>            :         {</a>
<a name="1982"><span class="lineNum">    1982 </span><span class="lineNoCov">          0 :             if(d0*d2&gt;0.0) return true;</span></a>
<a name="1983"><span class="lineNum">    1983 </span>            :         }</a>
<a name="1984"><span class="lineNum">    1984 </span>            : </a>
<a name="1985"><span class="lineNum">    1985 </span>            :         return false;</a>
<a name="1986"><span class="lineNum">    1986 </span>            :     }</a>
<a name="1987"><span class="lineNum">    1987 </span>            : </a>
<a name="1988"><span class="lineNum">    1988 </span>            : </a>
<a name="1989"><span class="lineNum">    1989 </span>            :     /**</a>
<a name="1990"><span class="lineNum">    1990 </span>            :      * @see HasIntersection</a>
<a name="1991"><span class="lineNum">    1991 </span>            :      * use separating axis theorem to test overlap between triangle and box</a>
<a name="1992"><span class="lineNum">    1992 </span>            :      * need to test for overlap in these directions:</a>
<a name="1993"><span class="lineNum">    1993 </span>            :      * 1) the {x,y,(z)}-directions</a>
<a name="1994"><span class="lineNum">    1994 </span>            :      * 2) normal of the triangle</a>
<a name="1995"><span class="lineNum">    1995 </span>            :      * 3) crossproduct (edge from tri, {x,y,z}-direction) gives 3x3=9 more tests</a>
<a name="1996"><span class="lineNum">    1996 </span>            :      */</a>
<a name="1997"><span class="lineNum">    1997 </span><span class="lineNoCov">          0 :     inline bool TriBoxOverlap(Point&amp; rBoxCenter, Point&amp; rBoxHalfSize)</span></a>
<a name="1998"><span class="lineNum">    1998 </span>            :     {</a>
<a name="1999"><span class="lineNum">    1999 </span>            :         double abs_ex, abs_ey;</a>
<a name="2000"><span class="lineNum">    2000 </span>            :         array_1d&lt;double,3 &gt; vert0, vert1, vert2;</a>
<a name="2001"><span class="lineNum">    2001 </span>            :         array_1d&lt;double,3 &gt; edge0, edge1, edge2;</a>
<a name="2002"><span class="lineNum">    2002 </span>            :         std::pair&lt;double, double&gt; min_max;</a>
<a name="2003"><span class="lineNum">    2003 </span>            : </a>
<a name="2004"><span class="lineNum">    2004 </span>            :         // move everything so that the boxcenter is in (0,0,0)</a>
<a name="2005"><span class="lineNum">    2005 </span><span class="lineNoCov">          0 :         noalias(vert0) = this-&gt;GetPoint(0) - rBoxCenter;</span></a>
<a name="2006"><span class="lineNum">    2006 </span><span class="lineNoCov">          0 :         noalias(vert1) = this-&gt;GetPoint(1) - rBoxCenter;</span></a>
<a name="2007"><span class="lineNum">    2007 </span><span class="lineNoCov">          0 :         noalias(vert2) = this-&gt;GetPoint(2) - rBoxCenter;</span></a>
<a name="2008"><span class="lineNum">    2008 </span>            : </a>
<a name="2009"><span class="lineNum">    2009 </span>            :         // compute triangle edges</a>
<a name="2010"><span class="lineNum">    2010 </span>            :         noalias(edge0) = vert1 - vert0;</a>
<a name="2011"><span class="lineNum">    2011 </span>            :         noalias(edge1) = vert2 - vert1;</a>
<a name="2012"><span class="lineNum">    2012 </span>            :         noalias(edge2) = vert0 - vert2;</a>
<a name="2013"><span class="lineNum">    2013 </span>            : </a>
<a name="2014"><span class="lineNum">    2014 </span>            :         // Bullet 3:</a>
<a name="2015"><span class="lineNum">    2015 </span>            :         //  test the 9 tests first (this was faster)</a>
<a name="2016"><span class="lineNum">    2016 </span>            :         //  We are only interested on z-axis test, which defines the {x,y} plane</a>
<a name="2017"><span class="lineNum">    2017 </span>            :         //  Note that projections onto crossproduct tri-{x,y} are always 0:</a>
<a name="2018"><span class="lineNum">    2018 </span>            :         //    that means there is no separating axis on X,Y-axis tests</a>
<a name="2019"><span class="lineNum">    2019 </span><span class="lineNoCov">          0 :         abs_ex = std::abs(edge0[0]);</span></a>
<a name="2020"><span class="lineNum">    2020 </span><span class="lineNoCov">          0 :         abs_ey = std::abs(edge0[1]);</span></a>
<a name="2021"><span class="lineNum">    2021 </span><span class="lineNoCov">          0 :         if (AxisTestZ(edge0[0],edge0[1],abs_ex,abs_ey,vert0,vert2,rBoxHalfSize)) return false;</span></a>
<a name="2022"><span class="lineNum">    2022 </span>            : </a>
<a name="2023"><span class="lineNum">    2023 </span><span class="lineNoCov">          0 :         abs_ex = std::abs(edge1[0]);</span></a>
<a name="2024"><span class="lineNum">    2024 </span><span class="lineNoCov">          0 :         abs_ey = std::abs(edge1[1]);</span></a>
<a name="2025"><span class="lineNum">    2025 </span><span class="lineNoCov">          0 :         if (AxisTestZ(edge1[0],edge1[1],abs_ex,abs_ey,vert1,vert0,rBoxHalfSize)) return false;</span></a>
<a name="2026"><span class="lineNum">    2026 </span>            : </a>
<a name="2027"><span class="lineNum">    2027 </span><span class="lineNoCov">          0 :         abs_ex = std::abs(edge2[0]);</span></a>
<a name="2028"><span class="lineNum">    2028 </span><span class="lineNoCov">          0 :         abs_ey = std::abs(edge2[1]);</span></a>
<a name="2029"><span class="lineNum">    2029 </span><span class="lineNoCov">          0 :         if (AxisTestZ(edge2[0],edge2[1],abs_ex,abs_ey,vert2,vert1,rBoxHalfSize)) return false;</span></a>
<a name="2030"><span class="lineNum">    2030 </span>            : </a>
<a name="2031"><span class="lineNum">    2031 </span>            :         // Bullet 1:</a>
<a name="2032"><span class="lineNum">    2032 </span>            :         //  first test overlap in the {x,y,(z)}-directions</a>
<a name="2033"><span class="lineNum">    2033 </span>            :         //  find min, max of the triangle each direction, and test for overlap in</a>
<a name="2034"><span class="lineNum">    2034 </span>            :         //  that direction -- this is equivalent to testing a minimal AABB around</a>
<a name="2035"><span class="lineNum">    2035 </span>            :         //  the triangle against the AABB</a>
<a name="2036"><span class="lineNum">    2036 </span>            : </a>
<a name="2037"><span class="lineNum">    2037 </span>            :         // test in X-direction</a>
<a name="2038"><span class="lineNum">    2038 </span><span class="lineNoCov">          0 :         min_max = std::minmax({vert0[0],vert1[0],vert2[0]});</span></a>
<a name="2039"><span class="lineNum">    2039 </span><span class="lineNoCov">          0 :         if(min_max.first&gt;rBoxHalfSize[0] || min_max.second&lt;-rBoxHalfSize[0]) return false;</span></a>
<a name="2040"><span class="lineNum">    2040 </span>            : </a>
<a name="2041"><span class="lineNum">    2041 </span>            :         // test in Y-direction</a>
<a name="2042"><span class="lineNum">    2042 </span><span class="lineNoCov">          0 :         min_max = std::minmax({vert0[1],vert1[1],vert2[1]});</span></a>
<a name="2043"><span class="lineNum">    2043 </span><span class="lineNoCov">          0 :         if(min_max.first&gt;rBoxHalfSize[1] || min_max.second&lt;-rBoxHalfSize[1]) return false;</span></a>
<a name="2044"><span class="lineNum">    2044 </span>            : </a>
<a name="2045"><span class="lineNum">    2045 </span>            :         // test in Z-direction</a>
<a name="2046"><span class="lineNum">    2046 </span>            :         // we do not consider rBoxHalfSize[2] since we are working in 2D</a>
<a name="2047"><span class="lineNum">    2047 </span>            : </a>
<a name="2048"><span class="lineNum">    2048 </span>            :         // Bullet 2:</a>
<a name="2049"><span class="lineNum">    2049 </span>            :         //  test if the box intersects the plane of the triangle</a>
<a name="2050"><span class="lineNum">    2050 </span>            :         //  compute plane equation of triangle: normal*x+d=0</a>
<a name="2051"><span class="lineNum">    2051 </span>            :         //  Triangle and box are on the {x-y} plane, so this test won't return false</a>
<a name="2052"><span class="lineNum">    2052 </span>            : </a>
<a name="2053"><span class="lineNum">    2053 </span>            :         return true;   // box and triangle overlaps</a>
<a name="2054"><span class="lineNum">    2054 </span>            :     }</a>
<a name="2055"><span class="lineNum">    2055 </span>            : </a>
<a name="2056"><span class="lineNum">    2056 </span>            :     /** AxisTestZ</a>
<a name="2057"><span class="lineNum">    2057 </span>            :      * This method returns true if there is a separating axis</a>
<a name="2058"><span class="lineNum">    2058 </span>            :      *</a>
<a name="2059"><span class="lineNum">    2059 </span>            :      * @param rEdgeX, rEdgeY i-edge corrdinates</a>
<a name="2060"><span class="lineNum">    2060 </span>            :      * @param rAbsEdgeX, rAbsEdgeY i-edge abs coordinates</a>
<a name="2061"><span class="lineNum">    2061 </span>            :      * @param rVertA i   vertex</a>
<a name="2062"><span class="lineNum">    2062 </span>            :      * @param rVertB i+1 vertex (omitted, proj_a = proj_b)</a>
<a name="2063"><span class="lineNum">    2063 </span>            :      * @param rVertC i+2 vertex</a>
<a name="2064"><span class="lineNum">    2064 </span>            :      * @param rBoxHalfSize</a>
<a name="2065"><span class="lineNum">    2065 </span>            :      */</a>
<a name="2066"><span class="lineNum">    2066 </span><span class="lineNoCov">          0 :     bool AxisTestZ(double&amp; rEdgeX, double&amp; rEdgeY,</span></a>
<a name="2067"><span class="lineNum">    2067 </span>            :                    double&amp; rAbsEdgeX, double&amp; rAbsEdgeY,</a>
<a name="2068"><span class="lineNum">    2068 </span>            :                    array_1d&lt;double,3&gt;&amp; rVertA,</a>
<a name="2069"><span class="lineNum">    2069 </span>            :                    array_1d&lt;double,3&gt;&amp; rVertC,</a>
<a name="2070"><span class="lineNum">    2070 </span>            :                    Point&amp; rBoxHalfSize)</a>
<a name="2071"><span class="lineNum">    2071 </span>            :     {</a>
<a name="2072"><span class="lineNum">    2072 </span>            :         double proj_a, proj_c, rad;</a>
<a name="2073"><span class="lineNum">    2073 </span><span class="lineNoCov">          0 :         proj_a = rEdgeX*rVertA[1] - rEdgeY*rVertA[0];</span></a>
<a name="2074"><span class="lineNum">    2074 </span><span class="lineNoCov">          0 :         proj_c = rEdgeX*rVertC[1] - rEdgeY*rVertC[0];</span></a>
<a name="2075"><span class="lineNum">    2075 </span>            :         std::pair&lt;double, double&gt; min_max = std::minmax(proj_a, proj_c);</a>
<a name="2076"><span class="lineNum">    2076 </span>            : </a>
<a name="2077"><span class="lineNum">    2077 </span><span class="lineNoCov">          0 :         rad = rAbsEdgeY*rBoxHalfSize[0] + rAbsEdgeX*rBoxHalfSize[1];</span></a>
<a name="2078"><span class="lineNum">    2078 </span>            : </a>
<a name="2079"><span class="lineNum">    2079 </span><span class="lineNoCov">          0 :         if(min_max.first&gt;rad || min_max.second&lt;-rad) return true;</span></a>
<a name="2080"><span class="lineNum">    2080 </span><span class="lineNoCov">          0 :         else return false;</span></a>
<a name="2081"><span class="lineNum">    2081 </span>            :     }</a>
<a name="2082"><span class="lineNum">    2082 </span>            : </a>
<a name="2083"><span class="lineNum">    2083 </span>            :     /** Implements the calculus of the semiperimeter</a>
<a name="2084"><span class="lineNum">    2084 </span>            :      * Implements the calculus of the semiperimeter of the geometry edges.</a>
<a name="2085"><span class="lineNum">    2085 </span>            :      *</a>
<a name="2086"><span class="lineNum">    2086 </span>            :      * @param  a Squared length of the edge a</a>
<a name="2087"><span class="lineNum">    2087 </span>            :      * @param  b Squared length of the edge b</a>
<a name="2088"><span class="lineNum">    2088 </span>            :      * @param  c Squared length of the edge c</a>
<a name="2089"><span class="lineNum">    2089 </span>            :      *</a>
<a name="2090"><span class="lineNum">    2090 </span>            :      * @return   The semiperimeter of the geometry with edges a,b,c</a>
<a name="2091"><span class="lineNum">    2091 </span>            :      */</a>
<a name="2092"><span class="lineNum">    2092 </span>            :     inline double CalculateSemiperimeter(const double a, const double b, const double c) const {</a>
<a name="2093"><span class="lineNum">    2093 </span><span class="lineNoCov">          0 :       return 0.5 * (a+b+c);</span></a>
<a name="2094"><span class="lineNum">    2094 </span>            :     }</a>
<a name="2095"><span class="lineNum">    2095 </span>            : </a>
<a name="2096"><span class="lineNum">    2096 </span>            :     /** Implements the calculus of the minimum edge length</a>
<a name="2097"><span class="lineNum">    2097 </span>            :      * Implements the calculus of the minimum edge length given the length of the geometry edges.</a>
<a name="2098"><span class="lineNum">    2098 </span>            :      *</a>
<a name="2099"><span class="lineNum">    2099 </span>            :      * @param  a Squared length of the edge a</a>
<a name="2100"><span class="lineNum">    2100 </span>            :      * @param  b Squared length of the edge b</a>
<a name="2101"><span class="lineNum">    2101 </span>            :      * @param  c Squared length of the edge c</a>
<a name="2102"><span class="lineNum">    2102 </span>            :      *</a>
<a name="2103"><span class="lineNum">    2103 </span>            :      * @return   The minimum edge length of the geometry with edges a,b,c</a>
<a name="2104"><span class="lineNum">    2104 </span>            :      */</a>
<a name="2105"><span class="lineNum">    2105 </span><span class="lineNoCov">          0 :     inline double CalculateMinEdgeLength(const double sa, const double sb, const double sc) const {</span></a>
<a name="2106"><span class="lineNum">    2106 </span><span class="lineNoCov">          0 :       return std::sqrt(std::min({sa, sb, sc}));</span></a>
<a name="2107"><span class="lineNum">    2107 </span>            :     }</a>
<a name="2108"><span class="lineNum">    2108 </span>            : </a>
<a name="2109"><span class="lineNum">    2109 </span>            :     /** Implements the calculus of the maximum edge length</a>
<a name="2110"><span class="lineNum">    2110 </span>            :      * Implements the calculus of the maximum edge length given the length of the geometry edges.</a>
<a name="2111"><span class="lineNum">    2111 </span>            :      *</a>
<a name="2112"><span class="lineNum">    2112 </span>            :      * @param  a Squared length of the edge a</a>
<a name="2113"><span class="lineNum">    2113 </span>            :      * @param  b Squared length of the edge b</a>
<a name="2114"><span class="lineNum">    2114 </span>            :      * @param  c Squared length of the edge c</a>
<a name="2115"><span class="lineNum">    2115 </span>            :      *</a>
<a name="2116"><span class="lineNum">    2116 </span>            :      * @return   The maximum edge length of the geometry with edges a,b,c</a>
<a name="2117"><span class="lineNum">    2117 </span>            :      */</a>
<a name="2118"><span class="lineNum">    2118 </span><span class="lineNoCov">          0 :     inline double CalculateMaxEdgeLength(const double sa, const double sb, const double sc) const {</span></a>
<a name="2119"><span class="lineNum">    2119 </span><span class="lineNoCov">          0 :       return std::sqrt(std::max({sa, sb, sc}));</span></a>
<a name="2120"><span class="lineNum">    2120 </span>            :     }</a>
<a name="2121"><span class="lineNum">    2121 </span>            : </a>
<a name="2122"><span class="lineNum">    2122 </span>            :     /** Implements the calculus of the average edge length</a>
<a name="2123"><span class="lineNum">    2123 </span>            :      * Implements the calculus of the average edge length given the length of the geometry edges.</a>
<a name="2124"><span class="lineNum">    2124 </span>            :      *</a>
<a name="2125"><span class="lineNum">    2125 </span>            :      * @param  a Length of the edge a</a>
<a name="2126"><span class="lineNum">    2126 </span>            :      * @param  b Length of the edge b</a>
<a name="2127"><span class="lineNum">    2127 </span>            :      * @param  c Length of the edge c</a>
<a name="2128"><span class="lineNum">    2128 </span>            :      *</a>
<a name="2129"><span class="lineNum">    2129 </span>            :      * @return   The average edge length of the geometry with edges a,b,c</a>
<a name="2130"><span class="lineNum">    2130 </span>            :      */</a>
<a name="2131"><span class="lineNum">    2131 </span>            :     inline double CalculateAvgEdgeLength(const double a, const double b, const double c) const {</a>
<a name="2132"><span class="lineNum">    2132 </span><span class="lineNoCov">          0 :       return 1.0 / 3.0 * (a+b+c);</span></a>
<a name="2133"><span class="lineNum">    2133 </span>            :     }</a>
<a name="2134"><span class="lineNum">    2134 </span>            : </a>
<a name="2135"><span class="lineNum">    2135 </span>            :     /** Implements the calculus of the inradius</a>
<a name="2136"><span class="lineNum">    2136 </span>            :      * Implements the calculus of the inradius given the length of the geometry edges.</a>
<a name="2137"><span class="lineNum">    2137 </span>            :      *</a>
<a name="2138"><span class="lineNum">    2138 </span>            :      * @param  a Length of the edge a</a>
<a name="2139"><span class="lineNum">    2139 </span>            :      * @param  b Length of the edge b</a>
<a name="2140"><span class="lineNum">    2140 </span>            :      * @param  c Length of the edge c</a>
<a name="2141"><span class="lineNum">    2141 </span>            :      *</a>
<a name="2142"><span class="lineNum">    2142 </span>            :      * @return   The inradius of the geometry with edges a,b,c</a>
<a name="2143"><span class="lineNum">    2143 </span>            :      */</a>
<a name="2144"><span class="lineNum">    2144 </span><span class="lineNoCov">          0 :     inline double CalculateInradius(const double a, const double b, const double c) const {</span></a>
<a name="2145"><span class="lineNum">    2145 </span><span class="lineNoCov">          0 :       return 0.5 * std::sqrt((b+c-a) * (c+a-b) * (a+b-c) / (a+b+c));</span></a>
<a name="2146"><span class="lineNum">    2146 </span>            :     }</a>
<a name="2147"><span class="lineNum">    2147 </span>            : </a>
<a name="2148"><span class="lineNum">    2148 </span>            :     /** Implements the calculus of the circumradius</a>
<a name="2149"><span class="lineNum">    2149 </span>            :      * Implements the calculus of the circumradius given the length of the geometry edges.</a>
<a name="2150"><span class="lineNum">    2150 </span>            :      *</a>
<a name="2151"><span class="lineNum">    2151 </span>            :      * @param  a Length of the edge a</a>
<a name="2152"><span class="lineNum">    2152 </span>            :      * @param  b Length of the edge b</a>
<a name="2153"><span class="lineNum">    2153 </span>            :      * @param  c Length of the edge c</a>
<a name="2154"><span class="lineNum">    2154 </span>            :      *</a>
<a name="2155"><span class="lineNum">    2155 </span>            :      * @return   The circumradius of the geometry with edges a,b,c</a>
<a name="2156"><span class="lineNum">    2156 </span>            :      */</a>
<a name="2157"><span class="lineNum">    2157 </span><span class="lineNoCov">          0 :     inline double CalculateCircumradius(const double a, const double b, const double c) const {</span></a>
<a name="2158"><span class="lineNum">    2158 </span><span class="lineNoCov">          0 :       return (a*b*c) / std::sqrt((a+b+c) * (b+c-a) * (c+a-b) * (a+b-c));</span></a>
<a name="2159"><span class="lineNum">    2159 </span>            :     }</a>
<a name="2160"><span class="lineNum">    2160 </span>            : </a>
<a name="2161"><span class="lineNum">    2161 </span>            :     ///@}</a>
<a name="2162"><span class="lineNum">    2162 </span>            :     ///@name Private  Access</a>
<a name="2163"><span class="lineNum">    2163 </span>            :     ///@{</a>
<a name="2164"><span class="lineNum">    2164 </span>            : </a>
<a name="2165"><span class="lineNum">    2165 </span>            : </a>
<a name="2166"><span class="lineNum">    2166 </span>            :     ///@}</a>
<a name="2167"><span class="lineNum">    2167 </span>            :     ///@name Private Inquiry</a>
<a name="2168"><span class="lineNum">    2168 </span>            :     ///@{</a>
<a name="2169"><span class="lineNum">    2169 </span>            : </a>
<a name="2170"><span class="lineNum">    2170 </span>            : </a>
<a name="2171"><span class="lineNum">    2171 </span>            :     ///@}</a>
<a name="2172"><span class="lineNum">    2172 </span>            :     ///@name Private Friends</a>
<a name="2173"><span class="lineNum">    2173 </span>            :     ///@{</a>
<a name="2174"><span class="lineNum">    2174 </span>            : </a>
<a name="2175"><span class="lineNum">    2175 </span>            :     template&lt;class TOtherPointType&gt; friend class Triangle2D3;</a>
<a name="2176"><span class="lineNum">    2176 </span>            : </a>
<a name="2177"><span class="lineNum">    2177 </span>            :     ///@}</a>
<a name="2178"><span class="lineNum">    2178 </span>            :     ///@name Un accessible methods</a>
<a name="2179"><span class="lineNum">    2179 </span>            :     ///@{</a>
<a name="2180"><span class="lineNum">    2180 </span>            : </a>
<a name="2181"><span class="lineNum">    2181 </span>            : </a>
<a name="2182"><span class="lineNum">    2182 </span>            :     ///@}</a>
<a name="2183"><span class="lineNum">    2183 </span>            : }; // Class Geometry</a>
<a name="2184"><span class="lineNum">    2184 </span>            : </a>
<a name="2185"><span class="lineNum">    2185 </span>            : ///@}</a>
<a name="2186"><span class="lineNum">    2186 </span>            : ///@name Type Definitions</a>
<a name="2187"><span class="lineNum">    2187 </span>            : ///@{</a>
<a name="2188"><span class="lineNum">    2188 </span>            : </a>
<a name="2189"><span class="lineNum">    2189 </span>            : </a>
<a name="2190"><span class="lineNum">    2190 </span>            : ///@}</a>
<a name="2191"><span class="lineNum">    2191 </span>            : ///@name Input and output</a>
<a name="2192"><span class="lineNum">    2192 </span>            : ///@{</a>
<a name="2193"><span class="lineNum">    2193 </span>            : /**</a>
<a name="2194"><span class="lineNum">    2194 </span>            :  * input stream functions</a>
<a name="2195"><span class="lineNum">    2195 </span>            :  */</a>
<a name="2196"><span class="lineNum">    2196 </span>            : template&lt;class TPointType&gt; inline std::istream&amp; operator &gt;&gt; (</a>
<a name="2197"><span class="lineNum">    2197 </span>            :     std::istream&amp; rIStream,</a>
<a name="2198"><span class="lineNum">    2198 </span>            :     Triangle2D3&lt;TPointType&gt;&amp; rThis );</a>
<a name="2199"><span class="lineNum">    2199 </span>            : /**</a>
<a name="2200"><span class="lineNum">    2200 </span>            :  * output stream functions</a>
<a name="2201"><span class="lineNum">    2201 </span>            :  */</a>
<a name="2202"><span class="lineNum">    2202 </span><span class="lineNoCov">          0 : template&lt;class TPointType&gt; inline std::ostream&amp; operator &lt;&lt; (</span></a>
<a name="2203"><span class="lineNum">    2203 </span>            :     std::ostream&amp; rOStream,</a>
<a name="2204"><span class="lineNum">    2204 </span>            :     const Triangle2D3&lt;TPointType&gt;&amp; rThis )</a>
<a name="2205"><span class="lineNum">    2205 </span>            : {</a>
<a name="2206"><span class="lineNum">    2206 </span><span class="lineNoCov">          0 :     rThis.PrintInfo( rOStream );</span></a>
<a name="2207"><span class="lineNum">    2207 </span>            :     rOStream &lt;&lt; std::endl;</a>
<a name="2208"><span class="lineNum">    2208 </span><span class="lineNoCov">          0 :     rThis.PrintData( rOStream );</span></a>
<a name="2209"><span class="lineNum">    2209 </span><span class="lineNoCov">          0 :     return rOStream;</span></a>
<a name="2210"><span class="lineNum">    2210 </span>            : }</a>
<a name="2211"><span class="lineNum">    2211 </span>            : </a>
<a name="2212"><span class="lineNum">    2212 </span>            : ///@}</a>
<a name="2213"><span class="lineNum">    2213 </span>            : </a>
<a name="2214"><span class="lineNum">    2214 </span>            : template&lt;class TPointType&gt; const</a>
<a name="2215"><span class="lineNum">    2215 </span>            : GeometryData Triangle2D3&lt;TPointType&gt;::msGeometryData(</a>
<a name="2216"><span class="lineNum">    2216 </span>            :     &amp;msGeometryDimension,</a>
<a name="2217"><span class="lineNum">    2217 </span>            :     GeometryData::GI_GAUSS_1,</a>
<a name="2218"><span class="lineNum">    2218 </span>            :     Triangle2D3&lt;TPointType&gt;::AllIntegrationPoints(),</a>
<a name="2219"><span class="lineNum">    2219 </span>            :     Triangle2D3&lt;TPointType&gt;::AllShapeFunctionsValues(),</a>
<a name="2220"><span class="lineNum">    2220 </span>            :     AllShapeFunctionsLocalGradients()</a>
<a name="2221"><span class="lineNum">    2221 </span>            : );</a>
<a name="2222"><span class="lineNum">    2222 </span>            : </a>
<a name="2223"><span class="lineNum">    2223 </span>            : template&lt;class TPointType&gt; const</a>
<a name="2224"><span class="lineNum">    2224 </span>            : GeometryDimension Triangle2D3&lt;TPointType&gt;::msGeometryDimension(</a>
<a name="2225"><span class="lineNum">    2225 </span>            :     2, 2, 2);</a>
<a name="2226"><span class="lineNum">    2226 </span>            : </a>
<a name="2227"><span class="lineNum">    2227 </span>            : }// namespace Kratos.</a>
<a name="2228"><span class="lineNum">    2228 </span>            : </a>
<a name="2229"><span class="lineNum">    2229 </span>            : #endif // KRATOS_TRIANGLE_2D_3_H_INCLUDED  defined</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
