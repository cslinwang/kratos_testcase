<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - kratos/geometries/triangle_3d_6.h</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">kratos/geometries</a> - triangle_3d_6.h<span style="font-size: 80%;"> (source / <a href="triangle_3d_6.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">51</td>
            <td class="headerCovTableEntry">253</td>
            <td class="headerCovTableEntryLo">20.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2023-08-10 04:44:37</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">7</td>
            <td class="headerCovTableEntry">37</td>
            <td class="headerCovTableEntryLo">18.9 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : //    |  /           |</a>
<a name="2"><span class="lineNum">       2 </span>            : //    ' /   __| _` | __|  _ \   __|</a>
<a name="3"><span class="lineNum">       3 </span>            : //    . \  |   (   | |   (   |\__ `</a>
<a name="4"><span class="lineNum">       4 </span>            : //   _|\_\_|  \__,_|\__|\___/ ____/</a>
<a name="5"><span class="lineNum">       5 </span>            : //                   Multi-Physics</a>
<a name="6"><span class="lineNum">       6 </span>            : //</a>
<a name="7"><span class="lineNum">       7 </span>            : //  License:         BSD License</a>
<a name="8"><span class="lineNum">       8 </span>            : //                   Kratos default license: kratos/license.txt</a>
<a name="9"><span class="lineNum">       9 </span>            : //</a>
<a name="10"><span class="lineNum">      10 </span>            : //  Main authors:    Riccardo Rossi</a>
<a name="11"><span class="lineNum">      11 </span>            : //                   Janosch Stascheit</a>
<a name="12"><span class="lineNum">      12 </span>            : //                   Felix Nagel</a>
<a name="13"><span class="lineNum">      13 </span>            : //  contributors:    Hoang Giang Bui</a>
<a name="14"><span class="lineNum">      14 </span>            : //                   Josep Maria Carbonell</a>
<a name="15"><span class="lineNum">      15 </span>            : //</a>
<a name="16"><span class="lineNum">      16 </span>            : </a>
<a name="17"><span class="lineNum">      17 </span>            : #pragma once</a>
<a name="18"><span class="lineNum">      18 </span>            : </a>
<a name="19"><span class="lineNum">      19 </span>            : // System includes</a>
<a name="20"><span class="lineNum">      20 </span>            : </a>
<a name="21"><span class="lineNum">      21 </span>            : // External includes</a>
<a name="22"><span class="lineNum">      22 </span>            : </a>
<a name="23"><span class="lineNum">      23 </span>            : // Project includes</a>
<a name="24"><span class="lineNum">      24 </span>            : #include &quot;geometries/line_3d_3.h&quot;</a>
<a name="25"><span class="lineNum">      25 </span>            : #include &quot;integration/triangle_gauss_legendre_integration_points.h&quot;</a>
<a name="26"><span class="lineNum">      26 </span>            : </a>
<a name="27"><span class="lineNum">      27 </span>            : namespace Kratos</a>
<a name="28"><span class="lineNum">      28 </span>            : {</a>
<a name="29"><span class="lineNum">      29 </span>            : ///@name Kratos Globals</a>
<a name="30"><span class="lineNum">      30 </span>            : ///@{</a>
<a name="31"><span class="lineNum">      31 </span>            : </a>
<a name="32"><span class="lineNum">      32 </span>            : ///@}</a>
<a name="33"><span class="lineNum">      33 </span>            : ///@name Type Definitions</a>
<a name="34"><span class="lineNum">      34 </span>            : ///@{</a>
<a name="35"><span class="lineNum">      35 </span>            : </a>
<a name="36"><span class="lineNum">      36 </span>            : ///@}</a>
<a name="37"><span class="lineNum">      37 </span>            : ///@name  Enum's</a>
<a name="38"><span class="lineNum">      38 </span>            : ///@{</a>
<a name="39"><span class="lineNum">      39 </span>            : </a>
<a name="40"><span class="lineNum">      40 </span>            : ///@}</a>
<a name="41"><span class="lineNum">      41 </span>            : ///@name  Functions</a>
<a name="42"><span class="lineNum">      42 </span>            : ///@{</a>
<a name="43"><span class="lineNum">      43 </span>            : </a>
<a name="44"><span class="lineNum">      44 </span>            : ///@}</a>
<a name="45"><span class="lineNum">      45 </span>            : ///@name Kratos Classes</a>
<a name="46"><span class="lineNum">      46 </span>            : ///@{</a>
<a name="47"><span class="lineNum">      47 </span>            : </a>
<a name="48"><span class="lineNum">      48 </span>            : /**</a>
<a name="49"><span class="lineNum">      49 </span>            :  * @class Triangle3D6</a>
<a name="50"><span class="lineNum">      50 </span>            :  * @ingroup KratosCore</a>
<a name="51"><span class="lineNum">      51 </span>            :  * @brief A six node 3D triangular geometry with quadratic shape functions</a>
<a name="52"><span class="lineNum">      52 </span>            :  * @details While the shape functions are only defined in 2D it is possible to define an arbitrary orientation in space. Thus it can be used for defining surfaces on 3D elements.</a>
<a name="53"><span class="lineNum">      53 </span>            :  * The node ordering corresponds with:</a>
<a name="54"><span class="lineNum">      54 </span>            :  *          2</a>
<a name="55"><span class="lineNum">      55 </span>            :  *          |`\</a>
<a name="56"><span class="lineNum">      56 </span>            :  *          |  `\</a>
<a name="57"><span class="lineNum">      57 </span>            :  *          5    `4</a>
<a name="58"><span class="lineNum">      58 </span>            :  *          |      `\</a>
<a name="59"><span class="lineNum">      59 </span>            :  *          |        `\</a>
<a name="60"><span class="lineNum">      60 </span>            :  *          0-----3----1</a>
<a name="61"><span class="lineNum">      61 </span>            :  * @author Riccardo Rossi</a>
<a name="62"><span class="lineNum">      62 </span>            :  * @author Janosch Stascheit</a>
<a name="63"><span class="lineNum">      63 </span>            :  * @author Felix Nagel</a>
<a name="64"><span class="lineNum">      64 </span>            :  */</a>
<a name="65"><span class="lineNum">      65 </span>            : template&lt;class TPointType&gt; class Triangle3D6</a>
<a name="66"><span class="lineNum">      66 </span>            :     : public Geometry&lt;TPointType&gt;</a>
<a name="67"><span class="lineNum">      67 </span>            : {</a>
<a name="68"><span class="lineNum">      68 </span>            : public:</a>
<a name="69"><span class="lineNum">      69 </span>            :     ///@}</a>
<a name="70"><span class="lineNum">      70 </span>            :     ///@name Type Definitions</a>
<a name="71"><span class="lineNum">      71 </span>            :     ///@{</a>
<a name="72"><span class="lineNum">      72 </span>            : </a>
<a name="73"><span class="lineNum">      73 </span>            :     /**</a>
<a name="74"><span class="lineNum">      74 </span>            :      * Geometry as base class.</a>
<a name="75"><span class="lineNum">      75 </span>            :      */</a>
<a name="76"><span class="lineNum">      76 </span>            :     typedef Geometry&lt;TPointType&gt; BaseType;</a>
<a name="77"><span class="lineNum">      77 </span>            : </a>
<a name="78"><span class="lineNum">      78 </span>            :     /**</a>
<a name="79"><span class="lineNum">      79 </span>            :      * Type of edge geometry</a>
<a name="80"><span class="lineNum">      80 </span>            :      */</a>
<a name="81"><span class="lineNum">      81 </span>            :     typedef Line3D3&lt;TPointType&gt; EdgeType;</a>
<a name="82"><span class="lineNum">      82 </span>            : </a>
<a name="83"><span class="lineNum">      83 </span>            :     /**</a>
<a name="84"><span class="lineNum">      84 </span>            :      * Pointer definition of Triangle3D6</a>
<a name="85"><span class="lineNum">      85 </span>            :      */</a>
<a name="86"><span class="lineNum">      86 </span>            :     KRATOS_CLASS_POINTER_DEFINITION( Triangle3D6 );</a>
<a name="87"><span class="lineNum">      87 </span>            : </a>
<a name="88"><span class="lineNum">      88 </span>            :     /**</a>
<a name="89"><span class="lineNum">      89 </span>            :      * Integration methods implemented in geometry.</a>
<a name="90"><span class="lineNum">      90 </span>            :      */</a>
<a name="91"><span class="lineNum">      91 </span>            :     typedef GeometryData::IntegrationMethod IntegrationMethod;</a>
<a name="92"><span class="lineNum">      92 </span>            : </a>
<a name="93"><span class="lineNum">      93 </span>            :     /**</a>
<a name="94"><span class="lineNum">      94 </span>            :      * A Vector of counted pointers to Geometries.</a>
<a name="95"><span class="lineNum">      95 </span>            :      * Used for returning edges of the geometry.</a>
<a name="96"><span class="lineNum">      96 </span>            :      */</a>
<a name="97"><span class="lineNum">      97 </span>            :     typedef typename BaseType::GeometriesArrayType GeometriesArrayType;</a>
<a name="98"><span class="lineNum">      98 </span>            : </a>
<a name="99"><span class="lineNum">      99 </span>            :     /**</a>
<a name="100"><span class="lineNum">     100 </span>            :      * Redefinition of template parameter TPointType.</a>
<a name="101"><span class="lineNum">     101 </span>            :      */</a>
<a name="102"><span class="lineNum">     102 </span>            :     typedef TPointType PointType;</a>
<a name="103"><span class="lineNum">     103 </span>            : </a>
<a name="104"><span class="lineNum">     104 </span>            :     /**</a>
<a name="105"><span class="lineNum">     105 </span>            :      * Type used for indexing in geometry class.</a>
<a name="106"><span class="lineNum">     106 </span>            :      * std::size_t used for indexing</a>
<a name="107"><span class="lineNum">     107 </span>            :      * point or integration point access methods and also all other</a>
<a name="108"><span class="lineNum">     108 </span>            :      * methods which need point or integration point index.</a>
<a name="109"><span class="lineNum">     109 </span>            :      */</a>
<a name="110"><span class="lineNum">     110 </span>            :     typedef typename BaseType::IndexType IndexType;</a>
<a name="111"><span class="lineNum">     111 </span>            : </a>
<a name="112"><span class="lineNum">     112 </span>            :     /**</a>
<a name="113"><span class="lineNum">     113 </span>            :      * This type is used to return size or dimension in</a>
<a name="114"><span class="lineNum">     114 </span>            :      * geometry. Dimension, WorkingDimension, PointsNumber and</a>
<a name="115"><span class="lineNum">     115 </span>            :      * ... return this type as their results.</a>
<a name="116"><span class="lineNum">     116 </span>            :      */</a>
<a name="117"><span class="lineNum">     117 </span>            :     typedef typename BaseType::SizeType SizeType;</a>
<a name="118"><span class="lineNum">     118 </span>            : </a>
<a name="119"><span class="lineNum">     119 </span>            :     /**</a>
<a name="120"><span class="lineNum">     120 </span>            :      * Array of counted pointers to point.</a>
<a name="121"><span class="lineNum">     121 </span>            :      * This type used to hold geometry's points.</a>
<a name="122"><span class="lineNum">     122 </span>            :      */</a>
<a name="123"><span class="lineNum">     123 </span>            :     typedef  typename BaseType::PointsArrayType PointsArrayType;</a>
<a name="124"><span class="lineNum">     124 </span>            : </a>
<a name="125"><span class="lineNum">     125 </span>            :     /**</a>
<a name="126"><span class="lineNum">     126 </span>            :      * Array of coordinates. Can be Nodes, Points or IntegrationPoints</a>
<a name="127"><span class="lineNum">     127 </span>            :      */</a>
<a name="128"><span class="lineNum">     128 </span>            :     typedef typename BaseType::CoordinatesArrayType CoordinatesArrayType;</a>
<a name="129"><span class="lineNum">     129 </span>            : </a>
<a name="130"><span class="lineNum">     130 </span>            :     /**</a>
<a name="131"><span class="lineNum">     131 </span>            :      * This type used for representing an integration point in geometry.</a>
<a name="132"><span class="lineNum">     132 </span>            :      * This integration point is a point with an additional weight component.</a>
<a name="133"><span class="lineNum">     133 </span>            :      */</a>
<a name="134"><span class="lineNum">     134 </span>            :     typedef typename BaseType::IntegrationPointType IntegrationPointType;</a>
<a name="135"><span class="lineNum">     135 </span>            : </a>
<a name="136"><span class="lineNum">     136 </span>            :     /**</a>
<a name="137"><span class="lineNum">     137 </span>            :      * A Vector of IntegrationPointType which used to hold</a>
<a name="138"><span class="lineNum">     138 </span>            :      * integration points related to an integration</a>
<a name="139"><span class="lineNum">     139 </span>            :      * method.</a>
<a name="140"><span class="lineNum">     140 </span>            :      * IntegrationPoints functions used this type to return</a>
<a name="141"><span class="lineNum">     141 </span>            :      * their results.</a>
<a name="142"><span class="lineNum">     142 </span>            :      */</a>
<a name="143"><span class="lineNum">     143 </span>            :     typedef typename BaseType::IntegrationPointsArrayType IntegrationPointsArrayType;</a>
<a name="144"><span class="lineNum">     144 </span>            : </a>
<a name="145"><span class="lineNum">     145 </span>            :     /**</a>
<a name="146"><span class="lineNum">     146 </span>            :      * A Vector of IntegrationPointsArrayType which used to hold</a>
<a name="147"><span class="lineNum">     147 </span>            :      * integration points related to different integration method</a>
<a name="148"><span class="lineNum">     148 </span>            :      * implemented in geometry.</a>
<a name="149"><span class="lineNum">     149 </span>            :      */</a>
<a name="150"><span class="lineNum">     150 </span>            :     typedef typename BaseType::IntegrationPointsContainerType IntegrationPointsContainerType;</a>
<a name="151"><span class="lineNum">     151 </span>            : </a>
<a name="152"><span class="lineNum">     152 </span>            :     /**</a>
<a name="153"><span class="lineNum">     153 </span>            :      * A third order tensor used as shape functions' values</a>
<a name="154"><span class="lineNum">     154 </span>            :      * container.</a>
<a name="155"><span class="lineNum">     155 </span>            :      */</a>
<a name="156"><span class="lineNum">     156 </span>            :     typedef typename BaseType::ShapeFunctionsValuesContainerType ShapeFunctionsValuesContainerType;</a>
<a name="157"><span class="lineNum">     157 </span>            : </a>
<a name="158"><span class="lineNum">     158 </span>            :     /**</a>
<a name="159"><span class="lineNum">     159 </span>            :      * A fourth order tensor used as shape functions' local</a>
<a name="160"><span class="lineNum">     160 </span>            :      * gradients container in geometry.</a>
<a name="161"><span class="lineNum">     161 </span>            :      */</a>
<a name="162"><span class="lineNum">     162 </span>            :     typedef typename BaseType::ShapeFunctionsLocalGradientsContainerType ShapeFunctionsLocalGradientsContainerType;</a>
<a name="163"><span class="lineNum">     163 </span>            : </a>
<a name="164"><span class="lineNum">     164 </span>            :     /**</a>
<a name="165"><span class="lineNum">     165 </span>            :      * A third order tensor to hold jacobian matrices evaluated at</a>
<a name="166"><span class="lineNum">     166 </span>            :      * integration points. Jacobian and InverseOfJacobian functions</a>
<a name="167"><span class="lineNum">     167 </span>            :      * return this type as their result.</a>
<a name="168"><span class="lineNum">     168 </span>            :      */</a>
<a name="169"><span class="lineNum">     169 </span>            :     typedef typename BaseType::JacobiansType JacobiansType;</a>
<a name="170"><span class="lineNum">     170 </span>            : </a>
<a name="171"><span class="lineNum">     171 </span>            :     /**</a>
<a name="172"><span class="lineNum">     172 </span>            :      * A third order tensor to hold shape functions' local</a>
<a name="173"><span class="lineNum">     173 </span>            :      * gradients. ShapefunctionsLocalGradients function return this</a>
<a name="174"><span class="lineNum">     174 </span>            :      * type as its result.</a>
<a name="175"><span class="lineNum">     175 </span>            :      */</a>
<a name="176"><span class="lineNum">     176 </span>            :     typedef typename BaseType::ShapeFunctionsGradientsType ShapeFunctionsGradientsType;</a>
<a name="177"><span class="lineNum">     177 </span>            : </a>
<a name="178"><span class="lineNum">     178 </span>            :     /**</a>
<a name="179"><span class="lineNum">     179 </span>            :      * A third order tensor to hold shape functions' local second derivatives.</a>
<a name="180"><span class="lineNum">     180 </span>            :      * ShapefunctionsLocalGradients function return this</a>
<a name="181"><span class="lineNum">     181 </span>            :      * type as its result.</a>
<a name="182"><span class="lineNum">     182 </span>            :      */</a>
<a name="183"><span class="lineNum">     183 </span>            :     typedef typename BaseType::ShapeFunctionsSecondDerivativesType</a>
<a name="184"><span class="lineNum">     184 </span>            :     ShapeFunctionsSecondDerivativesType;</a>
<a name="185"><span class="lineNum">     185 </span>            : </a>
<a name="186"><span class="lineNum">     186 </span>            :     /**</a>
<a name="187"><span class="lineNum">     187 </span>            :     * A third order tensor to hold shape functions' local third derivatives.</a>
<a name="188"><span class="lineNum">     188 </span>            :     * ShapefunctionsLocalGradients function return this</a>
<a name="189"><span class="lineNum">     189 </span>            :     * type as its result.</a>
<a name="190"><span class="lineNum">     190 </span>            :     */</a>
<a name="191"><span class="lineNum">     191 </span>            :     typedef typename BaseType::ShapeFunctionsThirdDerivativesType</a>
<a name="192"><span class="lineNum">     192 </span>            :     ShapeFunctionsThirdDerivativesType;</a>
<a name="193"><span class="lineNum">     193 </span>            : </a>
<a name="194"><span class="lineNum">     194 </span>            :     /**</a>
<a name="195"><span class="lineNum">     195 </span>            :      * Type of the normal vector used for normal to edges in geomety.</a>
<a name="196"><span class="lineNum">     196 </span>            :      */</a>
<a name="197"><span class="lineNum">     197 </span>            :     typedef typename BaseType::NormalType NormalType;</a>
<a name="198"><span class="lineNum">     198 </span>            : </a>
<a name="199"><span class="lineNum">     199 </span>            :     ///@}</a>
<a name="200"><span class="lineNum">     200 </span>            :     ///@name Life Cycle</a>
<a name="201"><span class="lineNum">     201 </span>            :     ///@{</a>
<a name="202"><span class="lineNum">     202 </span>            : </a>
<a name="203"><span class="lineNum">     203 </span>            : //     Triangle3D6( const PointType&amp; FirstPoint,</a>
<a name="204"><span class="lineNum">     204 </span>            : //                  const PointType&amp; SecondPoint,</a>
<a name="205"><span class="lineNum">     205 </span>            : //                  const PointType&amp; ThirdPoint,</a>
<a name="206"><span class="lineNum">     206 </span>            : //                  const PointType&amp; FourthPoint,</a>
<a name="207"><span class="lineNum">     207 </span>            : //                  const PointType&amp; FifthPoint,</a>
<a name="208"><span class="lineNum">     208 </span>            : //                  const PointType&amp; SixthPoint</a>
<a name="209"><span class="lineNum">     209 </span>            : //                )</a>
<a name="210"><span class="lineNum">     210 </span>            : //         : BaseType( PointsArrayType(), &amp;msGeometryData )</a>
<a name="211"><span class="lineNum">     211 </span>            : //     {</a>
<a name="212"><span class="lineNum">     212 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( FirstPoint ) ) );</a>
<a name="213"><span class="lineNum">     213 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( SecondPoint ) ) );</a>
<a name="214"><span class="lineNum">     214 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( ThirdPoint ) ) );</a>
<a name="215"><span class="lineNum">     215 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( FourthPoint ) ) );</a>
<a name="216"><span class="lineNum">     216 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( FifthPoint ) ) );</a>
<a name="217"><span class="lineNum">     217 </span>            : //         this-&gt;Points().push_back( typename PointType::Pointer( new PointType( SixthPoint ) ) );</a>
<a name="218"><span class="lineNum">     218 </span>            : //     }</a>
<a name="219"><span class="lineNum">     219 </span>            : </a>
<a name="220"><span class="lineNum">     220 </span><span class="lineNoCov">          0 :     Triangle3D6( typename PointType::Pointer pFirstPoint,</span></a>
<a name="221"><span class="lineNum">     221 </span>            :                  typename PointType::Pointer pSecondPoint,</a>
<a name="222"><span class="lineNum">     222 </span>            :                  typename PointType::Pointer pThirdPoint,</a>
<a name="223"><span class="lineNum">     223 </span>            :                  typename PointType::Pointer pFourthPoint,</a>
<a name="224"><span class="lineNum">     224 </span>            :                  typename PointType::Pointer pFifthPoint,</a>
<a name="225"><span class="lineNum">     225 </span>            :                  typename PointType::Pointer pSixthPoint</a>
<a name="226"><span class="lineNum">     226 </span>            :                )</a>
<a name="227"><span class="lineNum">     227 </span><span class="lineNoCov">          0 :         : BaseType( PointsArrayType(), &amp;msGeometryData )</span></a>
<a name="228"><span class="lineNum">     228 </span>            :     {</a>
<a name="229"><span class="lineNum">     229 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pFirstPoint );</span></a>
<a name="230"><span class="lineNum">     230 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pSecondPoint );</span></a>
<a name="231"><span class="lineNum">     231 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pThirdPoint );</span></a>
<a name="232"><span class="lineNum">     232 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pFourthPoint );</span></a>
<a name="233"><span class="lineNum">     233 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pFifthPoint );</span></a>
<a name="234"><span class="lineNum">     234 </span><span class="lineNoCov">          0 :         this-&gt;Points().push_back( pSixthPoint );</span></a>
<a name="235"><span class="lineNum">     235 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="236"><span class="lineNum">     236 </span>            : </a>
<a name="237"><span class="lineNum">     237 </span><span class="lineCov">         16 :     explicit Triangle3D6(</span></a>
<a name="238"><span class="lineNum">     238 </span>            :         const PointsArrayType&amp; ThisPoints</a>
<a name="239"><span class="lineNum">     239 </span><span class="lineCov">         16 :     ) : BaseType( ThisPoints, &amp;msGeometryData )</span></a>
<a name="240"><span class="lineNum">     240 </span>            :     {</a>
<a name="241"><span class="lineNum">     241 </span><span class="lineCov">         16 :         KRATOS_ERROR_IF( this-&gt;PointsNumber() != 6 ) &lt;&lt; &quot;Invalid points number. Expected 6, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="242"><span class="lineNum">     242 </span><span class="lineCov">         16 :     }</span></a>
<a name="243"><span class="lineNum">     243 </span>            : </a>
<a name="244"><span class="lineNum">     244 </span>            :     /// Constructor with Geometry Id</a>
<a name="245"><span class="lineNum">     245 </span><span class="lineNoCov">          0 :     explicit Triangle3D6(</span></a>
<a name="246"><span class="lineNum">     246 </span>            :         const IndexType GeometryId,</a>
<a name="247"><span class="lineNum">     247 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="248"><span class="lineNum">     248 </span><span class="lineNoCov">          0 :     ) : BaseType(GeometryId, rThisPoints, &amp;msGeometryData)</span></a>
<a name="249"><span class="lineNum">     249 </span>            :     {</a>
<a name="250"><span class="lineNum">     250 </span><span class="lineNoCov">          0 :         KRATOS_ERROR_IF( this-&gt;PointsNumber() != 6 ) &lt;&lt; &quot;Invalid points number. Expected 6, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</span></a>
<a name="251"><span class="lineNum">     251 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="252"><span class="lineNum">     252 </span>            : </a>
<a name="253"><span class="lineNum">     253 </span>            :     /// Constructor with Geometry Name</a>
<a name="254"><span class="lineNum">     254 </span>            :     explicit Triangle3D6(</a>
<a name="255"><span class="lineNum">     255 </span>            :         const std::string&amp; rGeometryName,</a>
<a name="256"><span class="lineNum">     256 </span>            :         const PointsArrayType&amp; rThisPoints</a>
<a name="257"><span class="lineNum">     257 </span>            :     ) : BaseType(rGeometryName, rThisPoints, &amp;msGeometryData)</a>
<a name="258"><span class="lineNum">     258 </span>            :     {</a>
<a name="259"><span class="lineNum">     259 </span>            :         KRATOS_ERROR_IF(this-&gt;PointsNumber() != 20) &lt;&lt; &quot;Invalid points number. Expected 20, given &quot; &lt;&lt; this-&gt;PointsNumber() &lt;&lt; std::endl;</a>
<a name="260"><span class="lineNum">     260 </span>            :     }</a>
<a name="261"><span class="lineNum">     261 </span>            : </a>
<a name="262"><span class="lineNum">     262 </span>            :     /**</a>
<a name="263"><span class="lineNum">     263 </span>            :      * Copy constructor.</a>
<a name="264"><span class="lineNum">     264 </span>            :      * Construct this geometry as a copy of given geometry.</a>
<a name="265"><span class="lineNum">     265 </span>            :      *</a>
<a name="266"><span class="lineNum">     266 </span>            :      * @note This copy constructor does not copy the points and new</a>
<a name="267"><span class="lineNum">     267 </span>            :      * geometry shares points with given source geometry. It is</a>
<a name="268"><span class="lineNum">     268 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="269"><span class="lineNum">     269 </span>            :      * source geometry's points too.</a>
<a name="270"><span class="lineNum">     270 </span>            :      */</a>
<a name="271"><span class="lineNum">     271 </span>            :     Triangle3D6( Triangle3D6 const&amp; rOther )</a>
<a name="272"><span class="lineNum">     272 </span>            :         : BaseType( rOther )</a>
<a name="273"><span class="lineNum">     273 </span>            :     {</a>
<a name="274"><span class="lineNum">     274 </span>            :     }</a>
<a name="275"><span class="lineNum">     275 </span>            : </a>
<a name="276"><span class="lineNum">     276 </span>            :     /**</a>
<a name="277"><span class="lineNum">     277 </span>            :      * Copy constructor from a geometry with other point type.</a>
<a name="278"><span class="lineNum">     278 </span>            :      * Construct this geometry as a copy of given geometry which</a>
<a name="279"><span class="lineNum">     279 </span>            :      * has different type of points. The given goemetry's</a>
<a name="280"><span class="lineNum">     280 </span>            :      * TOtherPointType* must be implicity convertible to this</a>
<a name="281"><span class="lineNum">     281 </span>            :      * geometry PointType.</a>
<a name="282"><span class="lineNum">     282 </span>            :      *</a>
<a name="283"><span class="lineNum">     283 </span>            :      * @note This copy constructor does not copy the points and new</a>
<a name="284"><span class="lineNum">     284 </span>            :      * geometry shares points with given source geometry. It is</a>
<a name="285"><span class="lineNum">     285 </span>            :      * obvious that any change to this new geometry's point affect</a>
<a name="286"><span class="lineNum">     286 </span>            :      * source geometry's points too.</a>
<a name="287"><span class="lineNum">     287 </span>            :      */</a>
<a name="288"><span class="lineNum">     288 </span>            :     template&lt;class TOtherPointType&gt; Triangle3D6( Triangle3D6&lt;TOtherPointType&gt; const&amp; rOther )</a>
<a name="289"><span class="lineNum">     289 </span>            :         : BaseType( rOther )</a>
<a name="290"><span class="lineNum">     290 </span>            :     {</a>
<a name="291"><span class="lineNum">     291 </span>            :     }</a>
<a name="292"><span class="lineNum">     292 </span>            : </a>
<a name="293"><span class="lineNum">     293 </span>            :     /**</a>
<a name="294"><span class="lineNum">     294 </span>            :      * Destructor. Does nothing!!!</a>
<a name="295"><span class="lineNum">     295 </span>            :      */</a>
<a name="296"><span class="lineNum">     296 </span><span class="lineCov">         25 :     ~Triangle3D6() override {}</span></a>
<a name="297"><span class="lineNum">     297 </span>            : </a>
<a name="298"><span class="lineNum">     298 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryFamily GetGeometryFamily() const override</span></a>
<a name="299"><span class="lineNum">     299 </span>            :     {</a>
<a name="300"><span class="lineNum">     300 </span><span class="lineNoCov">          0 :         return GeometryData::KratosGeometryFamily::Kratos_Triangle;</span></a>
<a name="301"><span class="lineNum">     301 </span>            :     }</a>
<a name="302"><span class="lineNum">     302 </span>            : </a>
<a name="303"><span class="lineNum">     303 </span><span class="lineNoCov">          0 :     GeometryData::KratosGeometryType GetGeometryType() const override</span></a>
<a name="304"><span class="lineNum">     304 </span>            :     {</a>
<a name="305"><span class="lineNum">     305 </span><span class="lineNoCov">          0 :         return GeometryData::KratosGeometryType::Kratos_Triangle3D6;</span></a>
<a name="306"><span class="lineNum">     306 </span>            :     }</a>
<a name="307"><span class="lineNum">     307 </span>            : </a>
<a name="308"><span class="lineNum">     308 </span>            :     ///@}</a>
<a name="309"><span class="lineNum">     309 </span>            :     ///@name Operators</a>
<a name="310"><span class="lineNum">     310 </span>            :     ///@{</a>
<a name="311"><span class="lineNum">     311 </span>            : </a>
<a name="312"><span class="lineNum">     312 </span>            :     /**</a>
<a name="313"><span class="lineNum">     313 </span>            :      * Assignment operator.</a>
<a name="314"><span class="lineNum">     314 </span>            :      *</a>
<a name="315"><span class="lineNum">     315 </span>            :      * @note This operator don't copy the points and this</a>
<a name="316"><span class="lineNum">     316 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="317"><span class="lineNum">     317 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="318"><span class="lineNum">     318 </span>            :      * source geometry's points too.</a>
<a name="319"><span class="lineNum">     319 </span>            :      *</a>
<a name="320"><span class="lineNum">     320 </span>            :      * @see Clone</a>
<a name="321"><span class="lineNum">     321 </span>            :      * @see ClonePoints</a>
<a name="322"><span class="lineNum">     322 </span>            :      */</a>
<a name="323"><span class="lineNum">     323 </span>            :     Triangle3D6&amp; operator=( const Triangle3D6&amp; rOther )</a>
<a name="324"><span class="lineNum">     324 </span>            :     {</a>
<a name="325"><span class="lineNum">     325 </span>            :         BaseType::operator=( rOther );</a>
<a name="326"><span class="lineNum">     326 </span>            :         return *this;</a>
<a name="327"><span class="lineNum">     327 </span>            :     }</a>
<a name="328"><span class="lineNum">     328 </span>            : </a>
<a name="329"><span class="lineNum">     329 </span>            :     /**</a>
<a name="330"><span class="lineNum">     330 </span>            :      * Assignment operator for geometries with different point type.</a>
<a name="331"><span class="lineNum">     331 </span>            :      *</a>
<a name="332"><span class="lineNum">     332 </span>            :      * @note This operator don't copy the points and this</a>
<a name="333"><span class="lineNum">     333 </span>            :      * geometry shares points with given source geometry. It's</a>
<a name="334"><span class="lineNum">     334 </span>            :      * obvious that any change to this geometry's point affect</a>
<a name="335"><span class="lineNum">     335 </span>            :      * source geometry's points too.</a>
<a name="336"><span class="lineNum">     336 </span>            :      *</a>
<a name="337"><span class="lineNum">     337 </span>            :      * @see Clone</a>
<a name="338"><span class="lineNum">     338 </span>            :      * @see ClonePoints</a>
<a name="339"><span class="lineNum">     339 </span>            :      */</a>
<a name="340"><span class="lineNum">     340 </span>            :     template&lt;class TOtherPointType&gt;</a>
<a name="341"><span class="lineNum">     341 </span>            :     Triangle3D6&amp; operator=( Triangle3D6&lt;TOtherPointType&gt; const &amp; rOther )</a>
<a name="342"><span class="lineNum">     342 </span>            :     {</a>
<a name="343"><span class="lineNum">     343 </span>            :         BaseType::operator=( rOther );</a>
<a name="344"><span class="lineNum">     344 </span>            :         return *this;</a>
<a name="345"><span class="lineNum">     345 </span>            :     }</a>
<a name="346"><span class="lineNum">     346 </span>            : </a>
<a name="347"><span class="lineNum">     347 </span>            :     ///@}</a>
<a name="348"><span class="lineNum">     348 </span>            :     ///@name Operations</a>
<a name="349"><span class="lineNum">     349 </span>            :     ///@{</a>
<a name="350"><span class="lineNum">     350 </span>            : </a>
<a name="351"><span class="lineNum">     351 </span>            :     /**</a>
<a name="352"><span class="lineNum">     352 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="353"><span class="lineNum">     353 </span>            :      * @param rThisPoints the nodes of the new geometry</a>
<a name="354"><span class="lineNum">     354 </span>            :      * @return Pointer to the new geometry</a>
<a name="355"><span class="lineNum">     355 </span>            :      */</a>
<a name="356"><span class="lineNum">     356 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="357"><span class="lineNum">     357 </span>            :         PointsArrayType const&amp; rThisPoints</a>
<a name="358"><span class="lineNum">     358 </span>            :         ) const override</a>
<a name="359"><span class="lineNum">     359 </span>            :     {</a>
<a name="360"><span class="lineNum">     360 </span><span class="lineNoCov">          0 :         return typename BaseType::Pointer( new Triangle3D6( rThisPoints ) );</span></a>
<a name="361"><span class="lineNum">     361 </span>            :     }</a>
<a name="362"><span class="lineNum">     362 </span>            : </a>
<a name="363"><span class="lineNum">     363 </span>            :     /**</a>
<a name="364"><span class="lineNum">     364 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="365"><span class="lineNum">     365 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="366"><span class="lineNum">     366 </span>            :      * @param rThisPoints the nodes of the new geometry</a>
<a name="367"><span class="lineNum">     367 </span>            :      * @return Pointer to the new geometry</a>
<a name="368"><span class="lineNum">     368 </span>            :      */</a>
<a name="369"><span class="lineNum">     369 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="370"><span class="lineNum">     370 </span>            :         const IndexType NewGeometryId,</a>
<a name="371"><span class="lineNum">     371 </span>            :         PointsArrayType const&amp; rThisPoints</a>
<a name="372"><span class="lineNum">     372 </span>            :         ) const override</a>
<a name="373"><span class="lineNum">     373 </span>            :     {</a>
<a name="374"><span class="lineNum">     374 </span><span class="lineNoCov">          0 :         return typename BaseType::Pointer( new Triangle3D6( NewGeometryId, rThisPoints ) );</span></a>
<a name="375"><span class="lineNum">     375 </span>            :     }</a>
<a name="376"><span class="lineNum">     376 </span>            : </a>
<a name="377"><span class="lineNum">     377 </span>            :     /**</a>
<a name="378"><span class="lineNum">     378 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="379"><span class="lineNum">     379 </span>            :      * @param rGeometry reference to an existing geometry</a>
<a name="380"><span class="lineNum">     380 </span>            :      * @return Pointer to the new geometry</a>
<a name="381"><span class="lineNum">     381 </span>            :      */</a>
<a name="382"><span class="lineNum">     382 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="383"><span class="lineNum">     383 </span>            :         const BaseType&amp; rGeometry</a>
<a name="384"><span class="lineNum">     384 </span>            :         ) const override</a>
<a name="385"><span class="lineNum">     385 </span>            :     {</a>
<a name="386"><span class="lineNum">     386 </span><span class="lineNoCov">          0 :         auto p_geometry = typename BaseType::Pointer( new Triangle3D6( rGeometry.Points() ) );</span></a>
<a name="387"><span class="lineNum">     387 </span>            :         p_geometry-&gt;SetData(rGeometry.GetData());</a>
<a name="388"><span class="lineNum">     388 </span><span class="lineNoCov">          0 :         return p_geometry;</span></a>
<a name="389"><span class="lineNum">     389 </span>            :     }</a>
<a name="390"><span class="lineNum">     390 </span>            : </a>
<a name="391"><span class="lineNum">     391 </span>            :     /**</a>
<a name="392"><span class="lineNum">     392 </span>            :      * @brief Creates a new geometry pointer</a>
<a name="393"><span class="lineNum">     393 </span>            :      * @param NewGeometryId the ID of the new geometry</a>
<a name="394"><span class="lineNum">     394 </span>            :      * @param rGeometry reference to an existing geometry</a>
<a name="395"><span class="lineNum">     395 </span>            :      * @return Pointer to the new geometry</a>
<a name="396"><span class="lineNum">     396 </span>            :      */</a>
<a name="397"><span class="lineNum">     397 </span><span class="lineNoCov">          0 :     typename BaseType::Pointer Create(</span></a>
<a name="398"><span class="lineNum">     398 </span>            :         const IndexType NewGeometryId,</a>
<a name="399"><span class="lineNum">     399 </span>            :         const BaseType&amp; rGeometry</a>
<a name="400"><span class="lineNum">     400 </span>            :         ) const override</a>
<a name="401"><span class="lineNum">     401 </span>            :     {</a>
<a name="402"><span class="lineNum">     402 </span><span class="lineNoCov">          0 :         auto p_geometry = typename BaseType::Pointer( new Triangle3D6( NewGeometryId, rGeometry.Points() ) );</span></a>
<a name="403"><span class="lineNum">     403 </span>            :         p_geometry-&gt;SetData(rGeometry.GetData());</a>
<a name="404"><span class="lineNum">     404 </span><span class="lineNoCov">          0 :         return p_geometry;</span></a>
<a name="405"><span class="lineNum">     405 </span>            :     }</a>
<a name="406"><span class="lineNum">     406 </span>            : </a>
<a name="407"><span class="lineNum">     407 </span>            :     /**</a>
<a name="408"><span class="lineNum">     408 </span>            :      * returns the local coordinates of all nodes of the current geometry</a>
<a name="409"><span class="lineNum">     409 </span>            :      * @param rResult a Matrix object that will be overwritten by the result</a>
<a name="410"><span class="lineNum">     410 </span>            :      * @return the local coordinates of all nodes</a>
<a name="411"><span class="lineNum">     411 </span>            :      */</a>
<a name="412"><span class="lineNum">     412 </span><span class="lineNoCov">          0 :     Matrix&amp; PointsLocalCoordinates( Matrix&amp; rResult ) const override</span></a>
<a name="413"><span class="lineNum">     413 </span>            :     {</a>
<a name="414"><span class="lineNum">     414 </span><span class="lineNoCov">          0 :         rResult.resize( 6, 2,false );</span></a>
<a name="415"><span class="lineNum">     415 </span>            :         noalias( rResult ) = ZeroMatrix( 6, 2 );</a>
<a name="416"><span class="lineNum">     416 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) =  0.0;</span></a>
<a name="417"><span class="lineNum">     417 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) =  0.0;</span></a>
<a name="418"><span class="lineNum">     418 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  1.0;</span></a>
<a name="419"><span class="lineNum">     419 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0.0;</span></a>
<a name="420"><span class="lineNum">     420 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0.0;</span></a>
<a name="421"><span class="lineNum">     421 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  1.0;</span></a>
<a name="422"><span class="lineNum">     422 </span><span class="lineNoCov">          0 :         rResult( 3, 0 ) =  0.5;</span></a>
<a name="423"><span class="lineNum">     423 </span><span class="lineNoCov">          0 :         rResult( 3, 1 ) =  0.0;</span></a>
<a name="424"><span class="lineNum">     424 </span><span class="lineNoCov">          0 :         rResult( 4, 0 ) =  0.5;</span></a>
<a name="425"><span class="lineNum">     425 </span><span class="lineNoCov">          0 :         rResult( 4, 1 ) =  0.5;</span></a>
<a name="426"><span class="lineNum">     426 </span><span class="lineNoCov">          0 :         rResult( 5, 0 ) =  0.0;</span></a>
<a name="427"><span class="lineNum">     427 </span><span class="lineNoCov">          0 :         rResult( 5, 1 ) =  0.5;</span></a>
<a name="428"><span class="lineNum">     428 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="429"><span class="lineNum">     429 </span>            :     }</a>
<a name="430"><span class="lineNum">     430 </span>            : </a>
<a name="431"><span class="lineNum">     431 </span>            :     ///@}</a>
<a name="432"><span class="lineNum">     432 </span>            :     ///@name Information</a>
<a name="433"><span class="lineNum">     433 </span>            :     ///@{</a>
<a name="434"><span class="lineNum">     434 </span>            : </a>
<a name="435"><span class="lineNum">     435 </span>            :     /**</a>
<a name="436"><span class="lineNum">     436 </span>            :      * This method calculates and returns Length or charactereistic</a>
<a name="437"><span class="lineNum">     437 </span>            :      * length of this geometry depending on it's dimension.</a>
<a name="438"><span class="lineNum">     438 </span>            :      * For one dimensional geometry for example Line it returns</a>
<a name="439"><span class="lineNum">     439 </span>            :      * length of it and for the other geometries it gives Characteristic</a>
<a name="440"><span class="lineNum">     440 </span>            :      * length otherwise.</a>
<a name="441"><span class="lineNum">     441 </span>            :      * In the current geometry this function returns the determinant of</a>
<a name="442"><span class="lineNum">     442 </span>            :      * jacobian</a>
<a name="443"><span class="lineNum">     443 </span>            :      * @todo Could be replaced by something more suitable</a>
<a name="444"><span class="lineNum">     444 </span>            :      * @return double value contains length or Characteristic</a>
<a name="445"><span class="lineNum">     445 </span>            :      * length</a>
<a name="446"><span class="lineNum">     446 </span>            :      * @see Area()</a>
<a name="447"><span class="lineNum">     447 </span>            :      * @see Volume()</a>
<a name="448"><span class="lineNum">     448 </span>            :      * @see DomainSize()</a>
<a name="449"><span class="lineNum">     449 </span>            :      */</a>
<a name="450"><span class="lineNum">     450 </span><span class="lineNoCov">          0 :     double Length() const override</span></a>
<a name="451"><span class="lineNum">     451 </span>            :     {</a>
<a name="452"><span class="lineNum">     452 </span><span class="lineNoCov">          0 :         return std::sqrt(std::abs(this-&gt;DeterminantOfJacobian( PointType() ) ) );</span></a>
<a name="453"><span class="lineNum">     453 </span>            :     }</a>
<a name="454"><span class="lineNum">     454 </span>            : </a>
<a name="455"><span class="lineNum">     455 </span>            :     /** </a>
<a name="456"><span class="lineNum">     456 </span>            :      * @brief This method calculates and returns area or surface area of this geometry depending to it's dimension. </a>
<a name="457"><span class="lineNum">     457 </span>            :      * @details For one dimensional geometry it returns zero, for two dimensional it gives area</a>
<a name="458"><span class="lineNum">     458 </span>            :      * and for three dimensional geometries it gives surface area.</a>
<a name="459"><span class="lineNum">     459 </span>            :      * @return double value contains area or surface area</a>
<a name="460"><span class="lineNum">     460 </span>            :      * @see Length()</a>
<a name="461"><span class="lineNum">     461 </span>            :      * @see Volume()</a>
<a name="462"><span class="lineNum">     462 </span>            :      * @see DomainSize()</a>
<a name="463"><span class="lineNum">     463 </span>            :      */</a>
<a name="464"><span class="lineNum">     464 </span><span class="lineNoCov">          0 :     double Area() const override</span></a>
<a name="465"><span class="lineNum">     465 </span>            :     {</a>
<a name="466"><span class="lineNum">     466 </span>            :         const IntegrationMethod integration_method = msGeometryData.DefaultIntegrationMethod();</a>
<a name="467"><span class="lineNum">     467 </span><span class="lineNoCov">          0 :         return IntegrationUtilities::ComputeDomainSize(*this, integration_method);</span></a>
<a name="468"><span class="lineNum">     468 </span>            :     }</a>
<a name="469"><span class="lineNum">     469 </span>            : </a>
<a name="470"><span class="lineNum">     470 </span>            :     // TODO: Code activated in June 2023</a>
<a name="471"><span class="lineNum">     471 </span>            :     // /**</a>
<a name="472"><span class="lineNum">     472 </span>            :     //  * @brief This method calculates and returns the volume of this geometry.</a>
<a name="473"><span class="lineNum">     473 </span>            :     //  * @return Error, the volume of a 2D geometry is not defined</a>
<a name="474"><span class="lineNum">     474 </span>            :     //  * @see Length()</a>
<a name="475"><span class="lineNum">     475 </span>            :     //  * @see Area()</a>
<a name="476"><span class="lineNum">     476 </span>            :     //  * @see Volume()</a>
<a name="477"><span class="lineNum">     477 </span>            :     //  */</a>
<a name="478"><span class="lineNum">     478 </span>            :     // double Volume() const override</a>
<a name="479"><span class="lineNum">     479 </span>            :     // {</a>
<a name="480"><span class="lineNum">     480 </span>            :     //     KRATOS_ERROR &lt;&lt; &quot;Triangle3D6:: Method not well defined. Replace with DomainSize() instead&quot; &lt;&lt; std::endl;</a>
<a name="481"><span class="lineNum">     481 </span>            :     //     return 0.0;</a>
<a name="482"><span class="lineNum">     482 </span>            :     // }</a>
<a name="483"><span class="lineNum">     483 </span>            : </a>
<a name="484"><span class="lineNum">     484 </span>            :     /** </a>
<a name="485"><span class="lineNum">     485 </span>            :      * @brief This method calculates and returns length, area or volume of this geometry depending to it's dimension. </a>
<a name="486"><span class="lineNum">     486 </span>            :      * @details For one dimensional geometry it returns its length, for two dimensional it gives area and for three dimensional geometries it gives its volume.</a>
<a name="487"><span class="lineNum">     487 </span>            :      * @return double value contains length, area or volume.</a>
<a name="488"><span class="lineNum">     488 </span>            :      * @see Length()</a>
<a name="489"><span class="lineNum">     489 </span>            :      * @see Area()</a>
<a name="490"><span class="lineNum">     490 </span>            :      * @see Volume()</a>
<a name="491"><span class="lineNum">     491 </span>            :      */</a>
<a name="492"><span class="lineNum">     492 </span><span class="lineNoCov">          0 :     double DomainSize() const override</span></a>
<a name="493"><span class="lineNum">     493 </span>            :     {</a>
<a name="494"><span class="lineNum">     494 </span><span class="lineNoCov">          0 :         return Area();</span></a>
<a name="495"><span class="lineNum">     495 </span>            :     }</a>
<a name="496"><span class="lineNum">     496 </span>            : </a>
<a name="497"><span class="lineNum">     497 </span>            :     /**</a>
<a name="498"><span class="lineNum">     498 </span>            :      * @brief Returns whether given arbitrary point is inside the Geometry and the respective</a>
<a name="499"><span class="lineNum">     499 </span>            :      * local point for the given global point</a>
<a name="500"><span class="lineNum">     500 </span>            :      * @param rPoint The point to be checked if is inside o note in global coordinates</a>
<a name="501"><span class="lineNum">     501 </span>            :      * @param rResult The local coordinates of the point</a>
<a name="502"><span class="lineNum">     502 </span>            :      * @param Tolerance The  tolerance that will be considered to check if the point is inside or not</a>
<a name="503"><span class="lineNum">     503 </span>            :      * @return True if the point is inside, false otherwise</a>
<a name="504"><span class="lineNum">     504 </span>            :      */</a>
<a name="505"><span class="lineNum">     505 </span><span class="lineNoCov">          0 :     bool IsInside(</span></a>
<a name="506"><span class="lineNum">     506 </span>            :         const CoordinatesArrayType&amp; rPoint,</a>
<a name="507"><span class="lineNum">     507 </span>            :         CoordinatesArrayType&amp; rResult,</a>
<a name="508"><span class="lineNum">     508 </span>            :         const double Tolerance = std::numeric_limits&lt;double&gt;::epsilon()</a>
<a name="509"><span class="lineNum">     509 </span>            :         )const  override</a>
<a name="510"><span class="lineNum">     510 </span>            :     {</a>
<a name="511"><span class="lineNum">     511 </span><span class="lineNoCov">          0 :         this-&gt;PointLocalCoordinates( rResult, rPoint );</span></a>
<a name="512"><span class="lineNum">     512 </span>            : </a>
<a name="513"><span class="lineNum">     513 </span><span class="lineNoCov">          0 :         if ( (rResult[0] &gt;= (0.0-Tolerance)) &amp;&amp; (rResult[0] &lt;= (1.0+Tolerance)) )</span></a>
<a name="514"><span class="lineNum">     514 </span>            :         {</a>
<a name="515"><span class="lineNum">     515 </span><span class="lineNoCov">          0 :             if ( (rResult[1] &gt;= (0.0-Tolerance)) &amp;&amp; (rResult[1] &lt;= (1.0+Tolerance)) )</span></a>
<a name="516"><span class="lineNum">     516 </span>            :             {</a>
<a name="517"><span class="lineNum">     517 </span><span class="lineNoCov">          0 :                 if ( (rResult[0] + rResult[1]) &lt;= (1.0+Tolerance) )</span></a>
<a name="518"><span class="lineNum">     518 </span>            :                 {</a>
<a name="519"><span class="lineNum">     519 </span><span class="lineNoCov">          0 :                     return true;</span></a>
<a name="520"><span class="lineNum">     520 </span>            :                 }</a>
<a name="521"><span class="lineNum">     521 </span>            :             }</a>
<a name="522"><span class="lineNum">     522 </span>            :         }</a>
<a name="523"><span class="lineNum">     523 </span>            : </a>
<a name="524"><span class="lineNum">     524 </span>            :         return false;</a>
<a name="525"><span class="lineNum">     525 </span>            :     }</a>
<a name="526"><span class="lineNum">     526 </span>            : </a>
<a name="527"><span class="lineNum">     527 </span>            :     ///@}</a>
<a name="528"><span class="lineNum">     528 </span>            :     ///@name Shape Function</a>
<a name="529"><span class="lineNum">     529 </span>            :     ///@{</a>
<a name="530"><span class="lineNum">     530 </span>            : </a>
<a name="531"><span class="lineNum">     531 </span>            :     /**</a>
<a name="532"><span class="lineNum">     532 </span>            :      * TODO: implemented but not yet tested</a>
<a name="533"><span class="lineNum">     533 </span>            :      */</a>
<a name="534"><span class="lineNum">     534 </span>            :     /**</a>
<a name="535"><span class="lineNum">     535 </span>            :      * Calculates the value of a given shape function at a given point.</a>
<a name="536"><span class="lineNum">     536 </span>            :      *</a>
<a name="537"><span class="lineNum">     537 </span>            :      * @param ShapeFunctionIndex The number of the desired shape function</a>
<a name="538"><span class="lineNum">     538 </span>            :      * @param rPoint the given point in local coordinates at which the value of the shape</a>
<a name="539"><span class="lineNum">     539 </span>            :      * function is calculated</a>
<a name="540"><span class="lineNum">     540 </span>            :      *</a>
<a name="541"><span class="lineNum">     541 </span>            :      * @return the value of the shape function at the given point</a>
<a name="542"><span class="lineNum">     542 </span>            :      */</a>
<a name="543"><span class="lineNum">     543 </span><span class="lineNoCov">          0 :     double ShapeFunctionValue( IndexType ShapeFunctionIndex,</span></a>
<a name="544"><span class="lineNum">     544 </span>            :                                        const CoordinatesArrayType&amp; rPoint ) const override</a>
<a name="545"><span class="lineNum">     545 </span>            :     {</a>
<a name="546"><span class="lineNum">     546 </span>            : </a>
<a name="547"><span class="lineNum">     547 </span><span class="lineNoCov">          0 :         double thirdCoord = 1 - rPoint[0] - rPoint[1];</span></a>
<a name="548"><span class="lineNum">     548 </span>            : </a>
<a name="549"><span class="lineNum">     549 </span><span class="lineNoCov">          0 :         switch ( ShapeFunctionIndex )</span></a>
<a name="550"><span class="lineNum">     550 </span>            :         {</a>
<a name="551"><span class="lineNum">     551 </span><span class="lineNoCov">          0 :         case 0:</span></a>
<a name="552"><span class="lineNum">     552 </span><span class="lineNoCov">          0 :             return( thirdCoord*( 2*thirdCoord - 1 ) );</span></a>
<a name="553"><span class="lineNum">     553 </span>            :         case 1:</a>
<a name="554"><span class="lineNum">     554 </span><span class="lineNoCov">          0 :             return( rPoint[0]*( 2*rPoint[0] - 1 ) );</span></a>
<a name="555"><span class="lineNum">     555 </span>            :         case 2:</a>
<a name="556"><span class="lineNum">     556 </span><span class="lineNoCov">          0 :             return( rPoint[1]*( 2*rPoint[1] - 1 ) );</span></a>
<a name="557"><span class="lineNum">     557 </span><span class="lineNoCov">          0 :         case 3:</span></a>
<a name="558"><span class="lineNum">     558 </span><span class="lineNoCov">          0 :             return( 4*thirdCoord*rPoint[0] );</span></a>
<a name="559"><span class="lineNum">     559 </span>            :         case 4:</a>
<a name="560"><span class="lineNum">     560 </span><span class="lineNoCov">          0 :             return( 4*rPoint[0]*rPoint[1] );</span></a>
<a name="561"><span class="lineNum">     561 </span>            :         case 5:</a>
<a name="562"><span class="lineNum">     562 </span><span class="lineNoCov">          0 :             return( 4*rPoint[1]*thirdCoord );</span></a>
<a name="563"><span class="lineNum">     563 </span>            : </a>
<a name="564"><span class="lineNum">     564 </span><span class="lineNoCov">          0 :         default:</span></a>
<a name="565"><span class="lineNum">     565 </span><span class="lineNoCov">          0 :             KRATOS_ERROR &lt;&lt; &quot;Wrong index of shape function!&quot; &lt;&lt; *this &lt;&lt; std::endl;</span></a>
<a name="566"><span class="lineNum">     566 </span>            :         }</a>
<a name="567"><span class="lineNum">     567 </span>            : </a>
<a name="568"><span class="lineNum">     568 </span>            :         return 0;</a>
<a name="569"><span class="lineNum">     569 </span>            :     }</a>
<a name="570"><span class="lineNum">     570 </span>            : </a>
<a name="571"><span class="lineNum">     571 </span>            :     ///@}</a>
<a name="572"><span class="lineNum">     572 </span>            :     ///@name Input and output</a>
<a name="573"><span class="lineNum">     573 </span>            :     ///@{</a>
<a name="574"><span class="lineNum">     574 </span>            : </a>
<a name="575"><span class="lineNum">     575 </span>            :     /**</a>
<a name="576"><span class="lineNum">     576 </span>            :      * Turn back information as a string.</a>
<a name="577"><span class="lineNum">     577 </span>            :      *</a>
<a name="578"><span class="lineNum">     578 </span>            :      * @return String contains information about this geometry.</a>
<a name="579"><span class="lineNum">     579 </span>            :      * @see PrintData()</a>
<a name="580"><span class="lineNum">     580 </span>            :      * @see PrintInfo()</a>
<a name="581"><span class="lineNum">     581 </span>            :      */</a>
<a name="582"><span class="lineNum">     582 </span><span class="lineNoCov">          0 :     std::string Info() const override</span></a>
<a name="583"><span class="lineNum">     583 </span>            :     {</a>
<a name="584"><span class="lineNum">     584 </span><span class="lineNoCov">          0 :         return &quot;2 dimensional triangle with six nodes in 3D space&quot;;</span></a>
<a name="585"><span class="lineNum">     585 </span>            :     }</a>
<a name="586"><span class="lineNum">     586 </span>            : </a>
<a name="587"><span class="lineNum">     587 </span>            :     /**</a>
<a name="588"><span class="lineNum">     588 </span>            :      * Print information about this object.</a>
<a name="589"><span class="lineNum">     589 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="590"><span class="lineNum">     590 </span>            :      * @see PrintData()</a>
<a name="591"><span class="lineNum">     591 </span>            :      * @see Info()</a>
<a name="592"><span class="lineNum">     592 </span>            :      */</a>
<a name="593"><span class="lineNum">     593 </span><span class="lineNoCov">          0 :     void PrintInfo( std::ostream&amp; rOStream ) const override</span></a>
<a name="594"><span class="lineNum">     594 </span>            :     {</a>
<a name="595"><span class="lineNum">     595 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;2 dimensional triangle with six nodes in 3D space&quot;;</span></a>
<a name="596"><span class="lineNum">     596 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="597"><span class="lineNum">     597 </span>            : </a>
<a name="598"><span class="lineNum">     598 </span>            :     /**</a>
<a name="599"><span class="lineNum">     599 </span>            :      * Print geometry's data into given stream.</a>
<a name="600"><span class="lineNum">     600 </span>            :      * Prints it's points</a>
<a name="601"><span class="lineNum">     601 </span>            :      * by the order they stored in the geometry and then center</a>
<a name="602"><span class="lineNum">     602 </span>            :      * point of geometry.</a>
<a name="603"><span class="lineNum">     603 </span>            :      *</a>
<a name="604"><span class="lineNum">     604 </span>            :      * @param rOStream Stream to print into it.</a>
<a name="605"><span class="lineNum">     605 </span>            :      * @see PrintInfo()</a>
<a name="606"><span class="lineNum">     606 </span>            :      * @see Info()</a>
<a name="607"><span class="lineNum">     607 </span>            :      */</a>
<a name="608"><span class="lineNum">     608 </span>            :     /**</a>
<a name="609"><span class="lineNum">     609 </span>            :      * :TODO: needs to be reviewed because it is not properly implemented yet</a>
<a name="610"><span class="lineNum">     610 </span>            :      * (comment by janosch)</a>
<a name="611"><span class="lineNum">     611 </span>            :      */</a>
<a name="612"><span class="lineNum">     612 </span><span class="lineNoCov">          0 :     void PrintData( std::ostream&amp; rOStream ) const override</span></a>
<a name="613"><span class="lineNum">     613 </span>            :     {</a>
<a name="614"><span class="lineNum">     614 </span><span class="lineNoCov">          0 :         PrintInfo( rOStream );</span></a>
<a name="615"><span class="lineNum">     615 </span><span class="lineNoCov">          0 :         BaseType::PrintData( rOStream );</span></a>
<a name="616"><span class="lineNum">     616 </span>            :         std::cout &lt;&lt; std::endl;</a>
<a name="617"><span class="lineNum">     617 </span>            :         Matrix jacobian;</a>
<a name="618"><span class="lineNum">     618 </span><span class="lineNoCov">          0 :         this-&gt;Jacobian( jacobian, PointType() );</span></a>
<a name="619"><span class="lineNum">     619 </span><span class="lineNoCov">          0 :         rOStream &lt;&lt; &quot;    Jacobian in the origin\t : &quot; &lt;&lt; jacobian;</span></a>
<a name="620"><span class="lineNum">     620 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="621"><span class="lineNum">     621 </span>            : </a>
<a name="622"><span class="lineNum">     622 </span>            :     ///@}</a>
<a name="623"><span class="lineNum">     623 </span>            :     ///@name Edge</a>
<a name="624"><span class="lineNum">     624 </span>            :     ///@{</a>
<a name="625"><span class="lineNum">     625 </span>            : </a>
<a name="626"><span class="lineNum">     626 </span>            :     /**</a>
<a name="627"><span class="lineNum">     627 </span>            :      * @brief This method gives you number of all edges of this geometry.</a>
<a name="628"><span class="lineNum">     628 </span>            :      * @details For example, for a hexahedron, this would be 12</a>
<a name="629"><span class="lineNum">     629 </span>            :      * @return SizeType containes number of this geometry edges.</a>
<a name="630"><span class="lineNum">     630 </span>            :      * @see EdgesNumber()</a>
<a name="631"><span class="lineNum">     631 </span>            :      * @see Edges()</a>
<a name="632"><span class="lineNum">     632 </span>            :      * @see GenerateEdges()</a>
<a name="633"><span class="lineNum">     633 </span>            :      * @see FacesNumber()</a>
<a name="634"><span class="lineNum">     634 </span>            :      * @see Faces()</a>
<a name="635"><span class="lineNum">     635 </span>            :      * @see GenerateFaces()</a>
<a name="636"><span class="lineNum">     636 </span>            :      */</a>
<a name="637"><span class="lineNum">     637 </span><span class="lineNoCov">          0 :     SizeType EdgesNumber() const override</span></a>
<a name="638"><span class="lineNum">     638 </span>            :     {</a>
<a name="639"><span class="lineNum">     639 </span><span class="lineNoCov">          0 :         return 3;</span></a>
<a name="640"><span class="lineNum">     640 </span>            :     }</a>
<a name="641"><span class="lineNum">     641 </span>            : </a>
<a name="642"><span class="lineNum">     642 </span>            :     /**</a>
<a name="643"><span class="lineNum">     643 </span>            :      * @brief This method gives you all edges of this geometry.</a>
<a name="644"><span class="lineNum">     644 </span>            :      * @details This method will gives you all the edges with one dimension less than this geometry.</a>
<a name="645"><span class="lineNum">     645 </span>            :      * For example a triangle would return three lines as its edges or a tetrahedral would return four triangle as its edges but won't return its six edge lines by this method.</a>
<a name="646"><span class="lineNum">     646 </span>            :      * @return GeometriesArrayType containes this geometry edges.</a>
<a name="647"><span class="lineNum">     647 </span>            :      * @see EdgesNumber()</a>
<a name="648"><span class="lineNum">     648 </span>            :      * @see Edge()</a>
<a name="649"><span class="lineNum">     649 </span>            :      */</a>
<a name="650"><span class="lineNum">     650 </span><span class="lineNoCov">          0 :     GeometriesArrayType GenerateEdges() const override</span></a>
<a name="651"><span class="lineNum">     651 </span>            :     {</a>
<a name="652"><span class="lineNum">     652 </span>            :         GeometriesArrayType edges = GeometriesArrayType();</a>
<a name="653"><span class="lineNum">     653 </span>            : </a>
<a name="654"><span class="lineNum">     654 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 0 ), this-&gt;pGetPoint( 1 ), this-&gt;pGetPoint( 3 ) ) );</span></a>
<a name="655"><span class="lineNum">     655 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 1 ), this-&gt;pGetPoint( 2 ), this-&gt;pGetPoint( 4 ) ) );</span></a>
<a name="656"><span class="lineNum">     656 </span><span class="lineNoCov">          0 :         edges.push_back( Kratos::make_shared&lt;EdgeType&gt;( this-&gt;pGetPoint( 2 ), this-&gt;pGetPoint( 0 ), this-&gt;pGetPoint( 5 ) ) );</span></a>
<a name="657"><span class="lineNum">     657 </span><span class="lineNoCov">          0 :         return edges;</span></a>
<a name="658"><span class="lineNum">     658 </span>            :     }</a>
<a name="659"><span class="lineNum">     659 </span>            : </a>
<a name="660"><span class="lineNum">     660 </span>            :     /**</a>
<a name="661"><span class="lineNum">     661 </span>            :      * Calculates the local gradients for all integration points for</a>
<a name="662"><span class="lineNum">     662 </span>            :      * given integration method</a>
<a name="663"><span class="lineNum">     663 </span>            :      */</a>
<a name="664"><span class="lineNum">     664 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients(</span></a>
<a name="665"><span class="lineNum">     665 </span>            :         IntegrationMethod ThisMethod )</a>
<a name="666"><span class="lineNum">     666 </span>            :     {</a>
<a name="667"><span class="lineNum">     667 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="668"><span class="lineNum">     668 </span>            :             = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="669"><span class="lineNum">     669 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="670"><span class="lineNum">     670 </span>            :             = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="671"><span class="lineNum">     671 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="672"><span class="lineNum">     672 </span>            : </a>
<a name="673"><span class="lineNum">     673 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="674"><span class="lineNum">     674 </span>            :         {</a>
<a name="675"><span class="lineNum">     675 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="676"><span class="lineNum">     676 </span>            :         }</a>
<a name="677"><span class="lineNum">     677 </span>            : </a>
<a name="678"><span class="lineNum">     678 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="679"><span class="lineNum">     679 </span>            :     }</a>
<a name="680"><span class="lineNum">     680 </span>            : </a>
<a name="681"><span class="lineNum">     681 </span>            :     /**</a>
<a name="682"><span class="lineNum">     682 </span>            :      * Calculates the local gradients for all integration points for the</a>
<a name="683"><span class="lineNum">     683 </span>            :      * default integration method</a>
<a name="684"><span class="lineNum">     684 </span>            :      */</a>
<a name="685"><span class="lineNum">     685 </span><span class="lineNoCov">          0 :     virtual ShapeFunctionsGradientsType ShapeFunctionsLocalGradients()</span></a>
<a name="686"><span class="lineNum">     686 </span>            :     {</a>
<a name="687"><span class="lineNum">     687 </span>            :         IntegrationMethod ThisMethod = msGeometryData.DefaultIntegrationMethod();</a>
<a name="688"><span class="lineNum">     688 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType localGradients</span></a>
<a name="689"><span class="lineNum">     689 </span>            :             = CalculateShapeFunctionsIntegrationPointsLocalGradients( ThisMethod );</a>
<a name="690"><span class="lineNum">     690 </span><span class="lineNoCov">          0 :         const int integration_points_number</span></a>
<a name="691"><span class="lineNum">     691 </span>            :             = msGeometryData.IntegrationPointsNumber( ThisMethod );</a>
<a name="692"><span class="lineNum">     692 </span><span class="lineNoCov">          0 :         ShapeFunctionsGradientsType Result( integration_points_number );</span></a>
<a name="693"><span class="lineNum">     693 </span>            : </a>
<a name="694"><span class="lineNum">     694 </span><span class="lineNoCov">          0 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="695"><span class="lineNum">     695 </span>            :         {</a>
<a name="696"><span class="lineNum">     696 </span><span class="lineNoCov">          0 :             Result[pnt] = localGradients[pnt];</span></a>
<a name="697"><span class="lineNum">     697 </span>            :         }</a>
<a name="698"><span class="lineNum">     698 </span>            : </a>
<a name="699"><span class="lineNum">     699 </span><span class="lineNoCov">          0 :         return Result;</span></a>
<a name="700"><span class="lineNum">     700 </span>            :     }</a>
<a name="701"><span class="lineNum">     701 </span>            : </a>
<a name="702"><span class="lineNum">     702 </span>            :     /**</a>
<a name="703"><span class="lineNum">     703 </span>            :      * Calculates the gradients in terms of local coordinates</a>
<a name="704"><span class="lineNum">     704 </span>            :      * of all shape functions in a given point.</a>
<a name="705"><span class="lineNum">     705 </span>            :      *</a>
<a name="706"><span class="lineNum">     706 </span>            :      * @param rPoint the current point at which the gradients are calculated in local</a>
<a name="707"><span class="lineNum">     707 </span>            :      * coordinates</a>
<a name="708"><span class="lineNum">     708 </span>            :      * @return the gradients of all shape functions</a>
<a name="709"><span class="lineNum">     709 </span>            :      * \f$ \frac{\partial N^i}{\partial \xi_j} \f$</a>
<a name="710"><span class="lineNum">     710 </span>            :      */</a>
<a name="711"><span class="lineNum">     711 </span><span class="lineNoCov">          0 :     Matrix&amp; ShapeFunctionsLocalGradients( Matrix&amp; rResult,</span></a>
<a name="712"><span class="lineNum">     712 </span>            :             const CoordinatesArrayType&amp; rPoint ) const override</a>
<a name="713"><span class="lineNum">     713 </span>            :     {</a>
<a name="714"><span class="lineNum">     714 </span><span class="lineNoCov">          0 :         rResult.resize( 6, 2,false );</span></a>
<a name="715"><span class="lineNum">     715 </span><span class="lineNoCov">          0 :         double thirdCoord = 1 - rPoint[0] - rPoint[1];</span></a>
<a name="716"><span class="lineNum">     716 </span>            :         double thirdCoord_DX = -1;</a>
<a name="717"><span class="lineNum">     717 </span>            :         double thirdCoord_DY = -1;</a>
<a name="718"><span class="lineNum">     718 </span>            : </a>
<a name="719"><span class="lineNum">     719 </span>            :         noalias( rResult ) = ZeroMatrix( 6, 2 );</a>
<a name="720"><span class="lineNum">     720 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DX;</span></a>
<a name="721"><span class="lineNum">     721 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DY;</span></a>
<a name="722"><span class="lineNum">     722 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  4 * rPoint[0] - 1;</span></a>
<a name="723"><span class="lineNum">     723 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0;</span></a>
<a name="724"><span class="lineNum">     724 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0;</span></a>
<a name="725"><span class="lineNum">     725 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  4 * rPoint[1] - 1;</span></a>
<a name="726"><span class="lineNum">     726 </span><span class="lineNoCov">          0 :         rResult( 3, 0 ) =  4 * thirdCoord_DX * rPoint[0] + 4 * thirdCoord;</span></a>
<a name="727"><span class="lineNum">     727 </span><span class="lineNoCov">          0 :         rResult( 3, 1 ) =  4 * thirdCoord_DY * rPoint[0];</span></a>
<a name="728"><span class="lineNum">     728 </span><span class="lineNoCov">          0 :         rResult( 4, 0 ) =  4 * rPoint[1];</span></a>
<a name="729"><span class="lineNum">     729 </span><span class="lineNoCov">          0 :         rResult( 4, 1 ) =  4 * rPoint[0];</span></a>
<a name="730"><span class="lineNum">     730 </span><span class="lineNoCov">          0 :         rResult( 5, 0 ) =  4 * rPoint[1] * thirdCoord_DX;</span></a>
<a name="731"><span class="lineNum">     731 </span><span class="lineNoCov">          0 :         rResult( 5, 1 ) =  4 * rPoint[1] * thirdCoord_DY + 4 * thirdCoord;</span></a>
<a name="732"><span class="lineNum">     732 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="733"><span class="lineNum">     733 </span>            :     }</a>
<a name="734"><span class="lineNum">     734 </span>            : </a>
<a name="735"><span class="lineNum">     735 </span>            : </a>
<a name="736"><span class="lineNum">     736 </span>            : </a>
<a name="737"><span class="lineNum">     737 </span>            :     /**</a>
<a name="738"><span class="lineNum">     738 </span>            :      * returns the shape function gradients in an arbitrary point,</a>
<a name="739"><span class="lineNum">     739 </span>            :      * given in local coordinates</a>
<a name="740"><span class="lineNum">     740 </span>            :      *</a>
<a name="741"><span class="lineNum">     741 </span>            :      * @param rResult the matrix of gradients,</a>
<a name="742"><span class="lineNum">     742 </span>            :      * will be overwritten with the gradients for all</a>
<a name="743"><span class="lineNum">     743 </span>            :      * shape functions in given point</a>
<a name="744"><span class="lineNum">     744 </span>            :      * @param rPoint the given point the gradients are calculated in</a>
<a name="745"><span class="lineNum">     745 </span>            :      */</a>
<a name="746"><span class="lineNum">     746 </span><span class="lineNoCov">          0 :     virtual Matrix&amp; ShapeFunctionsGradients( Matrix&amp; rResult, CoordinatesArrayType&amp; rPoint )</span></a>
<a name="747"><span class="lineNum">     747 </span>            :     {</a>
<a name="748"><span class="lineNum">     748 </span><span class="lineNoCov">          0 :         rResult.resize( 6, 2 ,false);</span></a>
<a name="749"><span class="lineNum">     749 </span><span class="lineNoCov">          0 :         double thirdCoord = 1 - rPoint[0] - rPoint[1];</span></a>
<a name="750"><span class="lineNum">     750 </span>            :         double thirdCoord_DX = -1;</a>
<a name="751"><span class="lineNum">     751 </span>            :         double thirdCoord_DY = -1;</a>
<a name="752"><span class="lineNum">     752 </span>            : </a>
<a name="753"><span class="lineNum">     753 </span>            :         noalias( rResult ) = ZeroMatrix( 6, 2 );</a>
<a name="754"><span class="lineNum">     754 </span><span class="lineNoCov">          0 :         rResult( 0, 0 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DX;</span></a>
<a name="755"><span class="lineNum">     755 </span><span class="lineNoCov">          0 :         rResult( 0, 1 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DY;</span></a>
<a name="756"><span class="lineNum">     756 </span><span class="lineNoCov">          0 :         rResult( 1, 0 ) =  4 * rPoint[0] - 1;</span></a>
<a name="757"><span class="lineNum">     757 </span><span class="lineNoCov">          0 :         rResult( 1, 1 ) =  0;</span></a>
<a name="758"><span class="lineNum">     758 </span><span class="lineNoCov">          0 :         rResult( 2, 0 ) =  0;</span></a>
<a name="759"><span class="lineNum">     759 </span><span class="lineNoCov">          0 :         rResult( 2, 1 ) =  4 * rPoint[1] - 1;</span></a>
<a name="760"><span class="lineNum">     760 </span><span class="lineNoCov">          0 :         rResult( 3, 0 ) =  4 * thirdCoord_DX * rPoint[0] + 4 * thirdCoord;</span></a>
<a name="761"><span class="lineNum">     761 </span><span class="lineNoCov">          0 :         rResult( 3, 1 ) =  4 * thirdCoord_DY * rPoint[0];</span></a>
<a name="762"><span class="lineNum">     762 </span><span class="lineNoCov">          0 :         rResult( 4, 0 ) =  4 * rPoint[1];</span></a>
<a name="763"><span class="lineNum">     763 </span><span class="lineNoCov">          0 :         rResult( 4, 1 ) =  4 * rPoint[0];</span></a>
<a name="764"><span class="lineNum">     764 </span><span class="lineNoCov">          0 :         rResult( 5, 0 ) =  4 * rPoint[1] * thirdCoord_DX;</span></a>
<a name="765"><span class="lineNum">     765 </span><span class="lineNoCov">          0 :         rResult( 5, 1 ) =  4 * rPoint[1] * thirdCoord_DY + 4 * thirdCoord;</span></a>
<a name="766"><span class="lineNum">     766 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="767"><span class="lineNum">     767 </span>            :     }</a>
<a name="768"><span class="lineNum">     768 </span>            : </a>
<a name="769"><span class="lineNum">     769 </span>            :     /**</a>
<a name="770"><span class="lineNum">     770 </span>            :      * returns the second order derivatives of all shape functions</a>
<a name="771"><span class="lineNum">     771 </span>            :      * in given arbitrary pointers</a>
<a name="772"><span class="lineNum">     772 </span>            :      * @param rResult a third order tensor which contains the second derivatives</a>
<a name="773"><span class="lineNum">     773 </span>            :      * @param rPoint the given point the second order derivatives are calculated in</a>
<a name="774"><span class="lineNum">     774 </span>            :      */</a>
<a name="775"><span class="lineNum">     775 </span><span class="lineNoCov">          0 :     ShapeFunctionsSecondDerivativesType&amp; ShapeFunctionsSecondDerivatives( ShapeFunctionsSecondDerivativesType&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="776"><span class="lineNum">     776 </span>            :     {</a>
<a name="777"><span class="lineNum">     777 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="778"><span class="lineNum">     778 </span>            :         {</a>
<a name="779"><span class="lineNum">     779 </span>            :             // KLUDGE: While there is a bug in</a>
<a name="780"><span class="lineNum">     780 </span>            :             // ublas vector resize, I have to put this beside resizing!!</a>
<a name="781"><span class="lineNum">     781 </span>            :             ShapeFunctionsGradientsType temp( this-&gt;PointsNumber() );</a>
<a name="782"><span class="lineNum">     782 </span>            :             rResult.swap( temp );</a>
<a name="783"><span class="lineNum">     783 </span>            :         }</a>
<a name="784"><span class="lineNum">     784 </span>            : </a>
<a name="785"><span class="lineNum">     785 </span><span class="lineNoCov">          0 :         rResult[0].resize( 2, 2 ,false);</span></a>
<a name="786"><span class="lineNum">     786 </span><span class="lineNoCov">          0 :         rResult[1].resize( 2, 2 ,false);</span></a>
<a name="787"><span class="lineNum">     787 </span><span class="lineNoCov">          0 :         rResult[2].resize( 2, 2 ,false);</span></a>
<a name="788"><span class="lineNum">     788 </span><span class="lineNoCov">          0 :         rResult[3].resize( 2, 2 ,false);</span></a>
<a name="789"><span class="lineNum">     789 </span><span class="lineNoCov">          0 :         rResult[4].resize( 2, 2 ,false);</span></a>
<a name="790"><span class="lineNum">     790 </span><span class="lineNoCov">          0 :         rResult[5].resize( 2, 2 ,false);</span></a>
<a name="791"><span class="lineNum">     791 </span>            : </a>
<a name="792"><span class="lineNum">     792 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 0 ) = 4.0;</span></a>
<a name="793"><span class="lineNum">     793 </span><span class="lineNoCov">          0 :         rResult[0]( 0, 1 ) = 4.0;</span></a>
<a name="794"><span class="lineNum">     794 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 0 ) = 4.0;</span></a>
<a name="795"><span class="lineNum">     795 </span><span class="lineNoCov">          0 :         rResult[0]( 1, 1 ) = 4.0;</span></a>
<a name="796"><span class="lineNum">     796 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 0 ) = 4.0;</span></a>
<a name="797"><span class="lineNum">     797 </span><span class="lineNoCov">          0 :         rResult[1]( 0, 1 ) = 0.0;</span></a>
<a name="798"><span class="lineNum">     798 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 0 ) = 0.0;</span></a>
<a name="799"><span class="lineNum">     799 </span><span class="lineNoCov">          0 :         rResult[1]( 1, 1 ) = 0.0;</span></a>
<a name="800"><span class="lineNum">     800 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 0 ) = 0.0;</span></a>
<a name="801"><span class="lineNum">     801 </span><span class="lineNoCov">          0 :         rResult[2]( 0, 1 ) = 0.0;</span></a>
<a name="802"><span class="lineNum">     802 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 0 ) = 0.0;</span></a>
<a name="803"><span class="lineNum">     803 </span><span class="lineNoCov">          0 :         rResult[2]( 1, 1 ) = 4.0;</span></a>
<a name="804"><span class="lineNum">     804 </span><span class="lineNoCov">          0 :         rResult[3]( 0, 0 ) = -8.0;</span></a>
<a name="805"><span class="lineNum">     805 </span><span class="lineNoCov">          0 :         rResult[3]( 0, 1 ) = -4.0;</span></a>
<a name="806"><span class="lineNum">     806 </span><span class="lineNoCov">          0 :         rResult[3]( 1, 0 ) = -4.0;</span></a>
<a name="807"><span class="lineNum">     807 </span><span class="lineNoCov">          0 :         rResult[3]( 1, 1 ) = 0.0;</span></a>
<a name="808"><span class="lineNum">     808 </span><span class="lineNoCov">          0 :         rResult[4]( 0, 0 ) = 0.0;</span></a>
<a name="809"><span class="lineNum">     809 </span><span class="lineNoCov">          0 :         rResult[4]( 0, 1 ) = 4.0;</span></a>
<a name="810"><span class="lineNum">     810 </span><span class="lineNoCov">          0 :         rResult[4]( 1, 0 ) = 4.0;</span></a>
<a name="811"><span class="lineNum">     811 </span><span class="lineNoCov">          0 :         rResult[4]( 1, 1 ) = 0.0;</span></a>
<a name="812"><span class="lineNum">     812 </span><span class="lineNoCov">          0 :         rResult[5]( 0, 0 ) = 0.0;</span></a>
<a name="813"><span class="lineNum">     813 </span><span class="lineNoCov">          0 :         rResult[5]( 0, 1 ) = -4.0;</span></a>
<a name="814"><span class="lineNum">     814 </span><span class="lineNoCov">          0 :         rResult[5]( 1, 0 ) = -4.0;</span></a>
<a name="815"><span class="lineNum">     815 </span><span class="lineNoCov">          0 :         rResult[5]( 1, 1 ) = -8.0;</span></a>
<a name="816"><span class="lineNum">     816 </span>            : </a>
<a name="817"><span class="lineNum">     817 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="818"><span class="lineNum">     818 </span>            :     }</a>
<a name="819"><span class="lineNum">     819 </span>            : </a>
<a name="820"><span class="lineNum">     820 </span>            :     /**</a>
<a name="821"><span class="lineNum">     821 </span>            :      * returns the third order derivatives of all shape functions</a>
<a name="822"><span class="lineNum">     822 </span>            :      * in given arbitrary pointers</a>
<a name="823"><span class="lineNum">     823 </span>            :      * @param rResult a fourth order tensor which contains the third derivatives</a>
<a name="824"><span class="lineNum">     824 </span>            :      * @param rPoint the given point the third order derivatives are calculated in</a>
<a name="825"><span class="lineNum">     825 </span>            :      */</a>
<a name="826"><span class="lineNum">     826 </span><span class="lineNoCov">          0 :     ShapeFunctionsThirdDerivativesType&amp; ShapeFunctionsThirdDerivatives( ShapeFunctionsThirdDerivativesType&amp; rResult, const CoordinatesArrayType&amp; rPoint ) const override</span></a>
<a name="827"><span class="lineNum">     827 </span>            :     {</a>
<a name="828"><span class="lineNum">     828 </span><span class="lineNoCov">          0 :         if ( rResult.size() != this-&gt;PointsNumber() )</span></a>
<a name="829"><span class="lineNum">     829 </span>            :         {</a>
<a name="830"><span class="lineNum">     830 </span><span class="lineNoCov">          0 :             rResult.resize( this-&gt;PointsNumber() );</span></a>
<a name="831"><span class="lineNum">     831 </span>            :         }</a>
<a name="832"><span class="lineNum">     832 </span>            : </a>
<a name="833"><span class="lineNum">     833 </span><span class="lineNoCov">          0 :         for ( IndexType i = 0; i &lt; rResult.size(); i++ )</span></a>
<a name="834"><span class="lineNum">     834 </span>            :         {</a>
<a name="835"><span class="lineNum">     835 </span><span class="lineNoCov">          0 :             rResult[i].resize( this-&gt;PointsNumber() );</span></a>
<a name="836"><span class="lineNum">     836 </span>            :         }</a>
<a name="837"><span class="lineNum">     837 </span>            : </a>
<a name="838"><span class="lineNum">     838 </span><span class="lineNoCov">          0 :         rResult[0][0].resize( 2, 2,false );</span></a>
<a name="839"><span class="lineNum">     839 </span>            : </a>
<a name="840"><span class="lineNum">     840 </span><span class="lineNoCov">          0 :         rResult[0][1].resize( 2, 2,false );</span></a>
<a name="841"><span class="lineNum">     841 </span><span class="lineNoCov">          0 :         rResult[1][0].resize( 2, 2,false );</span></a>
<a name="842"><span class="lineNum">     842 </span><span class="lineNoCov">          0 :         rResult[1][1].resize( 2, 2 ,false);</span></a>
<a name="843"><span class="lineNum">     843 </span><span class="lineNoCov">          0 :         rResult[2][0].resize( 2, 2 ,false);</span></a>
<a name="844"><span class="lineNum">     844 </span><span class="lineNoCov">          0 :         rResult[2][1].resize( 2, 2 ,false);</span></a>
<a name="845"><span class="lineNum">     845 </span><span class="lineNoCov">          0 :         rResult[3][0].resize( 2, 2 ,false);</span></a>
<a name="846"><span class="lineNum">     846 </span><span class="lineNoCov">          0 :         rResult[3][1].resize( 2, 2 ,false);</span></a>
<a name="847"><span class="lineNum">     847 </span><span class="lineNoCov">          0 :         rResult[4][0].resize( 2, 2 ,false);</span></a>
<a name="848"><span class="lineNum">     848 </span><span class="lineNoCov">          0 :         rResult[4][1].resize( 2, 2 ,false);</span></a>
<a name="849"><span class="lineNum">     849 </span><span class="lineNoCov">          0 :         rResult[5][0].resize( 2, 2 ,false);</span></a>
<a name="850"><span class="lineNum">     850 </span><span class="lineNoCov">          0 :         rResult[5][1].resize( 2, 2 ,false);</span></a>
<a name="851"><span class="lineNum">     851 </span>            : </a>
<a name="852"><span class="lineNum">     852 </span>            : </a>
<a name="853"><span class="lineNum">     853 </span><span class="lineNoCov">          0 :         for ( int i = 0; i &lt; 6; i++ )</span></a>
<a name="854"><span class="lineNum">     854 </span>            :         {</a>
<a name="855"><span class="lineNum">     855 </span><span class="lineNoCov">          0 :             rResult[i][0]( 0, 0 ) = 0.0;</span></a>
<a name="856"><span class="lineNum">     856 </span><span class="lineNoCov">          0 :             rResult[i][0]( 0, 1 ) = 0.0;</span></a>
<a name="857"><span class="lineNum">     857 </span><span class="lineNoCov">          0 :             rResult[i][0]( 1, 0 ) = 0.0;</span></a>
<a name="858"><span class="lineNum">     858 </span><span class="lineNoCov">          0 :             rResult[i][0]( 1, 1 ) = 0.0;</span></a>
<a name="859"><span class="lineNum">     859 </span><span class="lineNoCov">          0 :             rResult[i][1]( 0, 0 ) = 0.0;</span></a>
<a name="860"><span class="lineNum">     860 </span><span class="lineNoCov">          0 :             rResult[i][1]( 0, 1 ) = 0.0;</span></a>
<a name="861"><span class="lineNum">     861 </span><span class="lineNoCov">          0 :             rResult[i][1]( 1, 0 ) = 0.0;</span></a>
<a name="862"><span class="lineNum">     862 </span><span class="lineNoCov">          0 :             rResult[i][1]( 1, 1 ) = 0.0;</span></a>
<a name="863"><span class="lineNum">     863 </span>            :         }</a>
<a name="864"><span class="lineNum">     864 </span>            : </a>
<a name="865"><span class="lineNum">     865 </span><span class="lineNoCov">          0 :         return rResult;</span></a>
<a name="866"><span class="lineNum">     866 </span>            :     }</a>
<a name="867"><span class="lineNum">     867 </span>            : </a>
<a name="868"><span class="lineNum">     868 </span>            :     ///@}</a>
<a name="869"><span class="lineNum">     869 </span>            :     ///@name Friends</a>
<a name="870"><span class="lineNum">     870 </span>            :     ///@{</a>
<a name="871"><span class="lineNum">     871 </span>            : </a>
<a name="872"><span class="lineNum">     872 </span>            :     ///@}</a>
<a name="873"><span class="lineNum">     873 </span>            : </a>
<a name="874"><span class="lineNum">     874 </span>            : protected:</a>
<a name="875"><span class="lineNum">     875 </span>            :     /**</a>
<a name="876"><span class="lineNum">     876 </span>            :      * There are no protected members in class Triangle3D6</a>
<a name="877"><span class="lineNum">     877 </span>            :      */</a>
<a name="878"><span class="lineNum">     878 </span>            : </a>
<a name="879"><span class="lineNum">     879 </span>            : private:</a>
<a name="880"><span class="lineNum">     880 </span>            :     ///@name Static Member Variables</a>
<a name="881"><span class="lineNum">     881 </span>            :     ///@{</a>
<a name="882"><span class="lineNum">     882 </span>            : </a>
<a name="883"><span class="lineNum">     883 </span>            :     static const GeometryData msGeometryData;</a>
<a name="884"><span class="lineNum">     884 </span>            : </a>
<a name="885"><span class="lineNum">     885 </span>            :     static const GeometryDimension msGeometryDimension;</a>
<a name="886"><span class="lineNum">     886 </span>            : </a>
<a name="887"><span class="lineNum">     887 </span>            :     ///@}</a>
<a name="888"><span class="lineNum">     888 </span>            :     ///@name Serialization</a>
<a name="889"><span class="lineNum">     889 </span>            :     ///@{</a>
<a name="890"><span class="lineNum">     890 </span>            : </a>
<a name="891"><span class="lineNum">     891 </span>            :     friend class Serializer;</a>
<a name="892"><span class="lineNum">     892 </span>            : </a>
<a name="893"><span class="lineNum">     893 </span><span class="lineNoCov">          0 :     void save( Serializer&amp; rSerializer ) const override</span></a>
<a name="894"><span class="lineNum">     894 </span>            :     {</a>
<a name="895"><span class="lineNum">     895 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_SAVE_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="896"><span class="lineNum">     896 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="897"><span class="lineNum">     897 </span>            : </a>
<a name="898"><span class="lineNum">     898 </span><span class="lineNoCov">          0 :     void load( Serializer&amp; rSerializer ) override</span></a>
<a name="899"><span class="lineNum">     899 </span>            :     {</a>
<a name="900"><span class="lineNum">     900 </span><span class="lineNoCov">          0 :         KRATOS_SERIALIZE_LOAD_BASE_CLASS( rSerializer, BaseType );</span></a>
<a name="901"><span class="lineNum">     901 </span><span class="lineNoCov">          0 :     }</span></a>
<a name="902"><span class="lineNum">     902 </span>            : </a>
<a name="903"><span class="lineNum">     903 </span><span class="lineNoCov">          0 :     Triangle3D6(): BaseType( PointsArrayType(), &amp;msGeometryData ) {}</span></a>
<a name="904"><span class="lineNum">     904 </span>            : </a>
<a name="905"><span class="lineNum">     905 </span>            :     ///@}</a>
<a name="906"><span class="lineNum">     906 </span>            :     ///@name Member Variables</a>
<a name="907"><span class="lineNum">     907 </span>            :     ///@{</a>
<a name="908"><span class="lineNum">     908 </span>            : </a>
<a name="909"><span class="lineNum">     909 </span>            : </a>
<a name="910"><span class="lineNum">     910 </span>            :     ///@}</a>
<a name="911"><span class="lineNum">     911 </span>            :     ///@name Private Operators</a>
<a name="912"><span class="lineNum">     912 </span>            :     ///@{</a>
<a name="913"><span class="lineNum">     913 </span>            : </a>
<a name="914"><span class="lineNum">     914 </span>            : </a>
<a name="915"><span class="lineNum">     915 </span>            :     ///@}</a>
<a name="916"><span class="lineNum">     916 </span>            :     ///@name Private Operations</a>
<a name="917"><span class="lineNum">     917 </span>            :     ///@{</a>
<a name="918"><span class="lineNum">     918 </span>            : </a>
<a name="919"><span class="lineNum">     919 </span>            :     /**</a>
<a name="920"><span class="lineNum">     920 </span>            :      * TODO: implemented but not yet tested</a>
<a name="921"><span class="lineNum">     921 </span>            :      */</a>
<a name="922"><span class="lineNum">     922 </span>            :     /**</a>
<a name="923"><span class="lineNum">     923 </span>            :      * Calculates the values of all shape function in all integration points.</a>
<a name="924"><span class="lineNum">     924 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="925"><span class="lineNum">     925 </span>            :      * @param ThisMethod the current integration method</a>
<a name="926"><span class="lineNum">     926 </span>            :      * @return the matrix of values of every shape function in each integration point</a>
<a name="927"><span class="lineNum">     927 </span>            :      * :KLUDGE: number of points is hard-coded -&gt; be careful if you want to copy and paste!</a>
<a name="928"><span class="lineNum">     928 </span>            :      */</a>
<a name="929"><span class="lineNum">     929 </span><span class="lineCov">         33 :     static Matrix CalculateShapeFunctionsIntegrationPointsValues(</span></a>
<a name="930"><span class="lineNum">     930 </span>            :         typename BaseType::IntegrationMethod ThisMethod )</a>
<a name="931"><span class="lineNum">     931 </span>            :     {</a>
<a name="932"><span class="lineNum">     932 </span><span class="lineCov">         33 :         IntegrationPointsContainerType all_integration_points =</span></a>
<a name="933"><span class="lineNum">     933 </span>            :             AllIntegrationPoints();</a>
<a name="934"><span class="lineNum">     934 </span><span class="lineCov">         33 :         IntegrationPointsArrayType integration_points = all_integration_points[static_cast&lt;int&gt;(ThisMethod)];</span></a>
<a name="935"><span class="lineNum">     935 </span>            :         //number of integration points</a>
<a name="936"><span class="lineNum">     936 </span><span class="lineCov">         33 :         const int integration_points_number = integration_points.size();</span></a>
<a name="937"><span class="lineNum">     937 </span>            :         //number of nodes in current geometry</a>
<a name="938"><span class="lineNum">     938 </span>            :         const int points_number = 6;</a>
<a name="939"><span class="lineNum">     939 </span>            :         //setting up return matrix</a>
<a name="940"><span class="lineNum">     940 </span><span class="lineCov">         33 :         Matrix shape_function_values( integration_points_number, points_number );</span></a>
<a name="941"><span class="lineNum">     941 </span>            :         //loop over all integration points</a>
<a name="942"><span class="lineNum">     942 </span>            : </a>
<a name="943"><span class="lineNum">     943 </span><span class="lineCov">        121 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="944"><span class="lineNum">     944 </span>            :         {</a>
<a name="945"><span class="lineNum">     945 </span><span class="lineCov">         88 :             double thirdCoord = 1 - integration_points[pnt].X() - integration_points[pnt].Y();</span></a>
<a name="946"><span class="lineNum">     946 </span>            : </a>
<a name="947"><span class="lineNum">     947 </span><span class="lineCov">         88 :             shape_function_values( pnt, 0 ) = thirdCoord * ( 2 * thirdCoord - 1 ) ;</span></a>
<a name="948"><span class="lineNum">     948 </span><span class="lineCov">         88 :             shape_function_values( pnt, 1 ) = integration_points[pnt].X() * ( 2 * integration_points[pnt].X() - 1 ) ;</span></a>
<a name="949"><span class="lineNum">     949 </span><span class="lineCov">         88 :             shape_function_values( pnt, 2 ) =  integration_points[pnt].Y() * ( 2 * integration_points[pnt].Y() - 1 ) ;</span></a>
<a name="950"><span class="lineNum">     950 </span><span class="lineCov">         88 :             shape_function_values( pnt, 3 ) =  4 * thirdCoord * integration_points[pnt].X();</span></a>
<a name="951"><span class="lineNum">     951 </span><span class="lineCov">         88 :             shape_function_values( pnt, 4 ) =  4 * integration_points[pnt].X() * integration_points[pnt].Y();</span></a>
<a name="952"><span class="lineNum">     952 </span><span class="lineCov">         88 :             shape_function_values( pnt, 5 ) =  4 * integration_points[pnt].Y() * thirdCoord;</span></a>
<a name="953"><span class="lineNum">     953 </span>            : </a>
<a name="954"><span class="lineNum">     954 </span>            :         }</a>
<a name="955"><span class="lineNum">     955 </span>            : </a>
<a name="956"><span class="lineNum">     956 </span><span class="lineCov">         33 :         return shape_function_values;</span></a>
<a name="957"><span class="lineNum">     957 </span><span class="lineCov">         33 :     }</span></a>
<a name="958"><span class="lineNum">     958 </span>            : </a>
<a name="959"><span class="lineNum">     959 </span>            :     /**</a>
<a name="960"><span class="lineNum">     960 </span>            :      * TODO: implemented but not yet tested</a>
<a name="961"><span class="lineNum">     961 </span>            :      */</a>
<a name="962"><span class="lineNum">     962 </span>            :     /**</a>
<a name="963"><span class="lineNum">     963 </span>            :      * Calculates the local gradients of all shape functions</a>
<a name="964"><span class="lineNum">     964 </span>            :      * in all integration points.</a>
<a name="965"><span class="lineNum">     965 </span>            :      * Integration points are expected to be given in local coordinates</a>
<a name="966"><span class="lineNum">     966 </span>            :      *</a>
<a name="967"><span class="lineNum">     967 </span>            :      * @param ThisMethod the current integration method</a>
<a name="968"><span class="lineNum">     968 </span>            :      * @return the vector of the gradients of all shape functions</a>
<a name="969"><span class="lineNum">     969 </span>            :      * in each integration point</a>
<a name="970"><span class="lineNum">     970 </span>            :      */</a>
<a name="971"><span class="lineNum">     971 </span>            :     static ShapeFunctionsGradientsType</a>
<a name="972"><span class="lineNum">     972 </span><span class="lineCov">         33 :     CalculateShapeFunctionsIntegrationPointsLocalGradients(</span></a>
<a name="973"><span class="lineNum">     973 </span>            :         typename BaseType::IntegrationMethod ThisMethod )</a>
<a name="974"><span class="lineNum">     974 </span>            :     {</a>
<a name="975"><span class="lineNum">     975 </span><span class="lineCov">         33 :         IntegrationPointsContainerType all_integration_points =</span></a>
<a name="976"><span class="lineNum">     976 </span>            :             AllIntegrationPoints();</a>
<a name="977"><span class="lineNum">     977 </span><span class="lineCov">         33 :         IntegrationPointsArrayType integration_points = all_integration_points[static_cast&lt;int&gt;(ThisMethod)];</span></a>
<a name="978"><span class="lineNum">     978 </span>            :         //number of integration points</a>
<a name="979"><span class="lineNum">     979 </span><span class="lineCov">         33 :         const int integration_points_number = integration_points.size();</span></a>
<a name="980"><span class="lineNum">     980 </span><span class="lineCov">         33 :         ShapeFunctionsGradientsType d_shape_f_values( integration_points_number );</span></a>
<a name="981"><span class="lineNum">     981 </span>            :         //initialising container</a>
<a name="982"><span class="lineNum">     982 </span>            :         //std::fill(d_shape_f_values.begin(), d_shape_f_values.end(), Matrix(4,2));</a>
<a name="983"><span class="lineNum">     983 </span>            :         //loop over all integration points</a>
<a name="984"><span class="lineNum">     984 </span>            : </a>
<a name="985"><span class="lineNum">     985 </span><span class="lineCov">        121 :         for ( int pnt = 0; pnt &lt; integration_points_number; pnt++ )</span></a>
<a name="986"><span class="lineNum">     986 </span>            :         {</a>
<a name="987"><span class="lineNum">     987 </span>            :             Matrix result( 6, 2 );</a>
<a name="988"><span class="lineNum">     988 </span><span class="lineCov">         88 :             double thirdCoord = 1 - integration_points[pnt].X() - integration_points[pnt].Y();</span></a>
<a name="989"><span class="lineNum">     989 </span>            :             double thirdCoord_DX = -1;</a>
<a name="990"><span class="lineNum">     990 </span>            :             double thirdCoord_DY = -1;</a>
<a name="991"><span class="lineNum">     991 </span>            : </a>
<a name="992"><span class="lineNum">     992 </span>            :             noalias( result ) = ZeroMatrix( 6, 2 );</a>
<a name="993"><span class="lineNum">     993 </span><span class="lineCov">         88 :             result( 0, 0 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DX;</span></a>
<a name="994"><span class="lineNum">     994 </span><span class="lineCov">         88 :             result( 0, 1 ) = ( 4 * thirdCoord - 1 ) * thirdCoord_DY;</span></a>
<a name="995"><span class="lineNum">     995 </span><span class="lineCov">         88 :             result( 1, 0 ) =  4 * integration_points[pnt].X() - 1;</span></a>
<a name="996"><span class="lineNum">     996 </span><span class="lineCov">         88 :             result( 1, 1 ) =  0;</span></a>
<a name="997"><span class="lineNum">     997 </span><span class="lineCov">         88 :             result( 2, 0 ) =  0;</span></a>
<a name="998"><span class="lineNum">     998 </span><span class="lineCov">         88 :             result( 2, 1 ) =  4 * integration_points[pnt].Y() - 1;</span></a>
<a name="999"><span class="lineNum">     999 </span><span class="lineCov">         88 :             result( 3, 0 ) =  4 * thirdCoord_DX * integration_points[pnt].X() + 4 * thirdCoord;</span></a>
<a name="1000"><span class="lineNum">    1000 </span><span class="lineCov">         88 :             result( 3, 1 ) =  4 * thirdCoord_DY * integration_points[pnt].X();</span></a>
<a name="1001"><span class="lineNum">    1001 </span><span class="lineCov">         88 :             result( 4, 0 ) =  4 * integration_points[pnt].Y();</span></a>
<a name="1002"><span class="lineNum">    1002 </span><span class="lineCov">         88 :             result( 4, 1 ) =  4 * integration_points[pnt].X();</span></a>
<a name="1003"><span class="lineNum">    1003 </span><span class="lineCov">         88 :             result( 5, 0 ) =  4 * integration_points[pnt].Y() * thirdCoord_DX;</span></a>
<a name="1004"><span class="lineNum">    1004 </span><span class="lineCov">         88 :             result( 5, 1 ) =  4 * integration_points[pnt].Y() * thirdCoord_DY + 4 * thirdCoord;</span></a>
<a name="1005"><span class="lineNum">    1005 </span>            : </a>
<a name="1006"><span class="lineNum">    1006 </span><span class="lineCov">         88 :             d_shape_f_values[pnt] = result;</span></a>
<a name="1007"><span class="lineNum">    1007 </span>            :         }</a>
<a name="1008"><span class="lineNum">    1008 </span>            : </a>
<a name="1009"><span class="lineNum">    1009 </span><span class="lineCov">         33 :         return d_shape_f_values;</span></a>
<a name="1010"><span class="lineNum">    1010 </span><span class="lineCov">         33 :     }</span></a>
<a name="1011"><span class="lineNum">    1011 </span>            : </a>
<a name="1012"><span class="lineNum">    1012 </span>            :     /**</a>
<a name="1013"><span class="lineNum">    1013 </span>            :      * TODO: testing</a>
<a name="1014"><span class="lineNum">    1014 </span>            :      */</a>
<a name="1015"><span class="lineNum">    1015 </span><span class="lineCov">         77 :     static const IntegrationPointsContainerType AllIntegrationPoints()</span></a>
<a name="1016"><span class="lineNum">    1016 </span>            :     {</a>
<a name="1017"><span class="lineNum">    1017 </span><span class="lineCov">         77 :         IntegrationPointsContainerType integration_points =</span></a>
<a name="1018"><span class="lineNum">    1018 </span>            :         {</a>
<a name="1019"><span class="lineNum">    1019 </span>            :             {</a>
<a name="1020"><span class="lineNum">    1020 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints1, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1021"><span class="lineNum">    1021 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints2, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints(),</a>
<a name="1022"><span class="lineNum">    1022 </span>            :                 Quadrature&lt;TriangleGaussLegendreIntegrationPoints3, 2, IntegrationPoint&lt;3&gt; &gt;::GenerateIntegrationPoints()</a>
<a name="1023"><span class="lineNum">    1023 </span>            :             }</a>
<a name="1024"><span class="lineNum">    1024 </span>            :         };</a>
<a name="1025"><span class="lineNum">    1025 </span><span class="lineCov">         77 :         return integration_points;</span></a>
<a name="1026"><span class="lineNum">    1026 </span>            :     }</a>
<a name="1027"><span class="lineNum">    1027 </span>            : </a>
<a name="1028"><span class="lineNum">    1028 </span>            :     /**</a>
<a name="1029"><span class="lineNum">    1029 </span>            :      * TODO: testing</a>
<a name="1030"><span class="lineNum">    1030 </span>            :      */</a>
<a name="1031"><span class="lineNum">    1031 </span><span class="lineCov">         11 :     static const ShapeFunctionsValuesContainerType AllShapeFunctionsValues()</span></a>
<a name="1032"><span class="lineNum">    1032 </span>            :     {</a>
<a name="1033"><span class="lineNum">    1033 </span><span class="lineCov">         11 :         ShapeFunctionsValuesContainerType shape_functions_values =</span></a>
<a name="1034"><span class="lineNum">    1034 </span>            :         {</a>
<a name="1035"><span class="lineNum">    1035 </span>            :             {</a>
<a name="1036"><span class="lineNum">    1036 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1037"><span class="lineNum">    1037 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_1 ),</a>
<a name="1038"><span class="lineNum">    1038 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1039"><span class="lineNum">    1039 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_2 ),</a>
<a name="1040"><span class="lineNum">    1040 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsValues(</a>
<a name="1041"><span class="lineNum">    1041 </span>            :                     GeometryData::IntegrationMethod::GI_GAUSS_3 )</a>
<a name="1042"><span class="lineNum">    1042 </span>            :             }</a>
<a name="1043"><span class="lineNum">    1043 </span>            :         };</a>
<a name="1044"><span class="lineNum">    1044 </span><span class="lineCov">         11 :         return shape_functions_values;</span></a>
<a name="1045"><span class="lineNum">    1045 </span>            :     }</a>
<a name="1046"><span class="lineNum">    1046 </span>            : </a>
<a name="1047"><span class="lineNum">    1047 </span>            :     /**</a>
<a name="1048"><span class="lineNum">    1048 </span>            :      * TODO: testing</a>
<a name="1049"><span class="lineNum">    1049 </span>            :      */</a>
<a name="1050"><span class="lineNum">    1050 </span>            :     static const ShapeFunctionsLocalGradientsContainerType</a>
<a name="1051"><span class="lineNum">    1051 </span><span class="lineCov">         11 :     AllShapeFunctionsLocalGradients()</span></a>
<a name="1052"><span class="lineNum">    1052 </span>            :     {</a>
<a name="1053"><span class="lineNum">    1053 </span><span class="lineCov">         11 :         ShapeFunctionsLocalGradientsContainerType shape_functions_local_gradients =</span></a>
<a name="1054"><span class="lineNum">    1054 </span>            :         {</a>
<a name="1055"><span class="lineNum">    1055 </span>            :             {</a>
<a name="1056"><span class="lineNum">    1056 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::IntegrationMethod::GI_GAUSS_1 ),</a>
<a name="1057"><span class="lineNum">    1057 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::IntegrationMethod::GI_GAUSS_2 ),</a>
<a name="1058"><span class="lineNum">    1058 </span>            :                 Triangle3D6&lt;TPointType&gt;::CalculateShapeFunctionsIntegrationPointsLocalGradients( GeometryData::IntegrationMethod::GI_GAUSS_3 )</a>
<a name="1059"><span class="lineNum">    1059 </span>            :             }</a>
<a name="1060"><span class="lineNum">    1060 </span>            :         };</a>
<a name="1061"><span class="lineNum">    1061 </span><span class="lineCov">         11 :         return shape_functions_local_gradients;</span></a>
<a name="1062"><span class="lineNum">    1062 </span>            :     }</a>
<a name="1063"><span class="lineNum">    1063 </span>            : </a>
<a name="1064"><span class="lineNum">    1064 </span>            :     ///@}</a>
<a name="1065"><span class="lineNum">    1065 </span>            :     ///@name Private  Access</a>
<a name="1066"><span class="lineNum">    1066 </span>            :     ///@{</a>
<a name="1067"><span class="lineNum">    1067 </span>            : </a>
<a name="1068"><span class="lineNum">    1068 </span>            : </a>
<a name="1069"><span class="lineNum">    1069 </span>            :     ///@}</a>
<a name="1070"><span class="lineNum">    1070 </span>            :     ///@name Private Inquiry</a>
<a name="1071"><span class="lineNum">    1071 </span>            :     ///@{</a>
<a name="1072"><span class="lineNum">    1072 </span>            : </a>
<a name="1073"><span class="lineNum">    1073 </span>            : </a>
<a name="1074"><span class="lineNum">    1074 </span>            :     ///@}</a>
<a name="1075"><span class="lineNum">    1075 </span>            :     ///@name Private Friends</a>
<a name="1076"><span class="lineNum">    1076 </span>            :     ///@{</a>
<a name="1077"><span class="lineNum">    1077 </span>            : </a>
<a name="1078"><span class="lineNum">    1078 </span>            :     template&lt;class TOtherPointType&gt; friend class Triangle3D6;</a>
<a name="1079"><span class="lineNum">    1079 </span>            : </a>
<a name="1080"><span class="lineNum">    1080 </span>            :     ///@}</a>
<a name="1081"><span class="lineNum">    1081 </span>            :     ///@name Un accessible methods</a>
<a name="1082"><span class="lineNum">    1082 </span>            :     ///@{</a>
<a name="1083"><span class="lineNum">    1083 </span>            : </a>
<a name="1084"><span class="lineNum">    1084 </span>            :     ///@}</a>
<a name="1085"><span class="lineNum">    1085 </span>            : }; // Class Geometry</a>
<a name="1086"><span class="lineNum">    1086 </span>            : </a>
<a name="1087"><span class="lineNum">    1087 </span>            : ///@}</a>
<a name="1088"><span class="lineNum">    1088 </span>            : ///@name Type Definitions</a>
<a name="1089"><span class="lineNum">    1089 </span>            : ///@{</a>
<a name="1090"><span class="lineNum">    1090 </span>            : </a>
<a name="1091"><span class="lineNum">    1091 </span>            : </a>
<a name="1092"><span class="lineNum">    1092 </span>            : ///@}</a>
<a name="1093"><span class="lineNum">    1093 </span>            : ///@name Input and output</a>
<a name="1094"><span class="lineNum">    1094 </span>            : ///@{</a>
<a name="1095"><span class="lineNum">    1095 </span>            : /**</a>
<a name="1096"><span class="lineNum">    1096 </span>            :  * input stream functions</a>
<a name="1097"><span class="lineNum">    1097 </span>            :  */</a>
<a name="1098"><span class="lineNum">    1098 </span>            : template&lt;class TPointType&gt; inline std::istream&amp; operator &gt;&gt; (</a>
<a name="1099"><span class="lineNum">    1099 </span>            :     std::istream&amp; rIStream,</a>
<a name="1100"><span class="lineNum">    1100 </span>            :     Triangle3D6&lt;TPointType&gt;&amp; rThis );</a>
<a name="1101"><span class="lineNum">    1101 </span>            : /**</a>
<a name="1102"><span class="lineNum">    1102 </span>            :  * output stream functions</a>
<a name="1103"><span class="lineNum">    1103 </span>            :  */</a>
<a name="1104"><span class="lineNum">    1104 </span><span class="lineNoCov">          0 : template&lt;class TPointType&gt; inline std::ostream&amp; operator &lt;&lt; (</span></a>
<a name="1105"><span class="lineNum">    1105 </span>            :     std::ostream&amp; rOStream,</a>
<a name="1106"><span class="lineNum">    1106 </span>            :     const Triangle3D6&lt;TPointType&gt;&amp; rThis )</a>
<a name="1107"><span class="lineNum">    1107 </span>            : {</a>
<a name="1108"><span class="lineNum">    1108 </span><span class="lineNoCov">          0 :     rThis.PrintInfo( rOStream );</span></a>
<a name="1109"><span class="lineNum">    1109 </span>            :     rOStream &lt;&lt; std::endl;</a>
<a name="1110"><span class="lineNum">    1110 </span><span class="lineNoCov">          0 :     rThis.PrintData( rOStream );</span></a>
<a name="1111"><span class="lineNum">    1111 </span><span class="lineNoCov">          0 :     return rOStream;</span></a>
<a name="1112"><span class="lineNum">    1112 </span>            : }</a>
<a name="1113"><span class="lineNum">    1113 </span>            : </a>
<a name="1114"><span class="lineNum">    1114 </span>            : ///@}</a>
<a name="1115"><span class="lineNum">    1115 </span>            : </a>
<a name="1116"><span class="lineNum">    1116 </span>            : template&lt;class TPointType&gt; const</a>
<a name="1117"><span class="lineNum">    1117 </span>            : GeometryData Triangle3D6&lt;TPointType&gt;::msGeometryData(</a>
<a name="1118"><span class="lineNum">    1118 </span>            :     &amp;msGeometryDimension,</a>
<a name="1119"><span class="lineNum">    1119 </span>            :     GeometryData::IntegrationMethod::GI_GAUSS_2,</a>
<a name="1120"><span class="lineNum">    1120 </span>            :     Triangle3D6&lt;TPointType&gt;::AllIntegrationPoints(),</a>
<a name="1121"><span class="lineNum">    1121 </span>            :     Triangle3D6&lt;TPointType&gt;::AllShapeFunctionsValues(),</a>
<a name="1122"><span class="lineNum">    1122 </span>            :     AllShapeFunctionsLocalGradients()</a>
<a name="1123"><span class="lineNum">    1123 </span>            : );</a>
<a name="1124"><span class="lineNum">    1124 </span>            : </a>
<a name="1125"><span class="lineNum">    1125 </span>            : template&lt;class TPointType&gt; const</a>
<a name="1126"><span class="lineNum">    1126 </span>            : GeometryDimension Triangle3D6&lt;TPointType&gt;::msGeometryDimension(</a>
<a name="1127"><span class="lineNum">    1127 </span>            :     2, 3, 2);</a>
<a name="1128"><span class="lineNum">    1128 </span>            : </a>
<a name="1129"><span class="lineNum">    1129 </span>            : }// namespace Kratos.</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
